{"version":3,"sources":["routes/User/Home/index.tsx","components/Loading/index.tsx","components/CustomList/index.tsx","assets/icons/report.svg","routes/User/Home/Reports/index.tsx","components/UploadData/index.tsx","assets/icons/data-source.svg","routes/User/Home/DataSources/index.tsx","components/TextEditor/index.tsx","utils/customMetaKEey.ts","components/ReportEditor/controllers/GController.ts","decorators/bind.ts","components/Charts/LineChart/index.tsx","components/Charts/BarChart/index.tsx","components/Charts/PieChart/index.tsx","components/Charts/ScatterChart/index.tsx","components/ReportEditor/widgets/ReportElement/Text/index.tsx","components/ReportEditor/widgets/ReportElement/index.tsx","components/ReportEditor/widgets/ReportElement/reducer.ts","components/ReportEditor/controllers/InteractController.ts","components/ReportEditor/controllers/KeyboardController.ts","components/ReportEditor/controllers/MouseController.ts","assets/icons/undo.svg","assets/icons/redo.svg","assets/icons/select-all.svg","assets/icons/text.svg","components/ReportEditor/widgets/Toolbar/index.tsx","components/ReportEditor/widgets/ConfigPanel/index.tsx","components/ReportEditor/index.tsx","routes/User/Report/index.tsx","components/DoActionOnMount/index.tsx","routes/index.tsx","contexts/Locale.tsx","assets/images/logo.png","assets/locales/index.ts","assets/locales/en_US.ts","assets/locales/zh_CN.ts","contexts/User.tsx","components/ErrorBoundary/index.tsx","components/ApolloProvider/index.tsx","App.tsx","serviceWorker.ts","index.tsx","components/Error/index.tsx"],"names":["Header","Sider","Content","React","props","setUser","UserContext","_React$useContext2","LocaleContext","locale","setLocale","currentPaths","concat","uri","localeItems","key","locales","en_US","value","zh_CN","siderMenuItems","AbsoluteRoute","User","Home","Reports","user","home","reports","title","DataSources","dataSources","localeDropDown","react","menu","map","localeItem","Item","onClick","signOut","id","username","token","hasSignedIn","changePath","_ref","navigate","layout","className","src","logo","alt","dropdown","overlay","trigger","es_button","size","icon","type","divider","selectedKeys","siderMenuItem","children","spin","tip","common","loading","responseKey","getListItems","handleListItemClick","removeListItem","itemIcon","itemNameFormatter","listHeader","react_apollo_browser_umd","query","queryResult","data","error","refetch","src_components_Loading","components_Error","dataSource","rows","header","undefined","listItemStyle","cursor","list","bordered","renderItem","item","style","e","name","createdAt","moment","format","updatedAt","mutation","variables","onCompleted","shape","stopPropagation","_extends","Object","assign","target","i","arguments","length","source","prototype","hasOwnProperty","call","apply","this","report_ref","react_default","a","createElement","report_ref2","d","pId","__webpack_require__","p","GET_ALL_REPORTS","gql","_templateObject","ADD_REPORT","_templateObject2","REMOVE_REPORT","_templateObject3","reportIcon","component","t","viewBox","version","xmlnsXlink","width","height","fontSize","color","reportsHeader","_ref3","asyncToGenerator","regenerator_default","mark","_callee","_ref2","wrap","_context","prev","next","addReport","Report","replace","stop","_x","_ref4","reportNameFormatter","unnamedReport","src_components_CustomList","ADD_DATA_SOURCE","UploadData_templateObject","graphql","options","onDataUploaded","uploadData","mutate","beforeUpload","file","fileReader","FileReader","readAsText","onload","event","JSON","stringify","parse","result","message","fileContentError","dataView","DataSet","View","transform","callback","row","valueToNumber","Number","isNaN","upload","accept","showUploadList","addDataSource","data_source_extends","data_source_ref","data_source_ref2","GET_DATA_SOURCES","DataSources_templateObject","REMOVE_DATA_SOURCE","DataSources_templateObject2","dataSourceIcon","dataSourcesHeader","components_UploadData","pasteOnlyText","preventDefault","document","execCommand","clipboardData","getData","ref","disabled","placeholder","text","onKeyDown","onDoubleClick","onChange","onBlur","react_contenteditable_default","innerRef","spellCheck","html","onPaste","customMetaKey","ctrlKey","metaKey","platform","window","navigator","includes","GController","_canvas","_canvasContainerSelector","_canvasSelector","canvasContainer","querySelector","canvas","clientWidth","clientHeight","containerId","Canvas","destroy","bind","propertyKey","descriptor","definingProperty","originalFn","configurable","get","defineProperty","writable","dataKeys","keys","xAxis","yAxes","slice","position","scale","isXAxisTime","nice","fields","Chart_default","Legend_default","Axis_default","Tooltip_default","crosshairs","Line_default","isLineSmooth","Interval_default","adjust","marginRatio","count","dimension","as","percent","formatter","val","Coord_default","offsetY","clickable","Geom_default","tooltip","lineWidth","stroke","Label_default","content","point","yAxis","join","Point_default","opacity","ReportElType","ReportChartType","_React$useState","_React$useState2","slicedToArray","contentEditable","setContentEditable","editorRef","current","el","focus","getSelection","createRange","range","selectNodeContents","collapse","selection","removeAllRanges","addRange","body","createTextRange","textRange","moveToElementText","select","placeCaretAtEnd","components_TextEditor","report","textEmptyTips","ReportElsActionType","x","y","selected","onMouseMove","onMouseDown","onMouseUp","onInputText","reportElSelectedBorderWidth","Chart","data-x","data-y","empty","chartProps","chartType","LineChart","Charts_LineChart","BarChart","Charts_BarChart","PieChart","Charts_PieChart","ScatterChart","Charts_ScatterChart","Error","Text","ReportElement_Text","undoStackMaxLength","reportElsReducer","reportEls","action","undoStack","redoStack","originalActionType","newUndoStack","newRedoStack","Undo","Redo","payload","newReportElsState","reverseAction","Add","Delete","reportElWillRemove","state","reportEl","objectSpread","editing","reportElWillAdd","filter","indexOf","origin","Move","some","reportElMoved","reportElWillMove","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","Math","max","min","err","return","Resize","reportElResized","reportElWillResize","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","StartEdit","Select","reportElSelectedId","Unselect","InputText","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","SetChartDataSource","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","SetChartOptions","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","disallowUndo","InteractController","classCallCheck","_props","_selector","draggableOptions","onmove","_onDragMove","restrict","restriction","elementRect","top","left","bottom","right","resizableOptions","_onResizeMove","edges","restrictEdges","outer","restrictSize","interact","draggable","resizable","unset","dx","dy","getAttribute","reportElsDispatch","deltaRect","rect","dataset","ShortCutsController","_preventDelete","addEventListener","_onKeydown","_onKeyup","partialProps","removeEventListener","_this$_props","reportElsState","keyCode","selectedReportEl","reportElSelected","shiftKey","onSave","MouseController","_canvasContainer","mouseDownPosition","_this$_props2","reportElToDelete","random","toString","substr","clientX","clientY","_this$_canvasContaine","_this$_props3","reportElId","unselectOthers","_this$_props4","currentTarget","undo_extends","undo_ref","undo_ref2","undo_SvgComponent","redo_extends","redo_ref","redo_ref2","redo_SvgComponent","select_all_extends","select_all_ref","select_all_ref2","select_all_ref3","select_all_ref4","select_all_ref5","select_all_SvgComponent","text_extends","text_ref","text_ref2","text_SvgComponent","disableUndo","disableRedo","disableDelete","onUndoBtnClick","onRedoBtnClick","onSelectAllBtnClick","onChartListItemClick","onAddTextBtnClick","onDeleteSelectedBtnClick","reportChartTypeItems","lineChart","barChart","pieChart","scatterChart","addChartTypeMenu","reportChartTypeItem","Toolbar_Header","undo","placement","UndoSvg","redo","RedoSvg","selectAll","SelectAllSvg","chart","TextSvg","deleteSelected","editingReportEl","onChartDataSourceSelect","onChartOptionsChange","ConfigPanel_Sider","pannelItems","push","es_select","onSelect","dataSourceId","Option","es_switch","checked","checkedChildren","unCheckedChildren","initialEls","reportCanvasRef","_React$useReducer","_React$useReducer2","controller","g","keyboard","KeyboardController","mouse","update","init","ReportEditor_widgets_Toolbar","ReportEditor_Content","onCanvasContainerMouseDown","onCanvasContainerMouseUp","ReportEditor_widgets_ReportElement","onReportElMouseMove","onReportElMouseDown","onReportElMouseUp","_onInputText","ReportEditor_widgets_ConfigPanel","GET_REPORT","Report_templateObject","GET_DATASOURCES","Report_templateObject2","RENAME_REPORT","Report_templateObject3","SAVE_REPORT_ELS","_templateObject4","compose","reportId","getReport","elements","getDataSources","saveReport","setReport","Report_Header","es","to","renameReport","blur","components_ReportEditor","console","log","doAction","SignIn","abrupt","Promise","all","then","_callee2","_context2","NotFound","_callee3","_context3","Path","SIGN_IN_BY_TOKEN","routes_templateObject","_React$useContext","_React$useContext$use","onSignInByTokenCompleted","signInByToken","fallback","_ref5","path","default","routes_User","routes_User_Home","Home_Reports","Home_DataSources","User_Report","components_DoActionOnMount","localStorage","getItem","otherLocaleMap","_otherLocaleMap","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__","antd","antd_en_US","antd_zh_CN","LocaleProvider","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","_React$useState3","_React$useState4","antdLocale","setAntdLocale","LocaleContextValue","otherLocale","setItem","react__WEBPACK_IMPORTED_MODULE_4__","Provider","antd_es_locale_provider__WEBPACK_IMPORTED_MODULE_1__","module","exports","__webpack_exports__","signIn","signUp","password","usernameLimit","passwordLimit","unselectAll","unauthorized","existingUsername","nonexistentUsernameOrWrongPassword","reportNotFound","dataSourceNotFound","networkError","notFound","UserProvider","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","UserContextValue","react__WEBPACK_IMPORTED_MODULE_1__","ErrorBoundary","_this","possibleConstructorReturn","getPrototypeOf","hasError","client","ApolloClient","headers","authorization","onError","graphQLErrors","errorMessage","extensions","code","Locale","ErrorBoundary_ErrorBoundary","ApolloProvider","routes","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","onUpdate","onSuccess","catch","ReactDOM","src_App_0","getElementById","URL","process","href","fetch","response","contentType","status","ready","unregister","reload","checkValidServiceWorker","react__WEBPACK_IMPORTED_MODULE_0__"],"mappings":"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","file":"static/js/main.35bcb52d.chunk.js","sourcesContent":["import * as React from 'react';\nimport { NavigateFn } from '@reach/router';\nimport { Layout, Menu, Divider, Dropdown, Button, Icon } from 'antd';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport { UserContext } from '$contexts/User';\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { locales } from '$assets/locales';\n\nimport logo from '$images/logo.png';\n\nimport './index.less';\n\ninterface HomeProps {\n  children: React.ReactNode;\n  path: string;\n  uri?: string;\n  '*'?: string;\n  navigate?: NavigateFn;\n}\n\nconst { Header, Sider, Content } = Layout;\n\nexport default React.memo(function Home(props: HomeProps) {\n  const { setUser } = React.useContext(UserContext);\n  const { locale, setLocale } = React.useContext(LocaleContext);\n  const currentPaths = React.useMemo(() => [`${props.uri}${props['*']}`], [\n    props.uri,\n    props['*'],\n  ]);\n  const localeItems = React.useMemo(\n    () => [\n      {\n        key: locales.en_US.locale.key,\n        value: locales.en_US.locale.value,\n      },\n      {\n        key: locales.zh_CN.locale.key,\n        value: locales.zh_CN.locale.value,\n      },\n    ],\n    [locale],\n  );\n  const siderMenuItems = React.useMemo(\n    () => [\n      {\n        key: AbsoluteRoute.User.Home.Reports,\n        value: locale.user.home.reports.title,\n      },\n      {\n        key: AbsoluteRoute.User.Home.DataSources,\n        value: locale.user.home.dataSources.title,\n      },\n    ],\n    [locale],\n  );\n  const localeDropDown = React.useMemo(\n    () => (\n      <Menu>\n        {localeItems.map(localeItem => (\n          <Menu.Item\n            key={localeItem.key}\n            onClick={React.useCallback(\n              () => setLocale(locales[localeItem.key]),\n              [localeItem.key],\n            )}\n          >\n            {localeItem.value}\n          </Menu.Item>\n        ))}\n      </Menu>\n    ),\n    [localeItems],\n  );\n\n  const signOut = React.useCallback(() => {\n    setUser({ id: '', username: '', token: '', hasSignedIn: false });\n  }, []);\n\n  const changePath = React.useCallback(\n    ({ key }: { key: string }) => props.navigate!(key),\n    [],\n  );\n\n  return (\n    <Layout className=\"page-container\">\n      <Header className=\"user-header\">\n        <img src={logo} alt=\"logo\" className=\"logo\" />\n        <div className=\"right-section\">\n          <Dropdown overlay={localeDropDown} trigger={['click']}>\n            <Button size=\"small\">\n              {locale.locale.value} <Icon type=\"down\" />\n            </Button>\n          </Dropdown>\n          <Divider type=\"vertical\" />\n          <Button size=\"small\" onClick={signOut}>\n            {locale.user.signOut}\n          </Button>\n        </div>\n      </Header>\n      <Layout>\n        <Sider className=\"user-sider\">\n          <Menu selectedKeys={currentPaths} onClick={changePath}>\n            {siderMenuItems.map(siderMenuItem => (\n              <Menu.Item key={siderMenuItem.key}>\n                {siderMenuItem.value}\n              </Menu.Item>\n            ))}\n          </Menu>\n        </Sider>\n        <Content className=\"user-content\">{props.children}</Content>\n      </Layout>\n    </Layout>\n  );\n});\n","import * as React from 'react';\nimport { Spin } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport './index.less';\n\ninterface LoadingProps {\n  children?: React.ReactNode;\n}\n\nexport default React.memo(function Loading(props: LoadingProps) {\n  const { locale } = React.useContext(LocaleContext);\n\n  return <Spin tip={locale.common.loading}>{props.children}</Spin>;\n});\n","import * as React from 'react';\nimport { Query, Mutation, QueryResult, OperationVariables } from 'react-apollo';\nimport { List, Button } from 'antd';\nimport moment from 'moment';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport Loading from '$components/Loading';\nimport Error from '$components/Error';\n\nimport './index.less';\n\ninterface CustomListProps {\n  responseKey: string;\n  itemIcon: React.ReactNode;\n  getListItems: any;\n  removeListItem?: any;\n  listHeader?:\n    | ((queryResult: QueryResult<any, OperationVariables>) => any)\n    | React.ReactNode;\n  handleListItemClick?(id: string): void;\n  itemNameFormatter?(name: string): string;\n}\n\nexport default React.memo(function CustomList(props: CustomListProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const {\n    responseKey,\n    getListItems,\n    handleListItemClick,\n    removeListItem,\n    itemIcon,\n    itemNameFormatter,\n    listHeader,\n  } = props;\n\n  return (\n    <Query query={getListItems}>\n      {queryResult => {\n        const { data, loading, error, refetch } = queryResult;\n\n        if (loading) return <Loading />;\n\n        if (error) return <Error />;\n\n        const dataSource =\n          (data && data[responseKey] && data[responseKey].rows) || [];\n        const header = listHeader\n          ? typeof listHeader === 'function'\n            ? (listHeader as (\n                queryResult: QueryResult<any, OperationVariables>,\n              ) => any)(queryResult)\n            : listHeader\n          : undefined;\n        const listItemStyle = handleListItemClick\n          ? { cursor: 'pointer' }\n          : undefined;\n\n        return (\n          <div className=\"custom-list\">\n            <List\n              header={header}\n              bordered\n              dataSource={dataSource}\n              renderItem={(item: any) => (\n                <List.Item\n                  key={item.id}\n                  className=\"list-item\"\n                  style={listItemStyle}\n                  onClick={\n                    handleListItemClick\n                      ? e => handleListItemClick(item.id)\n                      : undefined\n                  }\n                >\n                  <div className=\"left-section\">\n                    {itemIcon}\n                    <div className=\"list-item-info\">\n                      <span className=\"title\">\n                        {itemNameFormatter\n                          ? itemNameFormatter(item.name)\n                          : item.name}\n                      </span>\n                      <div className=\"detail\">\n                        <span>\n                          {locale.common.createdAt}:{' '}\n                          {moment(item.createdAt).format('lll')}\n                        </span>\n                        <span>\n                          {locale.common.updatedAt}:{' '}\n                          {moment(item.updatedAt).format('lll')}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  {removeListItem && (\n                    <Mutation\n                      mutation={removeListItem}\n                      variables={{ id: item.id }}\n                      onCompleted={refetch}\n                    >\n                      {(removeListItem, { loading }) => (\n                        <Button\n                          type=\"danger\"\n                          shape=\"circle\"\n                          icon=\"delete\"\n                          loading={loading}\n                          onClick={(\n                            e: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n                          ) => {\n                            e.stopPropagation();\n                            removeListItem();\n                          }}\n                        />\n                      )}\n                    </Mutation>\n                  )}\n                </List.Item>\n              )}\n            />\n          </div>\n        );\n      }}\n    </Query>\n  );\n});\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M206.912 960l-128 0 0-149.376 128-102.976L206.912 960zM457.6 656 392.704 580.352 329.6 631.616 329.6 960l128 0L457.6 656zM708.224 605.632l-128 119.36L580.224 960l128 0L708.224 605.632zM958.912 379.968l-128 121.024L830.912 960l128 0L958.912 379.968zM942.912 256c11.328-13.568 9.472-33.728-4.032-45.056-13.568-11.264-33.664-9.472-45.056 4.032l-336 319.168L391.616 370.88 76.8 629.76c-14.144 10.624-17.024 30.656-6.464 44.736 10.688 14.144 30.656 17.024 44.8 6.528l274.304-224.64 169.408 167.68L942.912 256zM1009.344 323.328l0.064-177.024c-0.064-9.344-3.328-17.088-9.472-23.36-6.4-6.272-14.08-9.344-23.232-9.408l-177.152 0.064c-9.28-0.064-17.024 3.2-23.296 9.344C769.92 129.28 766.72 136.96 766.656 146.368c0.064 9.28 3.264 16.96 9.472 23.232l177.088 177.024c6.4 6.4 14.08 9.536 23.232 9.536 9.344-0.064 17.216-3.2 23.36-9.536C1006.08 340.352 1009.344 332.672 1009.344 323.328z\",\n  pId: 2963\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551529198213,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 2962,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/report.4bbbd3a4.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport { NavigateFn } from '@reach/router';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Button, Icon } from 'antd';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport CustomList from '$components/CustomList';\n\nimport { ReactComponent as ReportSvg } from '$assets/icons/report.svg';\n\ninterface ReportsProps {\n  path: string;\n  navigate?: NavigateFn;\n}\n\nconst GET_ALL_REPORTS = gql`\n  query {\n    getAllReports {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n`;\n\nconst ADD_REPORT = gql`\n  mutation {\n    addReport {\n      id\n    }\n  }\n`;\n\nconst REMOVE_REPORT = gql`\n  mutation removeReport($id: ID!) {\n    removeReport(id: $id)\n  }\n`;\n\nconst reportIcon = (\n  <Icon\n    component={ReportSvg as any}\n    style={{ fontSize: 32, color: '#1890ff' }}\n  />\n);\n\nexport default React.memo(function Reports(props: ReportsProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { navigate } = props;\n  const reportsHeader = React.useCallback(\n    ({ refetch }) => (\n      <Mutation\n        mutation={ADD_REPORT}\n        onCompleted={async({ addReport: { id } }) => {\n          await refetch();\n          navigate!(AbsoluteRoute.User.Report.replace(':reportId', id));\n        }}\n      >\n        {(addReport, { loading }) => (\n          <Button\n            type=\"primary\"\n            icon=\"plus\"\n            loading={loading}\n            onClick={addReport as any}\n          >\n            {locale.user.home.reports.addReport}\n          </Button>\n        )}\n      </Mutation>\n    ),\n    [locale],\n  );\n  const handleListItemClick = React.useCallback(\n    (id: string) =>\n      props.navigate!(AbsoluteRoute.User.Report.replace(':reportId', id)),\n    [],\n  );\n  const reportNameFormatter = React.useCallback(\n    (name: string) => name || locale.user.home.reports.unnamedReport,\n    [locale],\n  );\n\n  return (\n    <div>\n      <CustomList\n        responseKey=\"getAllReports\"\n        getListItems={GET_ALL_REPORTS}\n        removeListItem={REMOVE_REPORT}\n        itemIcon={reportIcon}\n        listHeader={reportsHeader}\n        handleListItemClick={handleListItemClick}\n        itemNameFormatter={reportNameFormatter}\n      />\n    </div>\n  );\n});\n","import * as React from 'react';\nimport { ApolloQueryResult } from 'apollo-boost';\nimport { graphql, OperationVariables, MutationFn } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Upload, Button, Icon, message } from 'antd';\nimport { DataSet } from '@antv/data-set';\n\nimport { LocaleContext } from '$contexts/Locale';\n\ninterface UploadDataInputProps {\n  onDataUploaded(\n    variables?: OperationVariables | undefined,\n  ): Promise<ApolloQueryResult<any>>;\n}\n\ninterface Response {\n  data: string;\n}\n\ninterface Variables {\n  name: string;\n  data: string;\n}\n\ninterface UploadDataProps {\n  uploadData: MutationFn<Response, Variables> | undefined;\n}\n\nconst ADD_DATA_SOURCE = gql`\n  mutation addDataSource($name: String!, $data: String!) {\n    addDataSource(name: $name, data: $data) {\n      id\n    }\n  }\n`;\n\nfunction UploadData(props: UploadDataProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { uploadData } = props;\n\n  const beforeUpload = React.useCallback(file => {\n    const fileReader = new FileReader();\n\n    fileReader.readAsText(file);\n    fileReader.onload = function(event: FileReaderEventMap['load']) {\n      if (event.target) {\n        if (file.type === 'application/json') {\n          // 确保上传的 json 文件内容格式正确。\n          try {\n            const data = JSON.stringify(\n              JSON.parse((event.target as any).result),\n            );\n            uploadData &&\n              uploadData({\n                variables: {\n                  name: file.name,\n                  data,\n                },\n              });\n          } catch (error) {\n            message.error(locale.error.fileContentError);\n          }\n        }\n\n        if (file.type === 'text/csv') {\n          const dataView = new DataSet.View()\n            .source((event.target as any).result, {\n              type: 'csv',\n            })\n            // 上传数据类型自动转换，优先级: Number > Text。\n            .transform({\n              type: 'map',\n              callback(row: any) {\n                const result = {};\n\n                for (const key in row) {\n                  const valueToNumber = Number(row[key]);\n\n                  if (!Number.isNaN(valueToNumber)) {\n                    result[key] = valueToNumber;\n                    continue;\n                  }\n\n                  result[key] = row[key];\n                }\n\n                return result;\n              },\n            });\n\n          uploadData &&\n            uploadData({\n              variables: {\n                name: file.name,\n                data: JSON.stringify(dataView.rows),\n              },\n            });\n        }\n      }\n    };\n\n    return false;\n  }, []);\n\n  return (\n    <Upload\n      accept=\".csv,.json\"\n      showUploadList={false}\n      beforeUpload={beforeUpload}\n    >\n      <Button>\n        <Icon type=\"upload\" />\n        {locale.user.home.dataSources.addDataSource}\n      </Button>\n    </Upload>\n  );\n}\n\nexport default React.memo(\n  graphql<UploadDataInputProps, Response, Variables, UploadDataProps>(\n    ADD_DATA_SOURCE,\n    {\n      options: ({ onDataUploaded }) => ({\n        onCompleted: onDataUploaded,\n      }),\n      props: ({ mutate }) => ({\n        uploadData: mutate,\n      }),\n    },\n  )(UploadData),\n);\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M512 42.666667C314.197333 42.666667 101.333333 102.314667 101.333333 233.344l0 557.312C101.333333 921.642667 314.197333 981.333333 512 981.333333c197.802667 0 410.666667-59.690667 410.666667-190.677333L922.666667 233.344C922.666667 102.314667 709.76 42.666667 512 42.666667zM864 790.656c0 72.874667-157.568 132.010667-352 132.010667-194.389333 0-352-59.136-352-132.010667l0-109.610667c60.629333 62.506667 206.762667 94.976 352 94.976 145.194667 0 291.370667-32.469333 352-94.976L864 790.656zM864 614.656l-0.128 0c0 0.256 0.128 0.682667 0.128 0.896 0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072 0-0.256 0.128-0.682667 0.128-0.896L160 614.656l0-109.610667c60.629333 62.421333 206.762667 94.933333 352 94.933333 145.194667 0 291.370667-32.512 352-94.933333L864 614.656zM864 438.656l-0.128 0 0.128 0.896c0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072l0.128-0.896L160 438.656 160 337.877333C236.885333 396.458667 377.770667 424.021333 512 424.021333c134.229333 0 275.114667-27.562667 352-86.101333L864 438.656zM512 365.312c-194.389333 0-352-59.136-352-132.010667 0-72.917333 157.610667-132.010667 352-132.010667 194.432 0 352 59.050667 352 132.010667C864 306.218667 706.432 365.312 512 365.312zM776.021333 776.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 821.589333 746.666667 805.333333 759.765333 776.021333 776.021333 776.021333zM776.021333 599.978667c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 645.589333 746.666667 629.333333 759.765333 599.978667 776.021333 599.978667zM776.021333 424.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 469.546667 746.666667 453.333333 759.765333 424.021333 776.021333 424.021333z\",\n  pId: 2818\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551529026004,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 2817,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/data-source.f24428ad.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport gql from 'graphql-tag';\nimport { Icon } from 'antd';\n\nimport CustomList from '$components/CustomList';\nimport UploadData from '$components/UploadData';\n\nimport { ReactComponent as DataSourceSvg } from '$assets/icons/data-source.svg';\n\ninterface DataSourcesProps {\n  path: string;\n}\n\nconst GET_DATA_SOURCES = gql`\n  query {\n    getDataSources {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n`;\n\nconst REMOVE_DATA_SOURCE = gql`\n  mutation removeDataSource($id: ID!) {\n    removeDataSource(id: $id)\n  }\n`;\n\nconst dataSourceIcon = (\n  <Icon\n    component={DataSourceSvg as any}\n    style={{ fontSize: 32, color: '#1890ff' }}\n  />\n);\n\nconst dataSourcesHeader = ({ refetch }: any) => (\n  <UploadData onDataUploaded={refetch} />\n);\n\nexport default React.memo(function DataSources(props: DataSourcesProps) {\n  return (\n    <div>\n      <CustomList\n        responseKey=\"getDataSources\"\n        getListItems={GET_DATA_SOURCES}\n        removeListItem={REMOVE_DATA_SOURCE}\n        itemIcon={dataSourceIcon}\n        listHeader={dataSourcesHeader}\n      />\n    </div>\n  );\n});\n","import * as React from 'react';\nimport ContentEditable from 'react-contenteditable';\n\nimport './index.less';\n\ninterface TextProps {\n  ref?: React.RefObject<HTMLDivElement>;\n  disabled?: boolean;\n  placeholder?: string;\n  text: string;\n  style?: any;\n  className?: string;\n  onKeyDown?(event: React.KeyboardEvent<HTMLDivElement>): void;\n  onDoubleClick?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onChange?(event: any): void;\n  onBlur?(event: React.FocusEvent<HTMLDivElement>): void;\n}\n\nfunction pasteOnlyText(event: React.ClipboardEvent<HTMLDivElement>) {\n  event.preventDefault();\n  event.stopPropagation();\n  document.execCommand(\n    'insertHTML',\n    false,\n    event.clipboardData.getData('text/plain'),\n  );\n}\n\nfunction TextEditor(props: TextProps, ref: any) {\n  const {\n    disabled,\n    placeholder,\n    text,\n    style,\n    className,\n    onKeyDown,\n    onDoubleClick,\n    onChange,\n    onBlur,\n  } = props;\n\n  return (\n    // @ts-ignore\n    <ContentEditable\n      innerRef={ref}\n      disabled={disabled || false}\n      placeholder={placeholder}\n      spellCheck={false}\n      html={text}\n      style={style}\n      className={`text-editor${className ? ` ${className}` : ''}`}\n      onKeyDown={React.useCallback(\n        (event: React.KeyboardEvent<HTMLDivElement>) => {\n          event.stopPropagation();\n          onKeyDown && onKeyDown(event);\n        },\n        [onKeyDown],\n      )}\n      onClick={React.useCallback(\n        (event: React.MouseEvent<HTMLDivElement, MouseEvent>) =>\n          event.stopPropagation(),\n        [],\n      )}\n      onDoubleClick={React.useCallback(\n        (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n          event.stopPropagation();\n          onDoubleClick && onDoubleClick(event);\n        },\n        [onDoubleClick],\n      )}\n      onChange={onChange}\n      onPaste={pasteOnlyText}\n      onBlur={onBlur}\n    />\n  );\n}\n\nexport default React.memo(React.forwardRef(TextEditor));\n","export default function customMetaKey({\n  ctrlKey,\n  metaKey,\n}: {\n  ctrlKey: boolean;\n  metaKey: boolean;\n}): boolean {\n  const { platform } = window.navigator;\n\n  return (\n    (platform.includes('Win') && ctrlKey) ||\n    (platform.includes('Mac') && metaKey)\n  );\n}\n","import { Canvas } from '@antv/g';\n\nexport default class GController {\n  private _canvas: Canvas;\n  private _canvasContainerSelector = '.report-canvas-container';\n  private _canvasSelector = '#report-canvas';\n\n  public init() {\n    const canvasContainer = document.querySelector(\n      this._canvasContainerSelector,\n    )!;\n    const canvas = document.querySelector(this._canvasSelector)!;\n    const { clientWidth: width, clientHeight: height } = canvasContainer;\n    const { id: containerId } = canvas;\n\n    this._canvas = new Canvas({\n      containerId,\n      width,\n      height,\n    });\n  }\n\n  public destroy() {\n    this._canvas.destroy();\n  }\n}\n","// prettier-ignore\nexport default function bind(target: any, propertyKey: string, descriptor: PropertyDescriptor) {\n  // In IE11 calling Object.defineProperty has a side-effect of evaluating the\n  // getter for the property which is being replaced. This causes infinite\n  // recursion and an \"Out of stack space\" error.\n  let definingProperty = false;\n  const originalFn = descriptor.value;\n\n  return {\n    configurable: true,\n    get() {\n      if (definingProperty) {\n        return originalFn;\n      }\n\n      const value = originalFn.bind(this);\n\n      definingProperty = true;\n      Object.defineProperty(this, propertyKey, {\n        value,\n        configurable: true,\n        writable: true,\n      });\n      definingProperty = false;\n\n      return value;\n    },\n  };\n}\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Line from 'bizcharts/lib/components/TypedGeom/Line';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface LineChartOptions {\n  isXAxisTime?: boolean;\n  isLineSmooth?: boolean;\n}\n\ninterface LineChartProps extends CommonChartProps {\n  options: LineChartOptions;\n}\n\nexport default React.memo(function LineChart(props: LineChartProps) {\n  const { width, height, data, options } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxes = dataKeys.slice(1, dataKeys.length);\n  const yAxisKey = 'yAxisKey';\n  const yAxisValue = 'yAxisValue';\n  const position = `${xAxis}*${yAxisValue}`;\n  const scale = React.useMemo(\n    () => ({\n      [xAxis]: options.isXAxisTime\n        ? {\n            type: 'time',\n            nice: true,\n          }\n        : {\n            nice: true,\n          },\n    }),\n    [options.isXAxisTime],\n  );\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'fold',\n      fields: yAxes,\n      key: yAxisKey,\n      value: yAxisValue,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxisValue} />\n      <Tooltip\n        crosshairs={{\n          type: 'y',\n        }}\n      />\n      <Line\n        position={position}\n        size={2}\n        color={yAxisKey}\n        shape={options.isLineSmooth ? 'smooth' : undefined}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Interval from 'bizcharts/lib/components/TypedGeom/Interval';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface BarChartOptions {}\n\ninterface BarChartProps extends CommonChartProps {\n  options: BarChartOptions;\n}\n\nexport default React.memo(function BarChart(props: BarChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxes = dataKeys.slice(1, dataKeys.length);\n  const yAxisKey = 'yAxisKey';\n  const yAxisValue = 'yAxisValue';\n  const position = `${xAxis}*${yAxisValue}`;\n  const scale = {\n    [xAxis]: {\n      nice: true,\n    },\n  };\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'fold',\n      fields: yAxes,\n      key: yAxisKey,\n      value: yAxisValue,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxisValue} />\n      <Tooltip\n        crosshairs={{\n          type: 'y',\n        }}\n      />\n      <Interval\n        position={position}\n        color={yAxisKey}\n        adjust={[\n          {\n            type: 'dodge',\n            marginRatio: 0,\n          },\n        ]}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Coord from 'bizcharts/lib/components/Coord';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\n// 引入 Geom 会把 bizcharts 和 G2 全部引入，后续留意 G2 按需加载组件的更新。\nimport Geom from 'bizcharts/lib/components/Geom';\nimport Label from 'bizcharts/lib/components/Label';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface PieChartOptions {}\n\ninterface PieChartProps extends CommonChartProps {\n  options: PieChartOptions;\n}\n\nexport default React.memo(function PieChart(props: PieChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const item = dataKeys[0];\n  const count = dataKeys[1];\n  const percent = 'percent';\n  const scale = {\n    percent: {\n      formatter: (val: number) => `${val * 100}%`,\n    },\n  };\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'percent',\n      fields: count,\n      dimension: item,\n      as: percent,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Coord type=\"theta\" />\n      <Axis name={percent} />\n      <Legend offsetY={50} clickable={false} />\n      <Geom\n        type=\"intervalStack\"\n        position={percent}\n        color={item}\n        tooltip={[\n          `${item}*${percent}`,\n          (item: string, percent: number) => ({\n            name: item,\n            value: `${percent * 100}%`,\n          }),\n        ]}\n        style={{\n          lineWidth: 1,\n          stroke: '#fff',\n        }}\n      >\n        <Label\n          content={percent}\n          formatter={(val: string, item: any) => `${item.point.item}: ${val}`}\n        />\n      </Geom>\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Point from 'bizcharts/lib/components/TypedGeom/Point';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface ScatterChartOptions {}\n\ninterface ScatterChartProps extends CommonChartProps {\n  options: ScatterChartOptions;\n}\n\nexport default React.memo(function ScatterChart(props: ScatterChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxis = dataKeys[1];\n  const point = dataKeys.slice(2, dataKeys.length).join(' ');\n  const position = `${xAxis}*${yAxis}`;\n  const scale = {\n    [xAxis]: {\n      nice: true,\n    },\n  };\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxis} />\n      <Tooltip\n        crosshairs={{\n          type: 'cross',\n        }}\n      />\n      <Point\n        position={position}\n        opacity={0.65}\n        shape=\"circle\"\n        size={3}\n        color={point}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport TextEditor from '$components/TextEditor';\n\ninterface TextProps {\n  text: string;\n  onChange?(event: any): void;\n}\n\nfunction placeCaretAtEnd(el: HTMLElement) {\n  el.focus();\n\n  if (\n    typeof window.getSelection != 'undefined' &&\n    typeof document.createRange != 'undefined'\n  ) {\n    const range = document.createRange();\n\n    range.selectNodeContents(el);\n    range.collapse(false);\n\n    const selection = window.getSelection();\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n  } else if (typeof (document.body as any).createTextRange != 'undefined') {\n    const textRange = (document.body as any).createTextRange();\n\n    textRange.moveToElementText(el);\n    textRange.collapse(false);\n    textRange.select();\n  }\n}\n\nexport default React.memo(function Text(props: TextProps) {\n  const { text, onChange } = props;\n  const { locale } = React.useContext(LocaleContext);\n  const [contentEditable, setContentEditable] = React.useState(false);\n  const editorRef = React.useRef<HTMLDivElement>(null);\n\n  React.useEffect(() => {\n    if (contentEditable) {\n      editorRef.current && placeCaretAtEnd(editorRef.current);\n    }\n  }, [contentEditable]);\n\n  return (\n    <TextEditor\n      ref={editorRef}\n      disabled={!contentEditable}\n      placeholder={locale.user.report.textEmptyTips}\n      text={text}\n      style={contentEditable ? { cursor: 'text' } : undefined}\n      onDoubleClick={React.useCallback(() => setContentEditable(true), [])}\n      onChange={onChange}\n      onBlur={React.useCallback(() => setContentEditable(false), [])}\n    />\n  );\n});\n","import * as React from 'react';\nimport { Empty } from 'antd';\n\nimport LineChart, { LineChartOptions } from '$components/Charts/LineChart';\nimport BarChart, { BarChartOptions } from '$components/Charts/BarChart';\nimport PieChart, { PieChartOptions } from '$components/Charts/PieChart';\nimport ScatterChart, {\n  ScatterChartOptions,\n} from '$components/Charts/ScatterChart';\n\nimport Text from './Text';\n\nimport './index.less';\n\nexport enum ReportElType {\n  Chart = 'chart',\n  Text = 'text',\n}\n\nexport enum ReportChartType {\n  LineChart = 'lineChart',\n  BarChart = 'barChart',\n  PieChart = 'pieChart',\n  ScatterChart = 'scatterChart',\n}\n\ninterface ReportCommonEl {\n  id: string;\n  type: ReportElType;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  selected: boolean;\n  editing: boolean;\n}\n\nexport interface ReportChartDataSource {\n  id: string;\n  data: any;\n}\n\nexport type ReportChartOptions =\n  | LineChartOptions\n  | BarChartOptions\n  | PieChartOptions\n  | ScatterChartOptions;\n\ninterface ReportChart extends ReportCommonEl {\n  type: ReportElType.Chart;\n  chartType: ReportChartType;\n  dataSource: ReportChartDataSource;\n  options: ReportChartOptions;\n}\n\ninterface ReportText extends ReportCommonEl {\n  type: ReportElType.Text;\n  text: string;\n}\n\nexport type ReportEl = ReportChart | ReportText;\n\ntype ReportElementProps = ReportEl & {\n  onMouseDown?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onMouseUp?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onInputText?(event: any): void;\n  onMouseMove?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n};\n\n// 与 './index.less' 中的 @report-element-selected-border-width 保持同步。\nconst reportElSelectedBorderWidth = 2;\n\nexport default React.memo(function ReportElement(props: ReportElementProps) {\n  const {\n    id,\n    type,\n    x,\n    y,\n    width,\n    height,\n    selected,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp,\n    onInputText,\n  } = props;\n\n  return (\n    <div\n      style={{\n        width: width + reportElSelectedBorderWidth * 2,\n        height:\n          height +\n          (type === ReportElType.Chart ? 6 : 0) +\n          reportElSelectedBorderWidth * 2,\n        transform: `translate(${x}px, ${y}px)`,\n      }}\n      className={`report-element${selected ? ' report-element-selected' : ''}`}\n      id={id}\n      data-x={x}\n      data-y={y}\n      onMouseMove={onMouseMove}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}\n    >\n      {(() => {\n        switch (props.type) {\n          case ReportElType.Chart:\n            if (\n              !props.dataSource ||\n              !props.dataSource.id ||\n              !props.dataSource.data.rows ||\n              props.dataSource.data.rows.length === 0\n            ) {\n              return <Empty style={{ height: '100%' }} />;\n            }\n\n            const chartProps = {\n              width,\n              height,\n              data: props.dataSource.data,\n              options: props.options,\n            };\n\n            switch (props.chartType) {\n              case ReportChartType.LineChart:\n                return <LineChart {...chartProps} />;\n              case ReportChartType.BarChart:\n                return <BarChart {...chartProps} />;\n              case ReportChartType.PieChart:\n                return <PieChart {...chartProps} />;\n              case ReportChartType.ScatterChart:\n                return <ScatterChart {...chartProps} />;\n              default:\n                // prettier-ignore\n                throw new Error(`Invalid reportEl chartType ${props.chartType}.`);\n            }\n          case ReportElType.Text:\n            return <Text text={props.text} onChange={onInputText} />;\n          default:\n            // prettier-ignore\n            throw new Error(`Invalid reportEl type ${(props as any).type}.`);\n        }\n      })()}\n    </div>\n  );\n});\n","import DataSet from '@antv/data-set';\n\nimport {\n  ReportEl,\n  ReportElType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from './index';\n\nexport enum ReportElsActionType {\n  Add = 'add',\n  Delete = 'delete',\n  Move = 'move',\n  Resize = 'resize',\n  StartEdit = 'startEdit',\n  Select = 'select',\n  Unselect = 'unselect',\n  InputText = 'inputText',\n  SetChartDataSource = 'setChartsDataSource',\n  SetChartOptions = 'setChartsOptions',\n  Undo = 'undo',\n  Redo = 'redo',\n}\n\ninterface ReportElsCommonAction {\n  type: ReportElsActionType;\n  payload?: any;\n  disallowUndo?: boolean;\n}\n\ninterface ReportElsAddAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Add;\n  payload: ReportEl[];\n}\n\ninterface ReportElsDeleteAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Delete;\n  payload: string[];\n}\n\ninterface ReportElsMoveAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Move;\n  payload: {\n    id: string;\n    x: number;\n    y: number;\n  }[];\n}\n\ninterface ReportElsResizeAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Resize;\n  payload: {\n    id: string;\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }[];\n}\n\ninterface ReportElsStartEditAction extends ReportElsCommonAction {\n  type: ReportElsActionType.StartEdit;\n  payload: string;\n  disallowUndo: true;\n}\ninterface ReportElsSelectAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Select;\n  payload: string[];\n  disallowUndo: true;\n}\n\ninterface ReportElsUnselectAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Unselect;\n  payload: string[];\n  disallowUndo: true;\n}\n\ninterface InputTextAction extends ReportElsCommonAction {\n  type: ReportElsActionType.InputText;\n  payload: { id: string; text: string };\n}\ninterface SetChartDataSourceAction extends ReportElsCommonAction {\n  type: ReportElsActionType.SetChartDataSource;\n  payload: { id: string; dataSource: ReportChartDataSource };\n}\ninterface SetChartOptionsAction extends ReportElsCommonAction {\n  type: ReportElsActionType.SetChartOptions;\n  payload: { id: string; options: ReportChartOptions };\n}\n\ninterface ReportElsUndoAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Undo;\n  disallowUndo: true;\n}\n\ninterface ReportElsRedoAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Redo;\n  disallowUndo: true;\n}\n\nexport type ReportElsAction =\n  | ReportElsAddAction\n  | ReportElsDeleteAction\n  | ReportElsMoveAction\n  | ReportElsResizeAction\n  | ReportElsStartEditAction\n  | ReportElsSelectAction\n  | ReportElsUnselectAction\n  | InputTextAction\n  | SetChartDataSourceAction\n  | SetChartOptionsAction\n  | ReportElsUndoAction\n  | ReportElsRedoAction;\n\ninterface ReportEls {\n  undoStack: ReportElsAction[];\n  redoStack: ReportElsAction[];\n  state: ReportEl[];\n}\n\nconst undoStackMaxLength = 10000;\n\nexport default function reportElsReducer(\n  reportEls: ReportEls,\n  action: ReportElsAction,\n): ReportEls {\n  const { undoStack, redoStack } = reportEls;\n  const originalActionType = action.type;\n  let newUndoStack: ReportElsAction[] = [];\n  let newRedoStack: ReportElsAction[] = [];\n\n  switch (action.type) {\n    case ReportElsActionType.Undo:\n      if (undoStack.length > 0) {\n        action = undoStack[undoStack.length - 1];\n        newUndoStack = undoStack.slice(0, undoStack.length - 1);\n      } else {\n        return reportEls;\n      }\n      break;\n    case ReportElsActionType.Redo:\n      if (redoStack.length > 0) {\n        action = redoStack[redoStack.length - 1];\n        newRedoStack = redoStack.slice(0, redoStack.length - 1);\n      } else {\n        return reportEls;\n      }\n      break;\n    default:\n      break;\n  }\n\n  // 不执行无用的 action 。\n  if (action.payload.length === 0) return reportEls;\n\n  let reverseAction: ReportElsAction | null = null;\n  let newReportElsState: ReportEl[];\n\n  switch (action.type) {\n    case ReportElsActionType.Add:\n      reverseAction = {\n        type: ReportElsActionType.Delete,\n        payload: action.payload.map(\n          reportElWillRemove => reportElWillRemove.id,\n        ),\n      };\n\n      newReportElsState = reportEls.state\n        .map(reportEl => ({\n          ...reportEl,\n          selected: false,\n          editing: false,\n        }))\n        .concat(\n          action.payload.map(reportElWillAdd =>\n            reportElWillAdd.type === ReportElType.Chart\n              ? {\n                  ...reportElWillAdd,\n                  dataSource: {\n                    ...reportElWillAdd.dataSource,\n                    data: new DataSet.View().source(\n                      reportElWillAdd.dataSource.data,\n                    ),\n                  },\n                }\n              : reportElWillAdd,\n          ),\n        );\n      break;\n    case ReportElsActionType.Delete:\n      reverseAction = {\n        type: ReportElsActionType.Add,\n        payload: reportEls.state\n          .filter(reportEl => action.payload.indexOf(reportEl.id) !== -1)\n          .map(reportElWillAdd =>\n            reportElWillAdd.type === ReportElType.Chart\n              ? {\n                  ...reportElWillAdd,\n                  dataSource: {\n                    ...reportElWillAdd.dataSource,\n                    data: reportElWillAdd.dataSource.data.origin,\n                  },\n                }\n              : reportElWillAdd,\n          ),\n      };\n\n      newReportElsState = reportEls.state.filter(\n        reportEl => action.payload.indexOf(reportEl.id) === -1,\n      );\n      break;\n    case ReportElsActionType.Move:\n      reverseAction = {\n        type: ReportElsActionType.Move,\n        payload: reportEls.state\n          .filter(reportEl =>\n            (action.payload as ReportElsMoveAction['payload']).some(\n              reportElMoved => reportElMoved.id === reportEl.id,\n            ),\n          )\n          .map(reportElWillMove => {\n            const { id, x, y } = reportElWillMove;\n\n            return { id, x, y };\n          }),\n      };\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        for (const reportElMoved of action.payload as ReportElsMoveAction['payload']) {\n          if (reportEl.id === reportElMoved.id) {\n            const { x, y } = reportElMoved;\n            const { width, height } = reportEl;\n            const { clientWidth, clientHeight } = document.querySelector(\n              '.report-canvas-container',\n            )!;\n\n            return {\n              ...reportEl,\n              // 2 * 2 中的第一个 2 是 reportEl 的边框宽度。\n              x: Math.max(Math.min(x, clientWidth - width - 2 * 2), 0),\n              y: Math.max(Math.min(y, clientHeight - height - 2 * 2), 0),\n            };\n          }\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.Resize:\n      reverseAction = {\n        type: ReportElsActionType.Resize,\n        payload: reportEls.state\n          .filter(reportEl =>\n            (action.payload as ReportElsResizeAction['payload']).some(\n              reportElResized => reportElResized.id === reportEl.id,\n            ),\n          )\n          .map(reportElWillResize => {\n            const { id, x, y, width, height } = reportElWillResize;\n\n            return { id, x, y, width, height };\n          }),\n      };\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        for (const reportElResized of action.payload as ReportElsResizeAction['payload']) {\n          if (reportEl.id === reportElResized.id) {\n            const { x, y, width, height } = reportElResized;\n            const { clientWidth, clientHeight } = document.querySelector(\n              '.report-canvas-container',\n            )!;\n\n            return {\n              ...reportEl,\n              // 2 * 2 中的第一个 2 是 reportEl 的边框宽度。\n              x: Math.max(Math.min(x, clientWidth - width - 2 * 2), 0),\n              y: Math.max(Math.min(y, clientHeight - height - 2 * 2), 0),\n              width,\n              height,\n            };\n          }\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.StartEdit:\n      newReportElsState = reportEls.state.map(reportEl =>\n        reportEl.id === action.payload\n          ? {\n              ...reportEl,\n              selected: true,\n              editing: true,\n            }\n          : {\n              ...reportEl,\n              editing: false,\n            },\n      );\n      break;\n    case ReportElsActionType.Select:\n      newReportElsState = reportEls.state.map(reportEl =>\n        (action.payload as ReportElsSelectAction['payload']).some(\n          reportElSelectedId => reportEl.id === reportElSelectedId,\n        )\n          ? {\n              ...reportEl,\n              selected: true,\n            }\n          : reportEl,\n      );\n      break;\n    case ReportElsActionType.Unselect:\n      newReportElsState = reportEls.state.map(reportEl =>\n        (action.payload as ReportElsSelectAction['payload']).some(\n          reportElSelectedId => reportEl.id === reportElSelectedId,\n        )\n          ? {\n              ...reportEl,\n              selected: false,\n              editing: false,\n            }\n          : reportEl,\n      );\n      break;\n    case ReportElsActionType.InputText:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Text\n        ) {\n          const { id, text } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.InputText,\n            payload: { id, text },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Text\n        ) {\n          return {\n            ...reportEl,\n            text: action.payload.text,\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.SetChartDataSource:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          const { id, dataSource } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.SetChartDataSource,\n            payload: { id, dataSource },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          return {\n            ...reportEl,\n            dataSource: {\n              ...action.payload.dataSource,\n              data: new DataSet.View().source(action.payload.dataSource.data),\n            },\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.SetChartOptions:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          const { id, options } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.SetChartOptions,\n            payload: { id, options },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          return {\n            ...reportEl,\n            options: action.payload.options,\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    default:\n      throw new Error(`Unexcepted action type ${action.type}`);\n  }\n\n  if (!reverseAction || action.disallowUndo) {\n    return {\n      ...reportEls,\n      state: newReportElsState,\n    };\n  }\n\n  if (originalActionType === ReportElsActionType.Undo) {\n    newRedoStack = redoStack.concat(reverseAction);\n  } else {\n    if (originalActionType !== ReportElsActionType.Redo) {\n      newRedoStack = [];\n    }\n\n    newUndoStack =\n      undoStack.length === undoStackMaxLength\n        ? undoStack.slice(1, undoStack.length).concat(reverseAction)\n        : undoStack.concat(reverseAction);\n  }\n\n  return {\n    undoStack: newUndoStack,\n    redoStack: newRedoStack,\n    state: newReportElsState,\n  };\n}\n","import interact from 'interactjs';\n\nimport bind from '$decorators/bind';\n\nimport {\n  ReportElsAction,\n  ReportElsActionType,\n} from '../widgets/ReportElement/reducer';\n\ninterface InteractControllerProps {\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n}\n\ninterface ResizableOptions extends interact.ResizableOptions {\n  restrictEdges: any;\n  restrictSize: any;\n}\n\nexport default class InteractController {\n  private _props: InteractControllerProps;\n  private _selector = '.report-editor .report-element';\n\n  public constructor(props: InteractControllerProps) {\n    this._props = props;\n\n    const draggableOptions: interact.DraggableOptions = {\n      onmove: this._onDragMove,\n      restrict: {\n        restriction: 'parent',\n        elementRect: { top: 0, left: 0, bottom: 1, right: 1 },\n      },\n    };\n    const resizableOptions: ResizableOptions = {\n      onmove: this._onResizeMove,\n      edges: { left: true, right: true, bottom: true, top: true },\n      restrictEdges: {\n        outer: 'parent',\n      },\n      restrictSize: {\n        min: { width: 150, height: 150 },\n      },\n    };\n\n    interact(this._selector)\n      .draggable(draggableOptions)\n      .resizable(resizableOptions);\n  }\n\n  public destroy() {\n    (interact(this._selector) as any).unset();\n  }\n\n  @bind\n  private _onDragMove(event: interact.InteractEvent) {\n    const { target, dx, dy } = event;\n\n    const x = Number(target.getAttribute('data-x')) + dx;\n    const y = Number(target.getAttribute('data-y')) + dy;\n\n    if (Number.isNaN(x) || Number.isNaN(y)) {\n      return;\n    }\n\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Move,\n      payload: [\n        {\n          id: target.id,\n          x,\n          y,\n        },\n      ],\n    });\n  }\n\n  @bind\n  private _onResizeMove(event: interact.InteractEvent) {\n    const { target, deltaRect, rect } = event as any;\n\n    const x = Number(target.dataset.x) + deltaRect.left;\n    const y = Number(target.dataset.y) + deltaRect.top;\n\n    if (Number.isNaN(x) || Number.isNaN(y)) {\n      return;\n    }\n\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Resize,\n      payload: [\n        {\n          id: target.id,\n          x,\n          y,\n          width: rect.width,\n          height: rect.height,\n        },\n      ],\n    });\n  }\n}\n","import bind from '$decorators/bind';\n\nimport { ReportEl } from '../widgets/ReportElement';\nimport {\n  ReportElsActionType,\n  ReportElsAction,\n} from '../widgets/ReportElement/reducer';\nimport customMetaKey from '$utils/customMetaKEey';\n\ninterface ShortCutsControllerProps {\n  reportElsState: ReportEl[];\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n  onSave(reportELs: ReportEl[]): void;\n}\n\nexport default class ShortCutsController {\n  private _props: ShortCutsControllerProps;\n  private _preventDelete = false;\n\n  public constructor(props: ShortCutsControllerProps) {\n    this._props = props;\n    window.addEventListener('keydown', this._onKeydown);\n    window.addEventListener('keyup', this._onKeyup);\n  }\n\n  public update(partialProps: Partial<ShortCutsControllerProps>) {\n    this._props = {\n      ...this._props,\n      ...partialProps,\n    };\n  }\n\n  public destroy() {\n    window.removeEventListener('keydown', this._onKeydown);\n    window.removeEventListener('keyup', this._onKeyup);\n  }\n\n  @bind\n  public _onInputText(id: string, text: string) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.InputText,\n      payload: { id, text },\n    });\n  }\n\n  @bind\n  private _onKeydown(event: KeyboardEvent) {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    switch (event.keyCode) {\n      // delete\n      case 8:\n        if (this._preventDelete) {\n          return;\n        }\n\n        this._preventDelete = true;\n\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Delete,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(selectedReportEl => selectedReportEl.id),\n        });\n        break;\n      // 左\n      case 37:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x + (event.shiftKey ? -1 : -10),\n              y: reportElSelected.y,\n            })),\n        });\n        break;\n      // 上\n      case 38:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x,\n              y: reportElSelected.y + (event.shiftKey ? -1 : -10),\n            })),\n        });\n        break;\n      // 右\n      case 39:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x + (event.shiftKey ? 1 : 10),\n              y: reportElSelected.y,\n            })),\n        });\n        break;\n      // 下\n      case 40:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x,\n              y: reportElSelected.y + (event.shiftKey ? 1 : 10),\n            })),\n        });\n        break;\n      // A\n      case 65:\n        // ctrl(command) + shift + A / ctrl(command) + A: 全选\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          event.shiftKey\n            ? reportElsDispatch({\n                type: ReportElsActionType.Unselect,\n                payload: reportElsState.map(reportEl => reportEl.id),\n                disallowUndo: true,\n              })\n            : reportElsDispatch({\n                type: ReportElsActionType.Select,\n                payload: reportElsState.map(reportEl => reportEl.id),\n                disallowUndo: true,\n              });\n        }\n        break;\n      // S\n      case 83:\n        // ctrl(command) + S: 保存\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          this._props.onSave(reportElsState);\n        }\n        break;\n      // Y\n      case 89:\n        // ctrl(command) + Y: redo\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          reportElsDispatch({\n            type: ReportElsActionType.Redo,\n            disallowUndo: true,\n          });\n        }\n        break;\n      // Z\n      case 90:\n        // ctrl(command) + shift + Z / ctrl(command) + Z: redo / undo\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          event.shiftKey\n            ? reportElsDispatch({\n                type: ReportElsActionType.Redo,\n                disallowUndo: true,\n              })\n            : reportElsDispatch({\n                type: ReportElsActionType.Undo,\n                disallowUndo: true,\n              });\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  @bind\n  private _onKeyup(event: KeyboardEvent) {\n    this._preventDelete = false;\n  }\n}\n","import * as React from 'react';\n\nimport bind from '$decorators/bind';\n\nimport {\n  ReportEl,\n  ReportElType,\n  ReportChartType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from '../widgets/ReportElement';\nimport {\n  ReportElsActionType,\n  ReportElsAction,\n} from '../widgets/ReportElement/reducer';\n\ninterface MouseControllerProps {\n  reportElsState: ReportEl[];\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n}\n\ninterface CanvasContainer {\n  mouseDownPosition: { x: number; y: number };\n}\n\nexport default class MouseController {\n  private _props: MouseControllerProps;\n  private _canvasContainer: CanvasContainer = {\n    mouseDownPosition: { x: 0, y: 0 },\n  };\n\n  public constructor(props: MouseControllerProps) {\n    this._props = props;\n  }\n\n  public update(partialProps: Partial<MouseControllerProps>) {\n    this._props = {\n      ...this._props,\n      ...partialProps,\n    };\n  }\n\n  public destroy() {}\n\n  /** Toolbar */\n  /**\n   * 点击 redo 按钮。\n   */\n  @bind\n  public onRedoBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Redo,\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击 undo 按钮。\n   */\n  @bind\n  public onUndoBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Undo,\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击全选按钮。\n   */\n  @bind\n  public onSelectAllBtnClick() {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    reportElsDispatch({\n      type: ReportElsActionType.Select,\n      payload: reportElsState.map(reportEl => reportEl.id),\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击删除按钮。\n   */\n  @bind\n  public onDeleteSelectedBtnClick() {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    reportElsDispatch({\n      type: ReportElsActionType.Delete,\n      payload: reportElsState\n        .filter(reportEl => reportEl.selected)\n        .map(reportElToDelete => reportElToDelete.id),\n    });\n  }\n\n  /**\n   * 点击添加文本按钮。\n   */\n  @bind\n  public onAddTextBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [\n        {\n          // TODO: 此处 id 生成方法待更改。\n          id: `_${Math.random()\n            .toString(36)\n            .substr(2, 9)}${Math.random()\n            .toString(36)\n            .substr(2, 9)}`,\n          type: ReportElType.Text,\n          width: 400,\n          height: 160,\n          x: 600,\n          y: 200,\n          text: '',\n          selected: true,\n          editing: true,\n        },\n      ],\n    });\n  }\n\n  /**\n   * 点击 chart 列表项添加 chart。\n   */\n  @bind\n  public onChartListItemClick(chartType: ReportChartType) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [\n        {\n          // TODO: 此处 id 生成方法待更改。\n          id: `_${Math.random()\n            .toString(36)\n            .substr(2, 9)}${Math.random()\n            .toString(36)\n            .substr(2, 9)}`,\n          type: ReportElType.Chart,\n          chartType,\n          width: 400,\n          height: 300,\n          x: 600,\n          y: 200,\n          dataSource: {\n            id: '',\n            data: [],\n          },\n          selected: true,\n          editing: true,\n          options: {},\n        },\n      ],\n    });\n  }\n\n  /** Report Editor */\n  /**\n   * 点击 canvas container 未移动 unselect 所有元素，点击 report elements 不触发:\n   *  - onCanvasContainerMouseDown\n   *  - unselectAllReportEls\n   *  - preventUnselectAllReportEls\n   */\n  // prettier-ignore\n  @bind\n  public onCanvasContainerMouseDown(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    this._canvasContainer.mouseDownPosition = { x: event.clientX, y: event.clientY };\n  }\n\n  // prettier-ignore\n  @bind\n  public onCanvasContainerMouseUp(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    const { x, y } = this._canvasContainer.mouseDownPosition;\n    const { clientX, clientY } = event;\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    x === clientX && y === clientY && reportElsDispatch({\n      type: ReportElsActionType.Unselect,\n      payload: reportElsState.map(reportEl => reportEl.id),\n      disallowUndo: true,\n    });\n  }\n\n  /** Report Element */\n  // prettier-ignore\n  public onReportElMouseUp(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    event.stopPropagation();\n  }\n\n  /**  鼠标按下选中 report elment。 */\n  // prettier-ignore\n  @bind\n  public onReportElMouseDown(reportElId: string, unselectOthers: boolean) {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    if (unselectOthers) {\n      reportElsDispatch({\n        type: ReportElsActionType.Unselect,\n        payload: reportElsState.map(reportEl => reportEl.id),\n        disallowUndo: true,\n      });\n    }\n\n    reportElsDispatch({\n      type: ReportElsActionType.StartEdit,\n      payload: reportElId,\n      disallowUndo: true,\n    });\n  }\n\n  /**  修复 bizcharts 的 canvas 的 cursor 总是为 default 的 bug：鼠标悬浮在 report elements 上时设置 cursor。 */\n  public onReportElMouseMove(\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n  ) {\n    const canvas: HTMLCanvasElement | null = document.querySelector(\n      `#${event.currentTarget.id} canvas`,\n    );\n    const html = document.querySelector('html');\n    if (canvas && html) {\n      canvas.style.cursor = html.style.cursor || 'auto';\n    }\n  }\n\n  /** Report Editor */\n  /** 设置图表的数据源 */\n  @bind\n  public onChartDataSourceSelect(\n    id: string,\n    dataSource: ReportChartDataSource,\n  ) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.SetChartDataSource,\n      payload: { id, dataSource },\n    });\n  }\n\n  /** 设置图表的选项 */\n  @bind\n  public onChartOptionsChange(id: string, options: ReportChartOptions) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.SetChartOptions,\n      payload: { id, options },\n    });\n  }\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M524.8 362.66666667c-110.933333 0-209.066667 42.666667-285.866667 110.933333L85.333333 319.99999967v384h375.466667l-149.333333-153.6c59.733333-51.2 132.266667-81.066667 213.333333-81.066666 149.333333 0 273.066667 98.133333 315.733333 234.666666l98.133334-34.133333C878.933333 490.66666667 716.8 362.66666667 524.8 362.66666667z\",\n  pId: 1119\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551597541207,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 1118,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/undo.da78c3f7.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M786.005333 473.34400033l152.021333-153.984 0 384-384 0 155.989333-153.984q-96-80-219.989333-80-112 0-201.002667 64.981333t-123.008 169.002667l-100.010667-32q43.989333-136.021333 160.981333-221.994667t262.997333-86.016q169.984 0 296.021333 109.994667z\",\n  pId: 1349\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551597561334,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 1348,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/redo.f03087f9.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M866.7136 792.6784H227.566933l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934h-47.445333a18.670933 18.670933 0 0 0-18.944 18.6368l-0.2048 628.053334v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H866.7136a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z\",\n  pId: 9310\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M724.48 934.912H85.367467l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934H19.182933a18.670933 18.670933 0 0 0-18.944 18.6368L0 977.578667v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H724.48a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z\",\n  pId: 9311\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1005.704533 3.754667H302.728533a18.397867 18.397867 0 0 0-18.295466 18.295466v703.010134c0 9.966933 8.192 18.295467 18.295466 18.295466h703.010134c9.966933 0 18.295467-8.192 18.295466-18.295466V22.016a18.432 18.432 0 0 0-18.3296-18.261333zM938.666667 657.988267H369.7664V89.088H938.666667v568.900267z\",\n  pId: 9312\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M570.0608 505.002667l16.4864 16.4864c7.543467 7.543467 19.490133 7.850667 27.3408 0l16.4864-16.4864 236.885333-236.885334a18.6368 18.6368 0 0 0 0.068267-26.862933l-33.553067-33.553067a19.114667 19.114667 0 0 0-26.862933 0.068267l-206.711467 206.711467-72.977066-72.977067a18.568533 18.568533 0 0 0-26.760534 0.034133l-33.553066 33.553067a19.182933 19.182933 0 0 0-0.034134 26.760533l103.185067 103.150934z\",\n  pId: 9313\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551599533521,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 9309,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2, _ref3, _ref4, _ref5);\n};\n\nexport default __webpack_public_path__ + \"static/media/select-all.0788b671.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M843.294118 120.470588l0 180.705882-60.235294 0 0-120.470588-240.941176 0 0 722.823529 98.966588 0 0 60.235294-258.168471 0 0-60.235294 98.966588 0 0-722.823529-240.941176 0 0 120.470588-60.235294 0 0-180.705882 662.588235 0z\",\n  pId: 9078\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551599120489,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 9077,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/text.596f1788.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport { Layout, Tooltip, Icon, Button, Divider, Menu, Dropdown } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { ReactComponent as UndoSvg } from '$assets/icons/undo.svg';\nimport { ReactComponent as RedoSvg } from '$assets/icons/redo.svg';\nimport { ReactComponent as SelectAllSvg } from '$assets/icons/select-all.svg';\nimport { ReactComponent as TextSvg } from '$assets/icons/text.svg';\n\nimport { ReportChartType } from '../ReportElement';\n\nimport './index.less';\n\ninterface ToolbarProps {\n  disableUndo: boolean;\n  disableRedo: boolean;\n  disableDelete: boolean;\n  onUndoBtnClick(event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void;\n  onRedoBtnClick(event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void;\n  onSelectAllBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n  onChartListItemClick(chartType: ReportChartType): void;\n  onAddTextBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n  onDeleteSelectedBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n}\n\nconst { Header } = Layout;\n\nexport default React.memo(function Toolbar(props: ToolbarProps) {\n  const {\n    disableUndo,\n    disableRedo,\n    disableDelete,\n    onUndoBtnClick,\n    onRedoBtnClick,\n    onSelectAllBtnClick,\n    onChartListItemClick,\n    onAddTextBtnClick,\n    onDeleteSelectedBtnClick,\n  } = props;\n  const { locale } = React.useContext(LocaleContext);\n\n  const reportChartTypeItems = [\n    {\n      key: ReportChartType.LineChart,\n      value: locale.user.report.lineChart,\n    },\n    {\n      key: ReportChartType.BarChart,\n      value: locale.user.report.barChart,\n    },\n    {\n      key: ReportChartType.PieChart,\n      value: locale.user.report.pieChart,\n    },\n    {\n      key: ReportChartType.ScatterChart,\n      value: locale.user.report.scatterChart,\n    },\n  ];\n  const addChartTypeMenu = (\n    <Menu>\n      {reportChartTypeItems.map(reportChartTypeItem => (\n        <Menu.Item\n          key={reportChartTypeItem.key}\n          onClick={React.useCallback(\n            () => onChartListItemClick(reportChartTypeItem.key),\n            [reportChartTypeItem.key],\n          )}\n        >\n          {reportChartTypeItem.value}\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n\n  return (\n    <Header className=\"toolbar\">\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.undo} placement=\"bottom\">\n          <Button disabled={disableUndo} onClick={onUndoBtnClick}>\n            <Icon component={UndoSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.redo} placement=\"bottom\">\n          <Button disabled={disableRedo} onClick={onRedoBtnClick}>\n            <Icon component={RedoSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.selectAll} placement=\"bottom\">\n          <Button onClick={onSelectAllBtnClick}>\n            <Icon component={SelectAllSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Dropdown overlay={addChartTypeMenu} trigger={['click']}>\n          <Button>\n            <Icon type=\"bar-chart\" /> {locale.user.report.chart}{' '}\n            <Icon type=\"down\" />\n          </Button>\n        </Dropdown>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.text} placement=\"bottom\">\n          <Button onClick={onAddTextBtnClick}>\n            <Icon component={TextSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.deleteSelected} placement=\"bottom\">\n          <Button\n            type=\"danger\"\n            disabled={disableDelete}\n            onClick={onDeleteSelectedBtnClick}\n          >\n            <Icon type=\"delete\" />\n          </Button>\n        </Tooltip>\n      </div>\n    </Header>\n  );\n});\n","import * as React from 'react';\nimport { Layout, Select, Switch, Icon } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport {\n  ReportEl,\n  ReportChartType,\n  ReportElType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from '../ReportElement';\n\nimport './index.less';\n\nconst { Sider } = Layout;\n\ninterface ConfigPanelProps {\n  editingReportEl: ReportEl | null;\n  dataSources: {\n    rows: {\n      id: string;\n      name: string;\n      data: any[];\n    }[];\n    count: number;\n  };\n  onChartDataSourceSelect(id: string, dataSource: ReportChartDataSource): void;\n  onChartOptionsChange(id: string, options: ReportChartOptions): void;\n}\n\nexport default React.memo(function ConfigPanel(props: ConfigPanelProps) {\n  const {\n    editingReportEl,\n    dataSources,\n    onChartDataSourceSelect,\n    onChartOptionsChange,\n  } = props;\n  const { locale } = React.useContext(LocaleContext);\n\n  if (!editingReportEl) return <Sider className=\"config-panel\" />;\n\n  let title = locale.user.report[editingReportEl.type];\n\n  if (\n    editingReportEl.type === ReportElType.Chart &&\n    editingReportEl.chartType\n  ) {\n    title += ` > ${locale.user.report[editingReportEl.chartType]}`;\n  }\n\n  return (\n    <Sider className=\"config-panel\">\n      <div className=\"title\">{title}</div>\n      {(() => {\n        const pannelItems = [];\n\n        switch (editingReportEl.type) {\n          case ReportElType.Text:\n            break;\n          case ReportElType.Chart:\n            if (editingReportEl.dataSource) {\n              pannelItems.push(\n                <div key=\"data-source\" className=\"config-item\">\n                  <div>{locale.user.home.dataSources.title}</div>\n                  <Select\n                    value={editingReportEl.dataSource.id}\n                    style={{ width: '160px' }}\n                    // onSelect 用 useCallBack 添加 report element 会报错。\n                    onSelect={dataSourceId => {\n                      for (const dataSource of dataSources.rows) {\n                        if (dataSource.id === dataSourceId) {\n                          const { id, data } = dataSource;\n                          onChartDataSourceSelect(editingReportEl.id, {\n                            id,\n                            data,\n                          });\n                        }\n                      }\n                    }}\n                  >\n                    {dataSources.rows.map(dataSource => (\n                      <Select.Option key={dataSource.id} value={dataSource.id}>\n                        {dataSource.name}\n                      </Select.Option>\n                    ))}\n                  </Select>\n                </div>,\n              );\n            }\n\n            if (\n              editingReportEl.type === ReportElType.Chart &&\n              editingReportEl.chartType === ReportChartType.LineChart\n            ) {\n              pannelItems.push(\n                <div key=\"is-x-axis-time\" className=\"config-item\">\n                  <div>{locale.user.report.isXAxisTime}</div>\n                  <Switch\n                    checked={(editingReportEl.options as any).isXAxisTime}\n                    checkedChildren={<Icon type=\"check\" />}\n                    unCheckedChildren={<Icon type=\"close\" />}\n                    onClick={React.useCallback(\n                      isXAxisTime => {\n                        const { id, options } = editingReportEl;\n                        onChartOptionsChange(id, { ...options, isXAxisTime });\n                      },\n                      [editingReportEl],\n                    )}\n                  />\n                </div>,\n                <div key=\"is-line-smooth\" className=\"config-item\">\n                  <div>{locale.user.report.isLineSmooth}</div>\n                  <Switch\n                    checked={(editingReportEl.options as any).isLineSmooth}\n                    checkedChildren={<Icon type=\"check\" />}\n                    unCheckedChildren={<Icon type=\"close\" />}\n                    onClick={React.useCallback(\n                      isLineSmooth => {\n                        const { id, options } = editingReportEl;\n                        onChartOptionsChange(id, { ...options, isLineSmooth });\n                      },\n                      [editingReportEl],\n                    )}\n                  />\n                </div>,\n              );\n            }\n            break;\n          default:\n            break;\n        }\n\n        return pannelItems;\n      })()}\n    </Sider>\n  );\n});\n","import * as React from 'react';\nimport { Layout } from 'antd';\n\nimport customMetaKey from '$utils/customMetaKEey';\n\nimport {\n  GController,\n  InteractController,\n  KeyboardController,\n  MouseController,\n} from './controllers';\n\nimport ReportElement, { ReportEl, ReportElType } from './widgets/ReportElement';\nimport reportElsReducer, {\n  ReportElsActionType,\n} from './widgets/ReportElement/reducer';\nimport Toolbar from './widgets/Toolbar';\nimport ConfigPanel from './widgets/ConfigPanel';\n\nimport './index.less';\n\nconst { Content } = Layout;\n\ninterface ReportEditorProps {\n  initialEls: ReportEl[];\n  dataSources: {\n    rows: {\n      id: string;\n      name: string;\n      data: any[];\n    }[];\n    count: number;\n  };\n  onSave(reportELs: ReportEl[]): void;\n}\n\nfunction ReportEditor(props: ReportEditorProps) {\n  const { initialEls, dataSources, onSave } = props;\n  const reportCanvasRef = React.useRef<HTMLDivElement>(null);\n  const [reportEls, reportElsDispatch] = React.useReducer(\n    reportElsReducer,\n    {\n      undoStack: [],\n      redoStack: [],\n      state: [],\n    },\n    {\n      type: ReportElsActionType.Add,\n      payload: initialEls,\n      disallowUndo: true,\n    },\n  );\n  const controller = React.useMemo(\n    () => ({\n      g: new GController(),\n      interact: new InteractController({ reportElsDispatch }),\n      keyboard: new KeyboardController({\n        reportElsState: reportEls.state,\n        reportElsDispatch,\n        onSave,\n      }),\n      mouse: new MouseController({\n        reportElsState: reportEls.state,\n        reportElsDispatch,\n      }),\n    }),\n    [],\n  );\n  const editingReportEl = React.useMemo(() => {\n    for (const reportEl of reportEls.state) {\n      if (reportEl.editing) {\n        return reportEl;\n      }\n    }\n\n    return null;\n  }, [reportEls.state]);\n\n  React.useEffect(() => {\n    controller.keyboard.update({ reportElsState: reportEls.state });\n    controller.mouse.update({ reportElsState: reportEls.state });\n  }, [reportEls.state]);\n\n  React.useEffect(() => {\n    reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [],\n      disallowUndo: true,\n    });\n    controller.g.init();\n\n    return () => {\n      controller.g.destroy();\n      controller.interact.destroy();\n      controller.keyboard.destroy();\n      controller.mouse.destroy();\n    };\n  }, []);\n\n  return (\n    <Layout className=\"report-editor\">\n      <Toolbar\n        disableUndo={reportEls.undoStack.length === 0}\n        disableRedo={reportEls.redoStack.length === 0}\n        disableDelete={\n          reportEls.state.filter(reportEl => reportEl.selected).length === 0\n        }\n        onUndoBtnClick={controller.mouse.onUndoBtnClick}\n        onRedoBtnClick={controller.mouse.onRedoBtnClick}\n        onSelectAllBtnClick={controller.mouse.onSelectAllBtnClick}\n        onChartListItemClick={controller.mouse.onChartListItemClick}\n        onAddTextBtnClick={controller.mouse.onAddTextBtnClick}\n        onDeleteSelectedBtnClick={controller.mouse.onDeleteSelectedBtnClick}\n      />\n      <Layout>\n        <Content\n          className=\"report-canvas-container\"\n          onMouseDown={controller.mouse.onCanvasContainerMouseDown}\n          onMouseUp={controller.mouse.onCanvasContainerMouseUp}\n        >\n          <div ref={reportCanvasRef} id=\"report-canvas\" />\n          {reportEls.state.map(reportEl => (\n            <ReportElement\n              key={reportEl.id}\n              {...reportEl}\n              onMouseMove={\n                reportEl.type === ReportElType.Chart\n                  ? controller.mouse.onReportElMouseMove\n                  : undefined\n              }\n              // onMouseDown 用 useCallBack 按删除会报错。\n              onMouseDown={(\n                event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n              ) =>\n                controller.mouse.onReportElMouseDown(\n                  reportEl.id,\n                  !customMetaKey({\n                    ctrlKey: event.ctrlKey,\n                    metaKey: event.metaKey,\n                  }),\n                )\n              }\n              onMouseUp={controller.mouse.onReportElMouseUp}\n              // onInputText 用 useCallBack 按删除会报错。\n              onInputText={\n                reportEl.type === ReportElType.Text\n                  ? (event: any) =>\n                      controller.keyboard._onInputText(\n                        reportEl.id,\n                        event.target.value,\n                      )\n                  : undefined\n              }\n            />\n          ))}\n        </Content>\n        <ConfigPanel\n          editingReportEl={editingReportEl}\n          dataSources={dataSources}\n          onChartDataSourceSelect={controller.mouse.onChartDataSourceSelect}\n          onChartOptionsChange={controller.mouse.onChartOptionsChange}\n        />\n      </Layout>\n    </Layout>\n  );\n}\n\nexport default React.memo(ReportEditor);\n","import * as React from 'react';\nimport { Link } from '@reach/router';\nimport { compose, graphql, Mutation, MutationFn } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Layout, Icon } from 'antd';\nimport moment from 'moment';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport Loading from '$components/Loading';\nimport Error from '$components/Error';\nimport TextEditor from '$components/TextEditor';\nimport ReportEditor from '$components/ReportEditor';\nimport { ReportElType } from '$components/ReportEditor/widgets/ReportElement';\n\nimport './index.less';\n\nconst { Header } = Layout;\n\ninterface ReportProps {\n  getReport: any;\n  getDataSources: any;\n  saveReport: MutationFn<any, any>;\n}\n\nconst GET_REPORT = gql`\n  query getReport($id: ID!) {\n    getReport(id: $id) {\n      id\n      updatedAt\n      name\n      elements\n    }\n  }\n`;\n\nconst GET_DATASOURCES = gql`\n  query {\n    getDataSources {\n      rows {\n        id\n        name\n        data\n      }\n      count\n    }\n  }\n`;\n\nconst RENAME_REPORT = gql`\n  mutation renameReport($id: ID!, $name: String!) {\n    renameReport(id: $id, name: $name)\n  }\n`;\n\nconst SAVE_REPORT_ELS = gql`\n  mutation saveReportEls($id: ID!, $elements: String!) {\n    saveReportEls(id: $id, elements: $elements)\n  }\n`;\n\nfunction Report(props: ReportProps) {\n  const { getReport, getDataSources, saveReport } = props;\n  const loading = getReport.loading || getDataSources.loading;\n  const error = getReport.error || getDataSources.error;\n\n  if (loading) return <Loading />;\n\n  if (error) return <Error />;\n\n  if (!getReport || !getDataSources || !saveReport) return null;\n\n  const { locale } = React.useContext(LocaleContext);\n  const [report, setReport] = React.useState(getReport.getReport);\n\n  return (\n    <Layout className=\"page-container\">\n      <Header className=\"report-header\">\n        <Link to={AbsoluteRoute.User.Home.Reports}>\n          <Icon type=\"left\" />\n        </Link>\n        <div className=\"report-info\">\n          <Mutation\n            mutation={RENAME_REPORT}\n            variables={{ id: report.id, name: report.name }}\n          >\n            {renameReport => {\n              return (\n                <TextEditor\n                  className=\"title\"\n                  placeholder={locale.user.home.reports.unnamedReport}\n                  text={report.name}\n                  onKeyDown={event => {\n                    if (event.keyCode === 13) {\n                      event.preventDefault();\n                      (event.target as any).blur();\n                    }\n                  }}\n                  onChange={event =>\n                    setReport({ ...report, name: event.target.value })\n                  }\n                  onBlur={e => renameReport()}\n                />\n              );\n            }}\n          </Mutation>\n          <span className=\"detail\">\n            {locale.common.updatedAt}: {moment(report.updatedAt).format('lll')}\n          </span>\n        </div>\n      </Header>\n      <ReportEditor\n        initialEls={report.elements}\n        dataSources={getDataSources.getDataSources}\n        onSave={reportEls => {\n          saveReport({\n            variables: {\n              id: report.id,\n              elements: JSON.stringify(\n                reportEls.map(reportEl =>\n                  reportEl.type === ReportElType.Chart\n                    ? {\n                        ...reportEl,\n                        dataSource: {\n                          ...reportEl.dataSource,\n                          data: reportEl.dataSource.data.origin,\n                        },\n                      }\n                    : reportEl,\n                ),\n              ),\n            },\n          });\n          console.log(\n            reportEls.map(reportEl =>\n              reportEl.type === ReportElType.Chart\n                ? {\n                    ...reportEl,\n                    dataSource: {\n                      ...reportEl.dataSource,\n                      data: reportEl.dataSource.data.origin,\n                    },\n                  }\n                : reportEl,\n            ),\n          );\n        }}\n      />\n    </Layout>\n  );\n}\n\n// 后续打算用回 restful 重写该项目，下方的类型定义随便写了。\nexport default React.memo(\n  compose(\n    graphql<any, any, any, any>(GET_REPORT, {\n      options: props => ({ variables: { id: props.reportId! } }),\n      props: ({ data }) => {\n        if (!data) return { data };\n\n        const getReport = data.getReport\n          ? {\n              getReport: {\n                ...data.getReport,\n                elements: JSON.parse(data.getReport.elements),\n              },\n            }\n          : {};\n\n        return {\n          getReport: {\n            ...data,\n            ...getReport,\n          },\n        };\n      },\n    }),\n    graphql<any, any, any, any>(GET_DATASOURCES, {\n      props: ({ data }) => {\n        if (!data) return { data };\n\n        const getDataSources = data.getDataSources\n          ? {\n              getDataSources: {\n                ...data.getDataSources,\n                rows: data.getDataSources.rows.map((dataSource: any) => ({\n                  ...dataSource,\n                  data: JSON.parse(dataSource.data),\n                })),\n              },\n            }\n          : {};\n\n        return {\n          getDataSources: {\n            ...data,\n            ...getDataSources,\n          },\n        };\n      },\n    }),\n    graphql<any, any, any, any>(SAVE_REPORT_ELS, {\n      props: ({ mutate }) => ({\n        saveReport: mutate,\n      }),\n    }),\n  )(Report),\n);\n","import * as React from 'react';\n\ninterface DoActionOnMountProps {\n  doAction(): any;\n}\n\nexport default React.memo(function DoActionOnMount(\n  props: DoActionOnMountProps,\n) {\n  React.useEffect(() => {\n    props.doAction();\n  }, []);\n\n  return null;\n});\n","import * as React from 'react';\nimport { Router } from '@reach/router';\nimport gql from 'graphql-tag';\nimport { Mutation } from 'react-apollo';\n\nimport { UserContext } from '$contexts/User';\n\nimport Home from '$routes/User/Home';\nimport Reports from '$routes/User/Home/Reports';\nimport DataSources from '$routes/User/Home/DataSources';\nimport Report from '$routes/User/Report';\n\nimport DoActionOnMount from '$components/DoActionOnMount';\nimport Loading from '$components/Loading';\n\nconst SignIn = React.lazy(async() => import('$routes/SignIn'));\nconst User = React.lazy(async() => import('$routes/User'));\nconst NotFound = React.lazy(async() => import('$routes/NotFound'));\n\nexport const AbsoluteRoute = {\n  SignIn: '/smart',\n  User: {\n    Path: '/smart',\n    Home: {\n      Path: '/smart',\n      Reports: '/smart',\n      DataSources: '/smart/data-sources',\n    },\n    Report: '/smart/report/:reportId',\n  },\n};\n\nconst SIGN_IN_BY_TOKEN = gql`\n  mutation signInByToken($id: ID!, $token: String!) {\n    signInByToken(id: $id, token: $token) {\n      id\n      username\n      token\n    }\n  }\n`;\n\nexport default React.memo(function Routes(props) {\n  const {\n    user: { id, username, token, hasSignedIn },\n    setUser,\n  } = React.useContext(UserContext);\n  const onSignInByTokenCompleted = React.useCallback(({ signInByToken }) => {\n    const { id, username, token } = signInByToken;\n    setUser({ id, username, token, hasSignedIn: true });\n  }, []);\n\n  return (\n    <React.Suspense fallback={<Loading />}>\n      <Mutation\n        mutation={SIGN_IN_BY_TOKEN}\n        variables={{\n          id,\n          token,\n        }}\n        onCompleted={onSignInByTokenCompleted}\n      >\n        {(signInByToken, { loading, error }) => {\n          if (!id || !username || !token) {\n            return (\n              <Router className=\"Routes\">\n                <SignIn path=\"/smart\" />\n                <NotFound default />\n              </Router>\n            );\n          }\n\n          if (!hasSignedIn) {\n            return <DoActionOnMount doAction={signInByToken} />;\n          }\n\n          if (loading) return <Loading />;\n\n          if (error) {\n            return (\n              <Router className=\"Routes\">\n                <SignIn path=\"/smart\" />\n                <NotFound default />\n              </Router>\n            );\n          }\n\n          return (\n            <Router className=\"Routes\">\n              <User path=\"/smart\">\n                <Home path=\"/\">\n                  <Reports path=\"/\" />\n                  <DataSources path=\"data-sources\" />\n                  <NotFound default />\n                </Home>\n                <Report path=\"report/:reportId\" />\n                <NotFound default />\n              </User>\n              <NotFound default />\n            </Router>\n          );\n        }}\n      </Mutation>\n    </React.Suspense>\n  );\n});\n","import * as React from 'react';\nimport { LocaleProvider as AntdLocaleProvider } from 'antd';\nimport antd_en_US from 'antd/lib/locale-provider/en_US';\nimport antd_zh_CN from 'antd/lib/locale-provider/zh_CN';\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nimport { Locale, locales } from '$assets/locales';\n\nexport const LocaleContext = React.createContext<{\n  locale: Locale;\n  setLocale: React.Dispatch<React.SetStateAction<Locale>>;\n}>({\n  locale:\n    locales[window.localStorage.getItem('locale') || 'en_US'] || locales.en_US,\n  // tslint:disable-next-line\n  setLocale: () => {},\n});\n\nconst otherLocaleMap = {\n  [locales.en_US.locale.key]: {\n    antd: antd_en_US,\n    moment: 'en',\n  },\n  [locales.zh_CN.locale.key]: {\n    antd: antd_zh_CN,\n    moment: 'zh-cn',\n  },\n};\n\ninterface LocaleProviderProps {\n  children: React.ReactNode;\n}\n\nexport const LocaleProvider = React.memo(function LocaleProvider(\n  props: LocaleProviderProps,\n) {\n  const [locale, setLocale] = React.useState(\n    locales[window.localStorage.getItem('locale') || 'en_US'] || locales.en_US,\n  );\n  const [antdLocale, setAntdLocale] = React.useState(antd_en_US);\n  const LocaleContextValue = React.useMemo(() => ({ locale, setLocale }), [\n    locale,\n  ]);\n\n  React.useEffect(() => {\n    const otherLocale = otherLocaleMap[locale.locale.key];\n\n    setAntdLocale(otherLocale.antd as any);\n    moment.locale(otherLocale.moment);\n\n    window.localStorage.setItem('locale', locale.locale.key);\n  }, [locale]);\n\n  return (\n    <LocaleContext.Provider value={LocaleContextValue}>\n      <AntdLocaleProvider locale={antdLocale}>\n        {props.children}\n      </AntdLocaleProvider>\n    </LocaleContext.Provider>\n  );\n});\n","module.exports = \"data:image/png;base64,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\"","import en_US from './en_US';\nimport zh_CN from './zh_CN';\n\nexport interface Locale {\n  locale: {\n    key: string;\n    value: string;\n  };\n  common: {\n    loading: string;\n    createdAt: string;\n    updatedAt: string;\n  };\n  signIn: {\n    signIn: string;\n    signUp: string;\n    username: string;\n    password: string;\n    usernameLimit: string;\n    passwordLimit: string;\n  };\n  user: {\n    signOut: string;\n    home: {\n      title: string;\n      reports: {\n        title: string;\n        addReport: string;\n        unnamedReport: string;\n      };\n      dataSources: {\n        title: string;\n        addDataSource: string;\n      };\n    };\n    report: {\n      redo: string;\n      undo: string;\n      selectAll: string;\n      unselectAll: string;\n      deleteSelected: string;\n      chart: string;\n      text: string;\n      lineChart: string;\n      barChart: string;\n      pieChart: string;\n      scatterChart: string;\n      textEmptyTips: string;\n      isXAxisTime: string;\n      isLineSmooth: string;\n    };\n  };\n  error: {\n    unauthorized: string;\n    existingUsername: string;\n    nonexistentUsernameOrWrongPassword: string;\n    reportNotFound: string;\n    dataSourceNotFound: string;\n    networkError: string;\n    fileContentError: string;\n  };\n  notFound: string;\n}\n\ninterface Locales {\n  [key: string]: Locale;\n}\n\nexport const locales: Locales = {\n  en_US,\n  zh_CN,\n};\n","export default {\n  locale: {\n    key: 'en_US',\n    value: 'English',\n  },\n  common: {\n    loading: 'Loading...',\n    createdAt: 'Created at',\n    updatedAt: 'Updated at',\n  },\n  signIn: {\n    signIn: 'Sign In',\n    signUp: 'Sign Up',\n    username: 'username',\n    password: 'password',\n    usernameLimit:\n      'The username should be 3 to 15 in length and consists of letters or numbers.',\n    passwordLimit:\n      'The password should be 6 to 15 in length and at least have one lowercase letter, uppercase letters as well as numbers.',\n  },\n  user: {\n    signOut: 'Sign Out',\n    home: {\n      title: 'home',\n      reports: {\n        title: 'Reports',\n        addReport: 'Add a report',\n        unnamedReport: 'Unnamed report',\n      },\n      dataSources: {\n        title: 'Data sources',\n        addDataSource: 'Add a data source',\n      },\n    },\n    report: {\n      redo: 'Redo',\n      undo: 'Undo',\n      selectAll: 'Select all',\n      unselectAll: 'Unselect all',\n      deleteSelected: 'Delete selected',\n      chart: 'Chart',\n      text: 'Text',\n      lineChart: 'Line chart',\n      pieChart: 'Pie chart',\n      barChart: 'Bar chart',\n      scatterChart: 'Scatter chart',\n      textEmptyTips: 'Please enter text.',\n      isXAxisTime: 'Is x axis time?',\n      isLineSmooth: 'Is line smooth?',\n    },\n  },\n  error: {\n    unauthorized: 'Unauthorized.',\n    existingUsername: 'Existing Username.',\n    nonexistentUsernameOrWrongPassword:\n      'Noexistent username or wrong password.',\n    reportNotFound: 'Report not found.',\n    dataSourceNotFound: 'Data source not found.',\n    networkError: 'Network Error.',\n    fileContentError: 'File Content Error.',\n  },\n  notFound: 'Not Found!',\n};\n","export default {\n  locale: {\n    key: 'zh_CN',\n    value: '简体中文',\n  },\n  common: {\n    loading: '加载中...',\n    createdAt: '创建于',\n    updatedAt: '更新于',\n    uploadData: '上传数据',\n  },\n  signIn: {\n    signIn: '登录',\n    signUp: '注册',\n    username: '用户名',\n    password: '密码',\n    usernameLimit: '用户名长度为 3 ～ 15，由字母或数字组成。',\n    passwordLimit:\n      '密码长度为 6 ～ 15，且至少有一个小写字母、大写字母以及数字。',\n  },\n  user: {\n    signOut: '登出',\n    home: {\n      title: '首页',\n      reports: {\n        title: '报告',\n        addReport: '新建报告',\n        unnamedReport: '未命名报告',\n      },\n      dataSources: {\n        title: '数据源',\n        addDataSource: '新建数据源',\n      },\n    },\n    report: {\n      redo: '重做',\n      undo: '撤回',\n      selectAll: '全选',\n      unselectAll: '取消选择',\n      deleteSelected: '删除所选',\n      chart: '图表',\n      text: '文本',\n      lineChart: '折线图',\n      barChart: '柱状图',\n      pieChart: '饼状图',\n      scatterChart: '散点图',\n      textEmptyTips: '请输入文本',\n      isXAxisTime: '横轴是否为时间轴？',\n      isLineSmooth: '折线是否为曲线？',\n    },\n  },\n  error: {\n    unauthorized: '登录失效，请重新登录。',\n    existingUsername: '用户名已存在。',\n    nonexistentUsernameOrWrongPassword: '用户名不存在或密码错误。',\n    reportNotFound: '报告不存在。',\n    dataSourceNotFound: '数据源不存在。',\n    networkError: '网络错误。',\n    fileContentError: '文件内容错误。',\n  },\n  notFound: '该页面不存在。',\n};\n","import * as React from 'react';\nimport { navigate } from '@reach/router';\n\nimport { AbsoluteRoute } from '$routes/index';\n\ninterface User {\n  id: string;\n  username: string;\n  token: string;\n  hasSignedIn: boolean;\n}\n\nexport const UserContext = React.createContext<{\n  user: User;\n  setUser: React.Dispatch<React.SetStateAction<User>>;\n}>({\n  user: {\n    id: window.localStorage.getItem('id') || '',\n    username: window.localStorage.getItem('username') || '',\n    token: window.localStorage.getItem('token') || '',\n    hasSignedIn: false,\n  },\n  // tslint:disable-next-line\n  setUser: () => {},\n});\n\ninterface UserProviderProps {\n  children: React.ReactNode;\n}\n\nexport const UserProvider = React.memo(function UserProvider(\n  props: UserProviderProps,\n) {\n  const [user, setUser] = React.useState({\n    id: window.localStorage.getItem('id') || '',\n    username: window.localStorage.getItem('username') || '',\n    token: window.localStorage.getItem('token') || '',\n    hasSignedIn: false,\n  });\n  const UserContextValue = React.useMemo(() => ({ user, setUser }), [user]);\n\n  React.useEffect(() => {\n    const { id, username, token } = user;\n\n    if (!id || !username || !token) {\n      navigate(AbsoluteRoute.SignIn);\n      console.log('$', AbsoluteRoute.SignIn);\n    }\n\n    window.localStorage.setItem('id', id);\n    window.localStorage.setItem('username', username);\n    window.localStorage.setItem('token', token);\n  }, [user]);\n\n  return (\n    <UserContext.Provider value={UserContextValue}>\n      {props.children}\n    </UserContext.Provider>\n  );\n});\n","import * as React from 'react';\nimport Error from '$components/Error';\n\nimport './index.less';\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n}\n\n// prettier-ignore\nexport default class ErrorBoundary extends React.PureComponent<ErrorBoundaryProps, ErrorBoundaryState> {\n  public constructor(props: ErrorBoundaryProps) {\n    super(props);\n\n    this.state = { hasError: false };\n  }\n  public static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  public render() {\n    return this.state.hasError ? <Error /> : this.props.children;\n  }\n}\n","import * as React from 'react';\nimport ApolloClient from 'apollo-boost';\nimport { ApolloProvider } from 'react-apollo';\nimport { message } from 'antd';\n\nimport { UserContext } from '$contexts/User';\nimport { LocaleContext } from '$contexts/Locale';\n\ninterface ApolloProviderProps {\n  children: React.ReactNode;\n}\n\nexport default React.memo(function(props: ApolloProviderProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { user, setUser } = React.useContext(UserContext);\n  const client = React.useMemo(\n    () =>\n      new ApolloClient({\n        uri: 'http://localhost:4000',\n        headers: {\n          authorization: user.token,\n        },\n        onError: ({ graphQLErrors, networkError }) => {\n          if (graphQLErrors) {\n            graphQLErrors.map(({ message: errorMessage, extensions }) => {\n              if (!extensions) {\n                message.error(errorMessage);\n\n                return;\n              }\n\n              switch (extensions!.code) {\n                case 'UNAUTHORIZED':\n                  message.error(locale.error.unauthorized);\n                  setUser({\n                    id: '',\n                    username: '',\n                    token: '',\n                    hasSignedIn: false,\n                  });\n                  break;\n                case 'EXISTING_USERNAME':\n                  message.error(locale.error.existingUsername);\n                  break;\n                case 'NONEXISTENT_USERNAME_OR_WRONG_PASSWORD':\n                  message.error(\n                    locale.error.nonexistentUsernameOrWrongPassword,\n                  );\n                  break;\n                case 'REPORT_NOT_FOUND':\n                  message.error(locale.error.reportNotFound);\n                  break;\n                case 'DATA_SOURCE_NOT_FOUND':\n                  message.error(locale.error.dataSourceNotFound);\n                  break;\n                default:\n                  message.error(errorMessage);\n                  break;\n              }\n            });\n\n            if (networkError) message.error(locale.error.networkError);\n          }\n        },\n      }),\n    [user, locale],\n  );\n\n  return <ApolloProvider client={client}>{props.children}</ApolloProvider>;\n});\n","import * as React from 'react';\n\nimport { UserProvider } from '$contexts/User';\nimport { LocaleProvider } from '$contexts/Locale';\n\nimport Routes from '$routes/index';\n\nimport ErrorBoundary from '$components/ErrorBoundary';\nimport ApolloProvider from '$components/ApolloProvider';\n\nimport './App.less';\n\nexport default React.memo(function App() {\n  return (\n    <UserProvider>\n      <LocaleProvider>\n        <ErrorBoundary>\n          <ApolloProvider>\n            <Routes />\n          </ApolloProvider>\n        </ErrorBoundary>\n      </LocaleProvider>\n    </UserProvider>\n  );\n});\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ninterface Config {\n  onSuccess?(registration: ServiceWorkerRegistration): void;\n  onUpdate?(registration: ServiceWorkerRegistration): void;\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href,\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport App from './App';\n\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.less';\n\nReactDOM.render(<App />, document.getElementById('root') as HTMLElement);\nserviceWorker.register();\n","import * as React from 'react';\n\nimport './index.less';\n\nexport default React.memo(function Error() {\n  return <span>Error :(</span>;\n});\n"],"sourceRoot":""}