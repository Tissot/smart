(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){"use strict";n.d(t,"a",function(){return y}),n.d(t,"b",function(){return v});n(439);var a,r=n(401),o=n(53),c=n(49),i=n(0),l=n(176),s=n.n(l),u=n(375),d=n.n(u),p=n(75),m=n.n(p),h=(n(442),n(45)),y=i.createContext({locale:h.a[window.localStorage.getItem("locale")||"en_US"]||h.a.en_US,setLocale:function(){}}),f=(a={},Object(c.a)(a,h.a.en_US.locale.key,{antd:s.a,moment:"en"}),Object(c.a)(a,h.a.zh_CN.locale.key,{antd:d.a,moment:"zh-cn"}),a),v=i.memo(function(e){var t=i.useState(h.a[window.localStorage.getItem("locale")||"en_US"]||h.a.en_US),n=Object(o.a)(t,2),a=n[0],c=n[1],l=i.useState(s.a),u=Object(o.a)(l,2),d=u[0],p=u[1],v=i.useMemo(function(){return{locale:a,setLocale:c}},[a]);return i.useEffect(function(){var e=f[a.locale.key];p(e.antd),m.a.locale(e.moment),window.localStorage.setItem("locale",a.locale.key)},[a]),i.createElement(y.Provider,{value:v},i.createElement(r.a,{locale:d},e.children))})},246:function(e,t,n){"use strict";var a=n(36),r=n(64),o=n.n(r),c=n(99),i=n(0),l=n.n(i),s=n(82),u=n(29),d=n.n(u),p=n(32),m=n(74),h=(n(198),n(131)),y=(n(199),n(247)),f=(n(84),n(24)),v=(n(85),n(7)),g=(n(200),n(83)),b=(n(103),n(33)),E=n(21),w=n(45),k=n(376),C=n.n(k),S=(n(450),b.a.Header),O=b.a.Sider,x=b.a.Content,D=i.memo(function(e){var t=i.useContext(m.a).setUser,n=i.useContext(E.a),a=n.locale,r=n.setLocale,o=i.useMemo(function(){return["".concat(e.uri).concat(e["*"])]},[e.uri,e["*"]]),c=i.useMemo(function(){return[{key:w.a.en_US.locale.key,value:w.a.en_US.locale.value},{key:w.a.zh_CN.locale.key,value:w.a.zh_CN.locale.value}]},[a]),l=i.useMemo(function(){return[{key:_t.User.Home.Reports,value:a.user.home.reports.title},{key:_t.User.Home.DataSources,value:a.user.home.dataSources.title}]},[a]),s=i.useMemo(function(){return i.createElement(g.a,null,c.map(function(e){return i.createElement(g.a.Item,{key:e.key,onClick:i.useCallback(function(){return r(w.a[e.key])},[e.key])},e.value)}))},[c]),u=i.useCallback(function(){t({id:"",username:"",token:"",hasSignedIn:!1})},[]),d=i.useCallback(function(t){var n=t.key;return e.navigate(n)},[]);return i.createElement(b.a,{className:"page-container"},i.createElement(S,{className:"user-header"},i.createElement("img",{src:C.a,alt:"logo",className:"logo"}),i.createElement("div",{className:"right-section"},i.createElement(y.a,{overlay:s,trigger:["click"]},i.createElement(f.a,{size:"small"},a.locale.value," ",i.createElement(v.a,{type:"down"}))),i.createElement(h.a,{type:"vertical"}),i.createElement(f.a,{size:"small",onClick:u},a.user.signOut))),i.createElement(b.a,null,i.createElement(O,{className:"user-sider"},i.createElement(g.a,{selectedKeys:o,onClick:d},l.map(function(e){return i.createElement(g.a.Item,{key:e.key},e.value)}))),i.createElement(x,{className:"user-content"},e.children)))}),j=(n(846),n(276)),A=n(75),M=n.n(A),N=(n(217),n(159)),I=(n(517),i.memo(function(e){var t=i.useContext(E.a).locale;return i.createElement(N.a,{tip:t.common.loading},e.children)})),R=n(97),U=(n(524),i.memo(function(e){var t=i.useContext(E.a).locale,n=e.responseKey,a=e.getListItems,r=e.handleListItemClick,o=e.removeListItem,c=e.itemIcon,l=e.itemNameFormatter,s=e.listHeader;return i.createElement(p.Query,{query:a},function(e){var a=e.data,u=e.loading,d=e.error,m=e.refetch;if(u)return i.createElement(I,null);if(d)return i.createElement(R.a,null);var h=a&&a[n]&&a[n].rows||[],y=s?"function"===typeof s?s(e):s:void 0,v=r?{cursor:"pointer"}:void 0;return i.createElement("div",{className:"custom-list"},i.createElement(j.a,{header:y,bordered:!0,dataSource:h,renderItem:function(e){return i.createElement(j.a.Item,{key:e.id,className:"list-item",style:v,onClick:r?function(t){return r(e.id)}:void 0},i.createElement("div",{className:"left-section"},c,i.createElement("div",{className:"list-item-info"},i.createElement("span",{className:"title"},l?l(e.name):e.name),i.createElement("div",{className:"detail"},i.createElement("span",null,t.common.createdAt,":"," ",M()(e.createdAt).format("lll")),i.createElement("span",null,t.common.updatedAt,":"," ",M()(e.updatedAt).format("lll"))))),o&&i.createElement(p.Mutation,{mutation:o,variables:{id:e.id},onCompleted:m},function(e,t){var n=t.loading;return i.createElement(f.a,{type:"danger",shape:"circle",icon:"delete",loading:n,onClick:function(t){t.stopPropagation(),e()}})}))}}))})}));function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var T=l.a.createElement("defs",null),B=l.a.createElement("path",{d:"M206.912 960l-128 0 0-149.376 128-102.976L206.912 960zM457.6 656 392.704 580.352 329.6 631.616 329.6 960l128 0L457.6 656zM708.224 605.632l-128 119.36L580.224 960l128 0L708.224 605.632zM958.912 379.968l-128 121.024L830.912 960l128 0L958.912 379.968zM942.912 256c11.328-13.568 9.472-33.728-4.032-45.056-13.568-11.264-33.664-9.472-45.056 4.032l-336 319.168L391.616 370.88 76.8 629.76c-14.144 10.624-17.024 30.656-6.464 44.736 10.688 14.144 30.656 17.024 44.8 6.528l274.304-224.64 169.408 167.68L942.912 256zM1009.344 323.328l0.064-177.024c-0.064-9.344-3.328-17.088-9.472-23.36-6.4-6.272-14.08-9.344-23.232-9.408l-177.152 0.064c-9.28-0.064-17.024 3.2-23.296 9.344C769.92 129.28 766.72 136.96 766.656 146.368c0.064 9.28 3.264 16.96 9.472 23.232l177.088 177.024c6.4 6.4 14.08 9.536 23.232 9.536 9.344-0.064 17.216-3.2 23.36-9.536C1006.08 340.352 1009.344 332.672 1009.344 323.328z",pId:2963});n.p;function L(){var e=Object(a.a)(["\n  mutation removeReport($id: ID!) {\n    removeReport(id: $id)\n  }\n"]);return L=function(){return e},e}function z(){var e=Object(a.a)(["\n  mutation {\n    addReport {\n      id\n    }\n  }\n"]);return z=function(){return e},e}function K(){var e=Object(a.a)(["\n  query {\n    getAllReports {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n"]);return K=function(){return e},e}var X=d()(K()),Q=d()(z()),F=d()(L()),H=i.createElement(v.a,{component:function(e){return l.a.createElement("svg",P({t:1551529198213,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:2962,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),T,B)},style:{fontSize:32,color:"#1890ff"}}),q=i.memo(function(e){var t=i.useContext(E.a).locale,n=e.navigate,a=i.useCallback(function(e){var a=e.refetch;return i.createElement(p.Mutation,{mutation:Q,onCompleted:function(){var e=Object(c.a)(o.a.mark(function e(t){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.addReport.id,e.next=3,a();case 3:n(_t.User.Report.replace(":reportId",r));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},function(e,n){var a=n.loading;return i.createElement(f.a,{type:"primary",icon:"plus",loading:a,onClick:e},t.user.home.reports.addReport)})},[t]),r=i.useCallback(function(t){return e.navigate(_t.User.Report.replace(":reportId",t))},[]),l=i.useCallback(function(e){return e||t.user.home.reports.unnamedReport},[t]);return i.createElement("div",null,i.createElement(U,{responseKey:"getAllReports",getListItems:X,removeListItem:F,itemIcon:H,listHeader:a,handleListItemClick:r,itemNameFormatter:l}))}),W=(n(847),n(399)),G=(n(227),n(56)),Z=n(135),J=n.n(Z);function V(){var e=Object(a.a)(["\n  mutation addDataSource($name: String!, $data: String!) {\n    addDataSource(name: $name, data: $data) {\n      id\n    }\n  }\n"]);return V=function(){return e},e}var Y=d()(V());var _=i.memo(Object(p.graphql)(Y,{options:function(e){return{onCompleted:e.onDataUploaded}},props:function(e){return{uploadData:e.mutate}}})(function(e){var t=i.useContext(E.a).locale,n=e.uploadData,a=i.useCallback(function(e){var a=new FileReader;return a.readAsText(e),a.onload=function(a){if(a.target){if("application/json"===e.type)try{var r=JSON.stringify(JSON.parse(a.target.result));n&&n({variables:{name:e.name,data:r}})}catch(c){G.a.error(t.error.fileContentError)}if("text/csv"===e.type){var o=(new Z.DataSet.View).source(a.target.result,{type:"csv"}).transform({type:"map",callback:function(e){var t={};for(var n in e){var a=Number(e[n]);Number.isNaN(a)?t[n]=e[n]:t[n]=a}return t}});n&&n({variables:{name:e.name,data:JSON.stringify(o.rows)}})}}},!1},[]);return i.createElement(W.a,{accept:".csv,.json",showUploadList:!1,beforeUpload:a},i.createElement(f.a,null,i.createElement(v.a,{type:"upload"}),t.user.home.dataSources.addDataSource))}));function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ee=l.a.createElement("defs",null),te=l.a.createElement("path",{d:"M512 42.666667C314.197333 42.666667 101.333333 102.314667 101.333333 233.344l0 557.312C101.333333 921.642667 314.197333 981.333333 512 981.333333c197.802667 0 410.666667-59.690667 410.666667-190.677333L922.666667 233.344C922.666667 102.314667 709.76 42.666667 512 42.666667zM864 790.656c0 72.874667-157.568 132.010667-352 132.010667-194.389333 0-352-59.136-352-132.010667l0-109.610667c60.629333 62.506667 206.762667 94.976 352 94.976 145.194667 0 291.370667-32.469333 352-94.976L864 790.656zM864 614.656l-0.128 0c0 0.256 0.128 0.682667 0.128 0.896 0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072 0-0.256 0.128-0.682667 0.128-0.896L160 614.656l0-109.610667c60.629333 62.421333 206.762667 94.933333 352 94.933333 145.194667 0 291.370667-32.512 352-94.933333L864 614.656zM864 438.656l-0.128 0 0.128 0.896c0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072l0.128-0.896L160 438.656 160 337.877333C236.885333 396.458667 377.770667 424.021333 512 424.021333c134.229333 0 275.114667-27.562667 352-86.101333L864 438.656zM512 365.312c-194.389333 0-352-59.136-352-132.010667 0-72.917333 157.610667-132.010667 352-132.010667 194.432 0 352 59.050667 352 132.010667C864 306.218667 706.432 365.312 512 365.312zM776.021333 776.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 821.589333 746.666667 805.333333 759.765333 776.021333 776.021333 776.021333zM776.021333 599.978667c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 645.589333 746.666667 629.333333 759.765333 599.978667 776.021333 599.978667zM776.021333 424.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 469.546667 746.666667 453.333333 759.765333 424.021333 776.021333 424.021333z",pId:2818});n.p;function ne(){var e=Object(a.a)(["\n  mutation removeDataSource($id: ID!) {\n    removeDataSource(id: $id)\n  }\n"]);return ne=function(){return e},e}function ae(){var e=Object(a.a)(["\n  query {\n    getDataSources {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n"]);return ae=function(){return e},e}var re=d()(ae()),oe=d()(ne()),ce=i.createElement(v.a,{component:function(e){return l.a.createElement("svg",$({t:1551529026004,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:2817,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),ee,te)},style:{fontSize:32,color:"#1890ff"}}),ie=function(e){var t=e.refetch;return i.createElement(_,{onDataUploaded:t})},le=i.memo(function(e){return i.createElement("div",null,i.createElement(U,{responseKey:"getDataSources",getListItems:re,removeListItem:oe,itemIcon:ce,listHeader:ie}))}),se=n(13),ue=n(53),de=n(388),pe=n.n(de);n(629);function me(e){e.preventDefault(),e.stopPropagation(),document.execCommand("insertHTML",!1,e.clipboardData.getData("text/plain"))}var he=i.memo(i.forwardRef(function(e,t){var n=e.disabled,a=e.placeholder,r=e.text,o=e.style,c=e.className,l=e.onKeyDown,s=e.onDoubleClick,u=e.onChange,d=e.onBlur;return i.createElement(pe.a,{innerRef:t,disabled:n||!1,placeholder:a,spellCheck:!1,html:r,style:o,className:"text-editor".concat(c?" ".concat(c):""),onKeyDown:i.useCallback(function(e){e.stopPropagation(),l&&l(e)},[l]),onClick:i.useCallback(function(e){return e.stopPropagation()},[]),onDoubleClick:i.useCallback(function(e){e.stopPropagation(),s&&s(e)},[s]),onChange:u,onPaste:me,onBlur:d})}));function ye(e){var t=e.ctrlKey,n=e.metaKey,a=window.navigator.platform;return a.includes("Win")&&t||a.includes("Mac")&&n}var fe=n(60),ve=n(61),ge=n(389),be=function(){function e(){Object(fe.a)(this,e),this._canvas=void 0,this._canvasContainerSelector=".report-canvas-container",this._canvasSelector="#report-canvas"}return Object(ve.a)(e,[{key:"init",value:function(){var e=document.querySelector(this._canvasContainerSelector),t=document.querySelector(this._canvasSelector),n=e.clientWidth,a=e.clientHeight,r=t.id;this._canvas=new ge.Canvas({containerId:r,width:n,height:a})}},{key:"destroy",value:function(){this._canvas.destroy()}}]),e}(),Ee=n(27),we=n(274),ke=n.n(we);function Ce(e,t,n){var a=!1,r=n.value;return{configurable:!0,get:function(){if(a)return r;var e=r.bind(this);return a=!0,Object.defineProperty(this,t,{value:e,configurable:!0,writable:!0}),a=!1,e}}}n(175);var Se=n(100),Oe=n(49),xe=n(77),De=n.n(xe),je=n(78),Ae=n.n(je),Me=n(54),Ne=n.n(Me),Ie=n(98),Re=n.n(Ie),Ue=n(390),Pe=n.n(Ue),Te=i.memo(function(e){var t=e.width,n=e.height,a=e.data,r=e.options,o=Object.keys(a.rows[0]),c=o[0],l=o.slice(1,o.length),s="".concat(c,"*").concat("yAxisValue"),u=i.useMemo(function(){return Object(Oe.a)({},c,r.isXAxisTime?{type:"time",nice:!0}:{nice:!0})},[r.isXAxisTime]);return i.useMemo(function(){a.transform({type:"fold",fields:l,key:"yAxisKey",value:"yAxisValue"})},[a]),i.createElement(De.a,{width:t,height:n,data:a,scale:u},i.createElement(Ae.a,null),i.createElement(Ne.a,{name:c}),i.createElement(Ne.a,{name:"yAxisValue"}),i.createElement(Re.a,{crosshairs:{type:"y"}}),i.createElement(Pe.a,{position:s,size:2,color:"yAxisKey",shape:r.isLineSmooth?"smooth":void 0}))}),Be=n(391),Le=n.n(Be),ze=i.memo(function(e){var t=e.width,n=e.height,a=e.data,r=Object.keys(a.rows[0]),o=r[0],c=r.slice(1,r.length),l="".concat(o,"*").concat("yAxisValue"),s=Object(Oe.a)({},o,{nice:!0});return i.useMemo(function(){a.transform({type:"fold",fields:c,key:"yAxisKey",value:"yAxisValue"})},[a]),i.createElement(De.a,{width:t,height:n,data:a,scale:s},i.createElement(Ae.a,null),i.createElement(Ne.a,{name:o}),i.createElement(Ne.a,{name:"yAxisValue"}),i.createElement(Re.a,{crosshairs:{type:"y"}}),i.createElement(Le.a,{position:l,color:"yAxisKey",adjust:[{type:"dodge",marginRatio:0}]}))}),Ke=n(392),Xe=n.n(Ke),Qe=n(393),Fe=n.n(Qe),He=n(394),qe=n.n(He),We=i.memo(function(e){var t=e.width,n=e.height,a=e.data,r=Object.keys(a.rows[0]),o=r[0],c=r[1];return i.useMemo(function(){a.transform({type:"percent",fields:c,dimension:o,as:"percent"})},[a]),i.createElement(De.a,{width:t,height:n,data:a,scale:{percent:{formatter:function(e){return"".concat(100*e,"%")}}}},i.createElement(Xe.a,{type:"theta"}),i.createElement(Ne.a,{name:"percent"}),i.createElement(Ae.a,{offsetY:50,clickable:!1}),i.createElement(Fe.a,{type:"intervalStack",position:"percent",color:o,tooltip:["".concat(o,"*").concat("percent"),function(e,t){return{name:e,value:"".concat(100*t,"%")}}],style:{lineWidth:1,stroke:"#fff"}},i.createElement(qe.a,{content:"percent",formatter:function(e,t){return"".concat(t.point.item,": ").concat(e)}})))}),Ge=n(395),Ze=n.n(Ge),Je=i.memo(function(e){var t=e.width,n=e.height,a=e.data,r=Object.keys(a.rows[0]),o=r[0],c=r[1],l=r.slice(2,r.length).join(" "),s="".concat(o,"*").concat(c),u=Object(Oe.a)({},o,{nice:!0});return i.createElement(De.a,{width:t,height:n,data:a,scale:u},i.createElement(Ae.a,null),i.createElement(Ne.a,{name:o}),i.createElement(Ne.a,{name:c}),i.createElement(Re.a,{crosshairs:{type:"cross"}}),i.createElement(Ze.a,{position:s,opacity:.65,shape:"circle",size:3,color:l}))});var Ve,Ye,_e=i.memo(function(e){var t=e.text,n=e.onChange,a=i.useContext(E.a).locale,r=i.useState(!1),o=Object(ue.a)(r,2),c=o[0],l=o[1],s=i.useRef(null);return i.useEffect(function(){c&&s.current&&function(e){if(e.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if("undefined"!=typeof document.body.createTextRange){var a=document.body.createTextRange();a.moveToElementText(e),a.collapse(!1),a.select()}}(s.current)},[c]),i.createElement(he,{ref:s,disabled:!c,placeholder:a.user.report.textEmptyTips,text:t,style:c?{cursor:"text"}:void 0,onDoubleClick:i.useCallback(function(){return l(!0)},[]),onChange:n,onBlur:i.useCallback(function(){return l(!1)},[])})});n(817);!function(e){e.Chart="chart",e.Text="text"}(Ve||(Ve={})),function(e){e.LineChart="lineChart",e.BarChart="barChart",e.PieChart="pieChart",e.ScatterChart="scatterChart"}(Ye||(Ye={}));var $e,et=i.memo(function(e){var t=e.id,n=e.type,a=e.x,r=e.y,o=e.width,c=e.height,l=e.selected,s=e.onMouseMove,u=e.onMouseDown,d=e.onMouseUp,p=e.onInputText;return i.createElement("div",{style:{width:o+4,height:c+(n===Ve.Chart?6:0)+4,transform:"translate(".concat(a,"px, ").concat(r,"px)")},className:"report-element".concat(l?" report-element-selected":""),id:t,"data-x":a,"data-y":r,onMouseMove:s,onMouseDown:u,onMouseUp:d},function(){switch(e.type){case Ve.Chart:if(!e.dataSource||!e.dataSource.id||!e.dataSource.data.rows||0===e.dataSource.data.rows.length)return i.createElement(Se.a,{style:{height:"100%"}});var t={width:o,height:c,data:e.dataSource.data,options:e.options};switch(e.chartType){case Ye.LineChart:return i.createElement(Te,t);case Ye.BarChart:return i.createElement(ze,t);case Ye.PieChart:return i.createElement(We,t);case Ye.ScatterChart:return i.createElement(Je,t);default:throw new Error("Invalid reportEl chartType ".concat(e.chartType,"."))}case Ve.Text:return i.createElement(_e,{text:e.text,onChange:p});default:throw new Error("Invalid reportEl type ".concat(e.type,"."))}}())});!function(e){e.Add="add",e.Delete="delete",e.Move="move",e.Resize="resize",e.StartEdit="startEdit",e.Select="select",e.Unselect="unselect",e.InputText="inputText",e.SetChartDataSource="setChartsDataSource",e.SetChartOptions="setChartsOptions",e.Undo="undo",e.Redo="redo"}($e||($e={}));var tt,nt=1e4;function at(e,t){var n=e.undoStack,a=e.redoStack,r=t.type,o=[],c=[];switch(t.type){case $e.Undo:if(!(n.length>0))return e;t=n[n.length-1],o=n.slice(0,n.length-1);break;case $e.Redo:if(!(a.length>0))return e;t=a[a.length-1],c=a.slice(0,a.length-1)}if(0===t.payload.length)return e;var i,l=null;switch(t.type){case $e.Add:l={type:$e.Delete,payload:t.payload.map(function(e){return e.id})},i=e.state.map(function(e){return Object(se.a)({},e,{selected:!1,editing:!1})}).concat(t.payload.map(function(e){return e.type===Ve.Chart?Object(se.a)({},e,{dataSource:Object(se.a)({},e.dataSource,{data:(new J.a.View).source(e.dataSource.data)})}):e}));break;case $e.Delete:l={type:$e.Add,payload:e.state.filter(function(e){return-1!==t.payload.indexOf(e.id)}).map(function(e){return e.type===Ve.Chart?Object(se.a)({},e,{dataSource:Object(se.a)({},e.dataSource,{data:e.dataSource.data.origin})}):e})},i=e.state.filter(function(e){return-1===t.payload.indexOf(e.id)});break;case $e.Move:l={type:$e.Move,payload:e.state.filter(function(e){return t.payload.some(function(t){return t.id===e.id})}).map(function(e){return{id:e.id,x:e.x,y:e.y}})},i=e.state.map(function(e){var n=!0,a=!1,r=void 0;try{for(var o,c=t.payload[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var i=o.value;if(e.id===i.id){var l=i.x,s=i.y,u=e.width,d=e.height,p=document.querySelector(".report-canvas-container"),m=p.clientWidth,h=p.clientHeight;return Object(se.a)({},e,{x:Math.max(Math.min(l,m-u-4),0),y:Math.max(Math.min(s,h-d-4),0)})}}}catch(y){a=!0,r=y}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}return e});break;case $e.Resize:l={type:$e.Resize,payload:e.state.filter(function(e){return t.payload.some(function(t){return t.id===e.id})}).map(function(e){return{id:e.id,x:e.x,y:e.y,width:e.width,height:e.height}})},i=e.state.map(function(e){var n=!0,a=!1,r=void 0;try{for(var o,c=t.payload[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var i=o.value;if(e.id===i.id){var l=i.x,s=i.y,u=i.width,d=i.height,p=document.querySelector(".report-canvas-container"),m=p.clientWidth,h=p.clientHeight;return Object(se.a)({},e,{x:Math.max(Math.min(l,m-u-4),0),y:Math.max(Math.min(s,h-d-4),0),width:u,height:d})}}}catch(y){a=!0,r=y}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}return e});break;case $e.StartEdit:i=e.state.map(function(e){return e.id===t.payload?Object(se.a)({},e,{selected:!0,editing:!0}):Object(se.a)({},e,{editing:!1})});break;case $e.Select:i=e.state.map(function(e){return t.payload.some(function(t){return e.id===t})?Object(se.a)({},e,{selected:!0}):e});break;case $e.Unselect:i=e.state.map(function(e){return t.payload.some(function(t){return e.id===t})?Object(se.a)({},e,{selected:!1,editing:!1}):e});break;case $e.InputText:var s=!0,u=!1,d=void 0;try{for(var p,m=e.state[Symbol.iterator]();!(s=(p=m.next()).done);s=!0){var h=p.value;if(h.id===t.payload.id&&h.type===Ve.Text){var y=h.id,f=h.text;l={type:$e.InputText,payload:{id:y,text:f}}}}}catch(R){u=!0,d=R}finally{try{s||null==m.return||m.return()}finally{if(u)throw d}}i=e.state.map(function(e){return e.id===t.payload.id&&e.type===Ve.Text?Object(se.a)({},e,{text:t.payload.text}):e});break;case $e.SetChartDataSource:var v=!0,g=!1,b=void 0;try{for(var E,w=e.state[Symbol.iterator]();!(v=(E=w.next()).done);v=!0){var k=E.value;if(k.id===t.payload.id&&k.type===Ve.Chart){var C=k.id,S=k.dataSource;l={type:$e.SetChartDataSource,payload:{id:C,dataSource:S}}}}}catch(R){g=!0,b=R}finally{try{v||null==w.return||w.return()}finally{if(g)throw b}}i=e.state.map(function(e){return e.id===t.payload.id&&e.type===Ve.Chart?Object(se.a)({},e,{dataSource:Object(se.a)({},t.payload.dataSource,{data:(new J.a.View).source(t.payload.dataSource.data)})}):e});break;case $e.SetChartOptions:var O=!0,x=!1,D=void 0;try{for(var j,A=e.state[Symbol.iterator]();!(O=(j=A.next()).done);O=!0){var M=j.value;if(M.id===t.payload.id&&M.type===Ve.Chart){var N=M.id,I=M.options;l={type:$e.SetChartOptions,payload:{id:N,options:I}}}}}catch(R){x=!0,D=R}finally{try{O||null==A.return||A.return()}finally{if(x)throw D}}i=e.state.map(function(e){return e.id===t.payload.id&&e.type===Ve.Chart?Object(se.a)({},e,{options:t.payload.options}):e});break;default:throw new Error("Unexcepted action type ".concat(t.type))}return!l||t.disallowUndo?Object(se.a)({},e,{state:i}):(r===$e.Undo?c=a.concat(l):(r!==$e.Redo&&(c=[]),o=n.length===nt?n.slice(1,n.length).concat(l):n.concat(l)),{undoStack:o,redoStack:c,state:i})}var rt,ot,ct=(tt=function(){function e(t){Object(fe.a)(this,e),this._props=void 0,this._selector=".report-editor .report-element",this._props=t;var n={onmove:this._onDragMove,restrict:{restriction:"parent",elementRect:{top:0,left:0,bottom:1,right:1}}},a={onmove:this._onResizeMove,edges:{left:!0,right:!0,bottom:!0,top:!0},restrictEdges:{outer:"parent"},restrictSize:{min:{width:150,height:150}}};ke()(this._selector).draggable(n).resizable(a)}return Object(ve.a)(e,[{key:"destroy",value:function(){ke()(this._selector).unset()}},{key:"_onDragMove",value:function(e){var t=e.target,n=e.dx,a=e.dy,r=Number(t.getAttribute("data-x"))+n,o=Number(t.getAttribute("data-y"))+a;Number.isNaN(r)||Number.isNaN(o)||this._props.reportElsDispatch({type:$e.Move,payload:[{id:t.id,x:r,y:o}]})}},{key:"_onResizeMove",value:function(e){var t=e,n=t.target,a=t.deltaRect,r=t.rect,o=Number(n.dataset.x)+a.left,c=Number(n.dataset.y)+a.top;Number.isNaN(o)||Number.isNaN(c)||this._props.reportElsDispatch({type:$e.Resize,payload:[{id:n.id,x:o,y:c,width:r.width,height:r.height}]})}}]),e}(),Object(Ee.a)(tt.prototype,"_onDragMove",[Ce],Object.getOwnPropertyDescriptor(tt.prototype,"_onDragMove"),tt.prototype),Object(Ee.a)(tt.prototype,"_onResizeMove",[Ce],Object.getOwnPropertyDescriptor(tt.prototype,"_onResizeMove"),tt.prototype),tt),it=(rt=function(){function e(t){Object(fe.a)(this,e),this._props=void 0,this._preventDelete=!1,this._props=t,window.addEventListener("keydown",this._onKeydown),window.addEventListener("keyup",this._onKeyup)}return Object(ve.a)(e,[{key:"update",value:function(e){this._props=Object(se.a)({},this._props,e)}},{key:"destroy",value:function(){window.removeEventListener("keydown",this._onKeydown),window.removeEventListener("keyup",this._onKeyup)}},{key:"_onInputText",value:function(e,t){this._props.reportElsDispatch({type:$e.InputText,payload:{id:e,text:t}})}},{key:"_onKeydown",value:function(e){var t=this._props,n=t.reportElsState,a=t.reportElsDispatch;switch(e.keyCode){case 8:if(this._preventDelete)return;this._preventDelete=!0,e.preventDefault(),a({type:$e.Delete,payload:n.filter(function(e){return e.selected}).map(function(e){return e.id})});break;case 37:e.preventDefault(),a({type:$e.Move,payload:n.filter(function(e){return e.selected}).map(function(t){return{id:t.id,x:t.x+(e.shiftKey?-1:-10),y:t.y}})});break;case 38:e.preventDefault(),a({type:$e.Move,payload:n.filter(function(e){return e.selected}).map(function(t){return{id:t.id,x:t.x,y:t.y+(e.shiftKey?-1:-10)}})});break;case 39:e.preventDefault(),a({type:$e.Move,payload:n.filter(function(e){return e.selected}).map(function(t){return{id:t.id,x:t.x+(e.shiftKey?1:10),y:t.y}})});break;case 40:e.preventDefault(),a({type:$e.Move,payload:n.filter(function(e){return e.selected}).map(function(t){return{id:t.id,x:t.x,y:t.y+(e.shiftKey?1:10)}})});break;case 65:ye({ctrlKey:e.ctrlKey,metaKey:e.metaKey})&&(e.preventDefault(),e.shiftKey?a({type:$e.Unselect,payload:n.map(function(e){return e.id}),disallowUndo:!0}):a({type:$e.Select,payload:n.map(function(e){return e.id}),disallowUndo:!0}));break;case 83:ye({ctrlKey:e.ctrlKey,metaKey:e.metaKey})&&(e.preventDefault(),this._props.onSave(n));break;case 89:ye({ctrlKey:e.ctrlKey,metaKey:e.metaKey})&&(e.preventDefault(),a({type:$e.Redo,disallowUndo:!0}));break;case 90:ye({ctrlKey:e.ctrlKey,metaKey:e.metaKey})&&(e.preventDefault(),e.shiftKey?a({type:$e.Redo,disallowUndo:!0}):a({type:$e.Undo,disallowUndo:!0}))}}},{key:"_onKeyup",value:function(e){this._preventDelete=!1}}]),e}(),Object(Ee.a)(rt.prototype,"_onInputText",[Ce],Object.getOwnPropertyDescriptor(rt.prototype,"_onInputText"),rt.prototype),Object(Ee.a)(rt.prototype,"_onKeydown",[Ce],Object.getOwnPropertyDescriptor(rt.prototype,"_onKeydown"),rt.prototype),Object(Ee.a)(rt.prototype,"_onKeyup",[Ce],Object.getOwnPropertyDescriptor(rt.prototype,"_onKeyup"),rt.prototype),rt),lt=(ot=function(){function e(t){Object(fe.a)(this,e),this._props=void 0,this._canvasContainer={mouseDownPosition:{x:0,y:0}},this._props=t}return Object(ve.a)(e,[{key:"update",value:function(e){this._props=Object(se.a)({},this._props,e)}},{key:"destroy",value:function(){}},{key:"onRedoBtnClick",value:function(){this._props.reportElsDispatch({type:$e.Redo,disallowUndo:!0})}},{key:"onUndoBtnClick",value:function(){this._props.reportElsDispatch({type:$e.Undo,disallowUndo:!0})}},{key:"onSelectAllBtnClick",value:function(){var e=this._props,t=e.reportElsState;(0,e.reportElsDispatch)({type:$e.Select,payload:t.map(function(e){return e.id}),disallowUndo:!0})}},{key:"onDeleteSelectedBtnClick",value:function(){var e=this._props,t=e.reportElsState;(0,e.reportElsDispatch)({type:$e.Delete,payload:t.filter(function(e){return e.selected}).map(function(e){return e.id})})}},{key:"onAddTextBtnClick",value:function(){this._props.reportElsDispatch({type:$e.Add,payload:[{id:"_".concat(Math.random().toString(36).substr(2,9)).concat(Math.random().toString(36).substr(2,9)),type:Ve.Text,width:400,height:160,x:600,y:200,text:"",selected:!0,editing:!0}]})}},{key:"onChartListItemClick",value:function(e){this._props.reportElsDispatch({type:$e.Add,payload:[{id:"_".concat(Math.random().toString(36).substr(2,9)).concat(Math.random().toString(36).substr(2,9)),type:Ve.Chart,chartType:e,width:400,height:300,x:600,y:200,dataSource:{id:"",data:[]},selected:!0,editing:!0,options:{}}]})}},{key:"onCanvasContainerMouseDown",value:function(e){this._canvasContainer.mouseDownPosition={x:e.clientX,y:e.clientY}}},{key:"onCanvasContainerMouseUp",value:function(e){var t=this._canvasContainer.mouseDownPosition,n=t.x,a=t.y,r=e.clientX,o=e.clientY,c=this._props,i=c.reportElsState,l=c.reportElsDispatch;n===r&&a===o&&l({type:$e.Unselect,payload:i.map(function(e){return e.id}),disallowUndo:!0})}},{key:"onReportElMouseUp",value:function(e){e.stopPropagation()}},{key:"onReportElMouseDown",value:function(e,t){var n=this._props,a=n.reportElsState,r=n.reportElsDispatch;t&&r({type:$e.Unselect,payload:a.map(function(e){return e.id}),disallowUndo:!0}),r({type:$e.StartEdit,payload:e,disallowUndo:!0})}},{key:"onReportElMouseMove",value:function(e){var t=document.querySelector("#".concat(e.currentTarget.id," canvas")),n=document.querySelector("html");t&&n&&(t.style.cursor=n.style.cursor||"auto")}},{key:"onChartDataSourceSelect",value:function(e,t){this._props.reportElsDispatch({type:$e.SetChartDataSource,payload:{id:e,dataSource:t}})}},{key:"onChartOptionsChange",value:function(e,t){this._props.reportElsDispatch({type:$e.SetChartOptions,payload:{id:e,options:t}})}}]),e}(),Object(Ee.a)(ot.prototype,"onRedoBtnClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onRedoBtnClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onUndoBtnClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onUndoBtnClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onSelectAllBtnClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onSelectAllBtnClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onDeleteSelectedBtnClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onDeleteSelectedBtnClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onAddTextBtnClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onAddTextBtnClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onChartListItemClick",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onChartListItemClick"),ot.prototype),Object(Ee.a)(ot.prototype,"onCanvasContainerMouseDown",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onCanvasContainerMouseDown"),ot.prototype),Object(Ee.a)(ot.prototype,"onCanvasContainerMouseUp",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onCanvasContainerMouseUp"),ot.prototype),Object(Ee.a)(ot.prototype,"onReportElMouseDown",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onReportElMouseDown"),ot.prototype),Object(Ee.a)(ot.prototype,"onChartDataSourceSelect",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onChartDataSourceSelect"),ot.prototype),Object(Ee.a)(ot.prototype,"onChartOptionsChange",[Ce],Object.getOwnPropertyDescriptor(ot.prototype,"onChartOptionsChange"),ot.prototype),ot),st=(n(162),n(63));function ut(){return(ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var dt=l.a.createElement("defs",null),pt=l.a.createElement("path",{d:"M524.8 362.66666667c-110.933333 0-209.066667 42.666667-285.866667 110.933333L85.333333 319.99999967v384h375.466667l-149.333333-153.6c59.733333-51.2 132.266667-81.066667 213.333333-81.066666 149.333333 0 273.066667 98.133333 315.733333 234.666666l98.133334-34.133333C878.933333 490.66666667 716.8 362.66666667 524.8 362.66666667z",pId:1119}),mt=function(e){return l.a.createElement("svg",ut({t:1551597541207,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:1118,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),dt,pt)};n.p;function ht(){return(ht=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var yt=l.a.createElement("defs",null),ft=l.a.createElement("path",{d:"M786.005333 473.34400033l152.021333-153.984 0 384-384 0 155.989333-153.984q-96-80-219.989333-80-112 0-201.002667 64.981333t-123.008 169.002667l-100.010667-32q43.989333-136.021333 160.981333-221.994667t262.997333-86.016q169.984 0 296.021333 109.994667z",pId:1349}),vt=function(e){return l.a.createElement("svg",ht({t:1551597561334,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:1348,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),yt,ft)};n.p;function gt(){return(gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var bt=l.a.createElement("defs",null),Et=l.a.createElement("path",{d:"M866.7136 792.6784H227.566933l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934h-47.445333a18.670933 18.670933 0 0 0-18.944 18.6368l-0.2048 628.053334v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H866.7136a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z",pId:9310}),wt=l.a.createElement("path",{d:"M724.48 934.912H85.367467l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934H19.182933a18.670933 18.670933 0 0 0-18.944 18.6368L0 977.578667v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H724.48a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z",pId:9311}),kt=l.a.createElement("path",{d:"M1005.704533 3.754667H302.728533a18.397867 18.397867 0 0 0-18.295466 18.295466v703.010134c0 9.966933 8.192 18.295467 18.295466 18.295466h703.010134c9.966933 0 18.295467-8.192 18.295466-18.295466V22.016a18.432 18.432 0 0 0-18.3296-18.261333zM938.666667 657.988267H369.7664V89.088H938.666667v568.900267z",pId:9312}),Ct=l.a.createElement("path",{d:"M570.0608 505.002667l16.4864 16.4864c7.543467 7.543467 19.490133 7.850667 27.3408 0l16.4864-16.4864 236.885333-236.885334a18.6368 18.6368 0 0 0 0.068267-26.862933l-33.553067-33.553067a19.114667 19.114667 0 0 0-26.862933 0.068267l-206.711467 206.711467-72.977066-72.977067a18.568533 18.568533 0 0 0-26.760534 0.034133l-33.553066 33.553067a19.182933 19.182933 0 0 0-0.034134 26.760533l103.185067 103.150934z",pId:9313}),St=function(e){return l.a.createElement("svg",gt({t:1551599533521,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:9309,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),bt,Et,wt,kt,Ct)};n.p;function Ot(){return(Ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var xt=l.a.createElement("defs",null),Dt=l.a.createElement("path",{d:"M843.294118 120.470588l0 180.705882-60.235294 0 0-120.470588-240.941176 0 0 722.823529 98.966588 0 0 60.235294-258.168471 0 0-60.235294 98.966588 0 0-722.823529-240.941176 0 0 120.470588-60.235294 0 0-180.705882 662.588235 0z",pId:9078}),jt=function(e){return l.a.createElement("svg",Ot({t:1551599120489,className:"icon",style:{},viewBox:"0 0 1024 1024",version:1.1,pId:9077,xmlnsXlink:"http://www.w3.org/1999/xlink",width:200,height:200},e),xt,Dt)},At=(n.p,n(819),b.a.Header),Mt=i.memo(function(e){var t=e.disableUndo,n=e.disableRedo,a=e.disableDelete,r=e.onUndoBtnClick,o=e.onRedoBtnClick,c=e.onSelectAllBtnClick,l=e.onChartListItemClick,s=e.onAddTextBtnClick,u=e.onDeleteSelectedBtnClick,d=i.useContext(E.a).locale,p=[{key:Ye.LineChart,value:d.user.report.lineChart},{key:Ye.BarChart,value:d.user.report.barChart},{key:Ye.PieChart,value:d.user.report.pieChart},{key:Ye.ScatterChart,value:d.user.report.scatterChart}],m=i.createElement(g.a,null,p.map(function(e){return i.createElement(g.a.Item,{key:e.key,onClick:i.useCallback(function(){return l(e.key)},[e.key])},e.value)}));return i.createElement(At,{className:"toolbar"},i.createElement("div",{className:"toolbar-btn"},i.createElement(st.a,{title:d.user.report.undo,placement:"bottom"},i.createElement(f.a,{disabled:t,onClick:r},i.createElement(v.a,{component:mt})))),i.createElement("div",{className:"toolbar-btn"},i.createElement(st.a,{title:d.user.report.redo,placement:"bottom"},i.createElement(f.a,{disabled:n,onClick:o},i.createElement(v.a,{component:vt})))),i.createElement(h.a,{type:"vertical"}),i.createElement("div",{className:"toolbar-btn"},i.createElement(st.a,{title:d.user.report.selectAll,placement:"bottom"},i.createElement(f.a,{onClick:c},i.createElement(v.a,{component:St})))),i.createElement(h.a,{type:"vertical"}),i.createElement("div",{className:"toolbar-btn"},i.createElement(y.a,{overlay:m,trigger:["click"]},i.createElement(f.a,null,i.createElement(v.a,{type:"bar-chart"})," ",d.user.report.chart," ",i.createElement(v.a,{type:"down"})))),i.createElement(h.a,{type:"vertical"}),i.createElement("div",{className:"toolbar-btn"},i.createElement(st.a,{title:d.user.report.text,placement:"bottom"},i.createElement(f.a,{onClick:s},i.createElement(v.a,{component:jt})))),i.createElement(h.a,{type:"vertical"}),i.createElement("div",{className:"toolbar-btn"},i.createElement(st.a,{title:d.user.report.deleteSelected,placement:"bottom"},i.createElement(f.a,{type:"danger",disabled:a,onClick:u},i.createElement(v.a,{type:"delete"})))))}),Nt=(n(821),n(275)),It=(n(218),n(79)),Rt=(n(824),b.a.Sider),Ut=i.memo(function(e){var t=e.editingReportEl,n=e.dataSources,a=e.onChartDataSourceSelect,r=e.onChartOptionsChange,o=i.useContext(E.a).locale;if(!t)return i.createElement(Rt,{className:"config-panel"});var c=o.user.report[t.type];return t.type===Ve.Chart&&t.chartType&&(c+=" > ".concat(o.user.report[t.chartType])),i.createElement(Rt,{className:"config-panel"},i.createElement("div",{className:"title"},c),function(){var e=[];switch(t.type){case Ve.Text:break;case Ve.Chart:t.dataSource&&e.push(i.createElement("div",{key:"data-source",className:"config-item"},i.createElement("div",null,o.user.home.dataSources.title),i.createElement(It.a,{value:t.dataSource.id,style:{width:"160px"},onSelect:function(e){var r=!0,o=!1,c=void 0;try{for(var i,l=n.rows[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var s=i.value;if(s.id===e){var u=s.id,d=s.data;a(t.id,{id:u,data:d})}}}catch(p){o=!0,c=p}finally{try{r||null==l.return||l.return()}finally{if(o)throw c}}}},n.rows.map(function(e){return i.createElement(It.a.Option,{key:e.id,value:e.id},e.name)})))),t.type===Ve.Chart&&t.chartType===Ye.LineChart&&e.push(i.createElement("div",{key:"is-x-axis-time",className:"config-item"},i.createElement("div",null,o.user.report.isXAxisTime),i.createElement(Nt.a,{checked:t.options.isXAxisTime,checkedChildren:i.createElement(v.a,{type:"check"}),unCheckedChildren:i.createElement(v.a,{type:"close"}),onClick:i.useCallback(function(e){var n=t.id,a=t.options;r(n,Object(se.a)({},a,{isXAxisTime:e}))},[t])})),i.createElement("div",{key:"is-line-smooth",className:"config-item"},i.createElement("div",null,o.user.report.isLineSmooth),i.createElement(Nt.a,{checked:t.options.isLineSmooth,checkedChildren:i.createElement(v.a,{type:"check"}),unCheckedChildren:i.createElement(v.a,{type:"close"}),onClick:i.useCallback(function(e){var n=t.id,a=t.options;r(n,Object(se.a)({},a,{isLineSmooth:e}))},[t])})))}return e}())}),Pt=(n(827),b.a.Content);var Tt=i.memo(function(e){var t=e.initialEls,n=e.dataSources,a=e.onSave,r=i.useRef(null),o=i.useReducer(at,{undoStack:[],redoStack:[],state:[]},{type:$e.Add,payload:t,disallowUndo:!0}),c=Object(ue.a)(o,2),l=c[0],s=c[1],u=i.useMemo(function(){return{g:new be,interact:new ct({reportElsDispatch:s}),keyboard:new it({reportElsState:l.state,reportElsDispatch:s,onSave:a}),mouse:new lt({reportElsState:l.state,reportElsDispatch:s})}},[]),d=i.useMemo(function(){var e=!0,t=!1,n=void 0;try{for(var a,r=l.state[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var o=a.value;if(o.editing)return o}}catch(c){t=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}return null},[l.state]);return i.useEffect(function(){u.keyboard.update({reportElsState:l.state}),u.mouse.update({reportElsState:l.state})},[l.state]),i.useEffect(function(){return s({type:$e.Add,payload:[],disallowUndo:!0}),u.g.init(),function(){u.g.destroy(),u.interact.destroy(),u.keyboard.destroy(),u.mouse.destroy()}},[]),i.createElement(b.a,{className:"report-editor"},i.createElement(Mt,{disableUndo:0===l.undoStack.length,disableRedo:0===l.redoStack.length,disableDelete:0===l.state.filter(function(e){return e.selected}).length,onUndoBtnClick:u.mouse.onUndoBtnClick,onRedoBtnClick:u.mouse.onRedoBtnClick,onSelectAllBtnClick:u.mouse.onSelectAllBtnClick,onChartListItemClick:u.mouse.onChartListItemClick,onAddTextBtnClick:u.mouse.onAddTextBtnClick,onDeleteSelectedBtnClick:u.mouse.onDeleteSelectedBtnClick}),i.createElement(b.a,null,i.createElement(Pt,{className:"report-canvas-container",onMouseDown:u.mouse.onCanvasContainerMouseDown,onMouseUp:u.mouse.onCanvasContainerMouseUp},i.createElement("div",{ref:r,id:"report-canvas"}),l.state.map(function(e){return i.createElement(et,Object.assign({key:e.id},e,{onMouseMove:e.type===Ve.Chart?u.mouse.onReportElMouseMove:void 0,onMouseDown:function(t){return u.mouse.onReportElMouseDown(e.id,!ye({ctrlKey:t.ctrlKey,metaKey:t.metaKey}))},onMouseUp:u.mouse.onReportElMouseUp,onInputText:e.type===Ve.Text?function(t){return u.keyboard._onInputText(e.id,t.target.value)}:void 0}))})),i.createElement(Ut,{editingReportEl:d,dataSources:n,onChartDataSourceSelect:u.mouse.onChartDataSourceSelect,onChartOptionsChange:u.mouse.onChartOptionsChange})))});n(829);function Bt(){var e=Object(a.a)(["\n  mutation saveReportEls($id: ID!, $elements: String!) {\n    saveReportEls(id: $id, elements: $elements)\n  }\n"]);return Bt=function(){return e},e}function Lt(){var e=Object(a.a)(["\n  mutation renameReport($id: ID!, $name: String!) {\n    renameReport(id: $id, name: $name)\n  }\n"]);return Lt=function(){return e},e}function zt(){var e=Object(a.a)(["\n  query {\n    getDataSources {\n      rows {\n        id\n        name\n        data\n      }\n      count\n    }\n  }\n"]);return zt=function(){return e},e}function Kt(){var e=Object(a.a)(["\n  query getReport($id: ID!) {\n    getReport(id: $id) {\n      id\n      updatedAt\n      name\n      elements\n    }\n  }\n"]);return Kt=function(){return e},e}var Xt=b.a.Header,Qt=d()(Kt()),Ft=d()(zt()),Ht=d()(Lt()),qt=d()(Bt());var Wt=i.memo(Object(p.compose)(Object(p.graphql)(Qt,{options:function(e){return{variables:{id:e.reportId}}},props:function(e){var t=e.data;if(!t)return{data:t};var n=t.getReport?{getReport:Object(se.a)({},t.getReport,{elements:JSON.parse(t.getReport.elements)})}:{};return{getReport:Object(se.a)({},t,n)}}}),Object(p.graphql)(Ft,{props:function(e){var t=e.data;if(!t)return{data:t};var n=t.getDataSources?{getDataSources:Object(se.a)({},t.getDataSources,{rows:t.getDataSources.rows.map(function(e){return Object(se.a)({},e,{data:JSON.parse(e.data)})})})}:{};return{getDataSources:Object(se.a)({},t,n)}}}),Object(p.graphql)(qt,{props:function(e){return{saveReport:e.mutate}}}))(function(e){var t=e.getReport,n=e.getDataSources,a=e.saveReport,r=t.loading||n.loading,o=t.error||n.error;if(r)return i.createElement(I,null);if(o)return i.createElement(R.a,null);if(!t||!n||!a)return null;var c=i.useContext(E.a).locale,l=i.useState(t.getReport),u=Object(ue.a)(l,2),d=u[0],m=u[1];return i.createElement(b.a,{className:"page-container"},i.createElement(Xt,{className:"report-header"},i.createElement(s.a,{to:_t.User.Home.Reports},i.createElement(v.a,{type:"left"})),i.createElement("div",{className:"report-info"},i.createElement(p.Mutation,{mutation:Ht,variables:{id:d.id,name:d.name}},function(e){return i.createElement(he,{className:"title",placeholder:c.user.home.reports.unnamedReport,text:d.name,onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),e.target.blur())},onChange:function(e){return m(Object(se.a)({},d,{name:e.target.value}))},onBlur:function(t){return e()}})}),i.createElement("span",{className:"detail"},c.common.updatedAt,": ",M()(d.updatedAt).format("lll")))),i.createElement(Tt,{initialEls:d.elements,dataSources:n.getDataSources,onSave:function(e){a({variables:{id:d.id,elements:JSON.stringify(e.map(function(e){return e.type===Ve.Chart?Object(se.a)({},e,{dataSource:Object(se.a)({},e.dataSource,{data:e.dataSource.data.origin})}):e}))}}),console.log(e.map(function(e){return e.type===Ve.Chart?Object(se.a)({},e,{dataSource:Object(se.a)({},e.dataSource,{data:e.dataSource.data.origin})}):e}))}}))})),Gt=i.memo(function(e){return i.useEffect(function(){e.doAction()},[]),null});function Zt(){var e=Object(a.a)(["\n  mutation signInByToken($id: ID!, $token: String!) {\n    signInByToken(id: $id, token: $token) {\n      id\n      username\n      token\n    }\n  }\n"]);return Zt=function(){return e},e}n.d(t,"a",function(){return _t});var Jt=i.lazy(Object(c.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([n.e(5),n.e(1)]).then(n.bind(null,885)));case 1:case"end":return e.stop()}},e,this)}))),Vt=i.lazy(Object(c.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.e(2).then(n.bind(null,883)));case 1:case"end":return e.stop()}},e,this)}))),Yt=i.lazy(Object(c.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.e(3).then(n.bind(null,884)));case 1:case"end":return e.stop()}},e,this)}))),_t={SignIn:"/",User:{Path:"/",Home:{Path:"/",Reports:"/",DataSources:"/data-sources"},Report:"/report/:reportId"}},$t=d()(Zt());t.b=i.memo(function(e){var t=i.useContext(m.a),n=t.user,a=n.id,r=n.username,o=n.token,c=n.hasSignedIn,l=t.setUser,u=i.useCallback(function(e){var t=e.signInByToken,n=t.id,a=t.username,r=t.token;l({id:n,username:a,token:r,hasSignedIn:!0})},[]);return i.createElement(i.Suspense,{fallback:i.createElement(I,null)},i.createElement(p.Mutation,{mutation:$t,variables:{id:a,token:o},onCompleted:u},function(e,t){var n=t.loading,l=t.error;return a&&r&&o?c?n?i.createElement(I,null):l?i.createElement(s.b,{className:"Routes"},i.createElement(Jt,{path:"/"}),i.createElement(Yt,{default:!0})):i.createElement(s.b,{className:"Routes"},i.createElement(Vt,{path:"/"},i.createElement(D,{path:"/"},i.createElement(q,{path:"/"}),i.createElement(le,{path:"data-sources"}),i.createElement(Yt,{default:!0})),i.createElement(Wt,{path:"report/:reportId"}),i.createElement(Yt,{default:!0})),i.createElement(Yt,{default:!0})):i.createElement(Gt,{doAction:e}):i.createElement(s.b,{className:"Routes"},i.createElement(Jt,{path:"/"}),i.createElement(Yt,{default:!0}))}))})},376:function(e,t){e.exports="data:image/png;base64,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"},413:function(e,t,n){e.exports=n(845)},45:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={en_US:{locale:{key:"en_US",value:"English"},common:{loading:"Loading...",createdAt:"Created at",updatedAt:"Updated at"},signIn:{signIn:"Sign In",signUp:"Sign Up",username:"username",password:"password",usernameLimit:"The username should be 3 to 15 in length and consists of letters or numbers.",passwordLimit:"The password should be 6 to 15 in length and at least have one lowercase letter, uppercase letters as well as numbers."},user:{signOut:"Sign Out",home:{title:"home",reports:{title:"Reports",addReport:"Add a report",unnamedReport:"Unnamed report"},dataSources:{title:"Data sources",addDataSource:"Add a data source"}},report:{redo:"Redo",undo:"Undo",selectAll:"Select all",unselectAll:"Unselect all",deleteSelected:"Delete selected",chart:"Chart",text:"Text",lineChart:"Line chart",pieChart:"Pie chart",barChart:"Bar chart",scatterChart:"Scatter chart",textEmptyTips:"Please enter text.",isXAxisTime:"Is x axis time?",isLineSmooth:"Is line smooth?"}},error:{unauthorized:"Unauthorized.",existingUsername:"Existing Username.",nonexistentUsernameOrWrongPassword:"Noexistent username or wrong password.",reportNotFound:"Report not found.",dataSourceNotFound:"Data source not found.",networkError:"Network Error.",fileContentError:"File Content Error."},notFound:"Not Found!"},zh_CN:{locale:{key:"zh_CN",value:"\u7b80\u4f53\u4e2d\u6587"},common:{loading:"\u52a0\u8f7d\u4e2d...",createdAt:"\u521b\u5efa\u4e8e",updatedAt:"\u66f4\u65b0\u4e8e",uploadData:"\u4e0a\u4f20\u6570\u636e"},signIn:{signIn:"\u767b\u5f55",signUp:"\u6ce8\u518c",username:"\u7528\u6237\u540d",password:"\u5bc6\u7801",usernameLimit:"\u7528\u6237\u540d\u957f\u5ea6\u4e3a 3 \uff5e 15\uff0c\u7531\u5b57\u6bcd\u6216\u6570\u5b57\u7ec4\u6210\u3002",passwordLimit:"\u5bc6\u7801\u957f\u5ea6\u4e3a 6 \uff5e 15\uff0c\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3001\u5927\u5199\u5b57\u6bcd\u4ee5\u53ca\u6570\u5b57\u3002"},user:{signOut:"\u767b\u51fa",home:{title:"\u9996\u9875",reports:{title:"\u62a5\u544a",addReport:"\u65b0\u5efa\u62a5\u544a",unnamedReport:"\u672a\u547d\u540d\u62a5\u544a"},dataSources:{title:"\u6570\u636e\u6e90",addDataSource:"\u65b0\u5efa\u6570\u636e\u6e90"}},report:{redo:"\u91cd\u505a",undo:"\u64a4\u56de",selectAll:"\u5168\u9009",unselectAll:"\u53d6\u6d88\u9009\u62e9",deleteSelected:"\u5220\u9664\u6240\u9009",chart:"\u56fe\u8868",text:"\u6587\u672c",lineChart:"\u6298\u7ebf\u56fe",barChart:"\u67f1\u72b6\u56fe",pieChart:"\u997c\u72b6\u56fe",scatterChart:"\u6563\u70b9\u56fe",textEmptyTips:"\u8bf7\u8f93\u5165\u6587\u672c",isXAxisTime:"\u6a2a\u8f74\u662f\u5426\u4e3a\u65f6\u95f4\u8f74\uff1f",isLineSmooth:"\u6298\u7ebf\u662f\u5426\u4e3a\u66f2\u7ebf\uff1f"}},error:{unauthorized:"\u767b\u5f55\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",existingUsername:"\u7528\u6237\u540d\u5df2\u5b58\u5728\u3002",nonexistentUsernameOrWrongPassword:"\u7528\u6237\u540d\u4e0d\u5b58\u5728\u6216\u5bc6\u7801\u9519\u8bef\u3002",reportNotFound:"\u62a5\u544a\u4e0d\u5b58\u5728\u3002",dataSourceNotFound:"\u6570\u636e\u6e90\u4e0d\u5b58\u5728\u3002",networkError:"\u7f51\u7edc\u9519\u8bef\u3002",fileContentError:"\u6587\u4ef6\u5185\u5bb9\u9519\u8bef\u3002"},notFound:"\u8be5\u9875\u9762\u4e0d\u5b58\u5728\u3002"}}},450:function(e,t,n){},517:function(e,t,n){},522:function(e,t,n){},524:function(e,t,n){},629:function(e,t,n){},74:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return l});var a=n(53),r=n(0),o=n(82),c=n(246),i=r.createContext({user:{id:window.localStorage.getItem("id")||"",username:window.localStorage.getItem("username")||"",token:window.localStorage.getItem("token")||"",hasSignedIn:!1},setUser:function(){}}),l=r.memo(function(e){var t=r.useState({id:window.localStorage.getItem("id")||"",username:window.localStorage.getItem("username")||"",token:window.localStorage.getItem("token")||"",hasSignedIn:!1}),n=Object(a.a)(t,2),l=n[0],s=n[1],u=r.useMemo(function(){return{user:l,setUser:s}},[l]);return r.useEffect(function(){var e=l.id,t=l.username,n=l.token;e&&t&&n||Object(o.c)(c.a.SignIn),window.localStorage.setItem("id",e),window.localStorage.setItem("username",t),window.localStorage.setItem("token",n)},[l]),r.createElement(i.Provider,{value:u},e.children)})},817:function(e,t,n){},819:function(e,t,n){},824:function(e,t,n){},827:function(e,t,n){},829:function(e,t,n){},831:function(e,t,n){},838:function(e,t,n){},840:function(e,t,n){},845:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(9),o=n(74),c=n(21),i=n(246),l=n(60),s=n(61),u=n(402),d=n(397),p=n(403),m=n(97),h=(n(831),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={hasError:!1},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.state.hasError?a.createElement(m.a,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),t}(a.PureComponent)),y=(n(227),n(56)),f=n(400),v=n(32),g=a.memo(function(e){var t=a.useContext(c.a).locale,n=a.useContext(o.a),r=n.user,i=n.setUser,l=a.useMemo(function(){return new f.a({uri:"http://172.29.6.162:4000/graphql",headers:{authorization:r.token},onError:function(e){var n=e.graphQLErrors,a=e.networkError;n&&(n.map(function(e){var n=e.message,a=e.extensions;if(a)switch(a.code){case"UNAUTHORIZED":y.a.error(t.error.unauthorized),i({id:"",username:"",token:"",hasSignedIn:!1});break;case"EXISTING_USERNAME":y.a.error(t.error.existingUsername);break;case"NONEXISTENT_USERNAME_OR_WRONG_PASSWORD":y.a.error(t.error.nonexistentUsernameOrWrongPassword);break;case"REPORT_NOT_FOUND":y.a.error(t.error.reportNotFound);break;case"DATA_SOURCE_NOT_FOUND":y.a.error(t.error.dataSourceNotFound);break;default:y.a.error(n)}else y.a.error(n)}),a&&y.a.error(t.error.networkError))}})},[r,t]);return a.createElement(v.ApolloProvider,{client:l},e.children)}),b=(n(838),a.memo(function(){return a.createElement(o.b,null,a.createElement(c.b,null,a.createElement(h,null,a.createElement(g,null,a.createElement(i.b,null)))))})),E=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(840);r.render(a.createElement(b,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/smart",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/smart","/service-worker.js");E?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):w(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):w(t,e)})}}()},97:function(e,t,n){"use strict";var a=n(0);n(522);t.a=a.memo(function(){return a.createElement("span",null,"Error :(")})}},[[413,6,4]]]);
//# sourceMappingURL=main.a049450d.chunk.js.map