{"version":3,"sources":["contexts/Locale.tsx","routes/User/Home/index.tsx","components/Loading/index.tsx","components/CustomList/index.tsx","assets/icons/report.svg","routes/User/Home/Reports/index.tsx","components/UploadData/index.tsx","assets/icons/data-source.svg","routes/User/Home/DataSources/index.tsx","components/TextEditor/index.tsx","utils/customMetaKEey.ts","components/ReportEditor/controllers/GController.ts","decorators/bind.ts","components/Charts/LineChart/index.tsx","components/Charts/BarChart/index.tsx","components/Charts/PieChart/index.tsx","components/Charts/ScatterChart/index.tsx","components/ReportEditor/widgets/ReportElement/Text/index.tsx","components/ReportEditor/widgets/ReportElement/index.tsx","components/ReportEditor/widgets/ReportElement/reducer.ts","components/ReportEditor/controllers/InteractController.ts","components/ReportEditor/controllers/KeyboardController.ts","components/ReportEditor/controllers/MouseController.ts","assets/icons/undo.svg","assets/icons/redo.svg","assets/icons/select-all.svg","assets/icons/text.svg","components/ReportEditor/widgets/Toolbar/index.tsx","components/ReportEditor/widgets/ConfigPanel/index.tsx","components/ReportEditor/index.tsx","routes/User/Report/index.tsx","components/DoActionOnMount/index.tsx","routes/index.tsx","assets/images/logo.png","assets/locales/index.ts","assets/locales/en_US.ts","assets/locales/zh_CN.ts","contexts/User.tsx","components/ErrorBoundary/index.tsx","components/ApolloProvider/index.tsx","App.tsx","serviceWorker.ts","index.tsx","components/Error/index.tsx"],"names":["LocaleContext","React","locale","locales","window","localStorage","getItem","en_US","setLocale","otherLocaleMap","_otherLocaleMap","Object","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__","key","antd","antd_en_US","moment","zh_CN","antd_zh_CN","LocaleProvider","props","_React$useState","_React$useState2","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","_React$useState3","_React$useState4","antdLocale","setAntdLocale","LocaleContextValue","otherLocale","setItem","react__WEBPACK_IMPORTED_MODULE_4__","Provider","value","antd_es_locale_provider__WEBPACK_IMPORTED_MODULE_1__","children","Header","Sider","Content","setUser","UserContext","_React$useContext2","currentPaths","concat","uri","localeItems","siderMenuItems","AbsoluteRoute","User","Home","Reports","user","home","reports","title","DataSources","dataSources","localeDropDown","react","menu","map","localeItem","Item","onClick","signOut","id","username","token","hasSignedIn","changePath","_ref","navigate","layout","className","src","logo","alt","dropdown","overlay","trigger","es_button","size","icon","type","divider","selectedKeys","siderMenuItem","spin","tip","common","loading","responseKey","getListItems","handleListItemClick","removeListItem","itemIcon","itemNameFormatter","listHeader","react_apollo_browser_umd","query","queryResult","data","error","refetch","src_components_Loading","components_Error","dataSource","rows","header","undefined","listItemStyle","cursor","list","bordered","renderItem","item","style","e","name","createdAt","format","updatedAt","mutation","variables","onCompleted","shape","stopPropagation","_extends","assign","target","i","arguments","length","source","prototype","hasOwnProperty","call","apply","this","report_ref","react_default","a","createElement","report_ref2","d","pId","__webpack_require__","p","GET_ALL_REPORTS","gql","_templateObject","ADD_REPORT","_templateObject2","REMOVE_REPORT","_templateObject3","reportIcon","component","t","viewBox","version","xmlnsXlink","width","height","fontSize","color","reportsHeader","_ref3","asyncToGenerator","regenerator_default","mark","_callee","_ref2","wrap","_context","prev","next","addReport","Report","replace","stop","_x","_ref4","reportNameFormatter","unnamedReport","src_components_CustomList","ADD_DATA_SOURCE","UploadData_templateObject","graphql","options","onDataUploaded","uploadData","mutate","beforeUpload","file","fileReader","FileReader","readAsText","onload","event","JSON","stringify","parse","result","message","fileContentError","dataView","DataSet","View","transform","callback","row","valueToNumber","Number","isNaN","upload","accept","showUploadList","addDataSource","data_source_extends","data_source_ref","data_source_ref2","GET_DATA_SOURCES","DataSources_templateObject","REMOVE_DATA_SOURCE","DataSources_templateObject2","dataSourceIcon","dataSourcesHeader","components_UploadData","pasteOnlyText","preventDefault","document","execCommand","clipboardData","getData","ref","disabled","placeholder","text","onKeyDown","onDoubleClick","onChange","onBlur","react_contenteditable_default","innerRef","spellCheck","html","onPaste","customMetaKey","ctrlKey","metaKey","platform","navigator","includes","GController","_canvas","_canvasContainerSelector","_canvasSelector","canvasContainer","querySelector","canvas","clientWidth","clientHeight","containerId","Canvas","destroy","bind","propertyKey","descriptor","definingProperty","originalFn","configurable","get","defineProperty","writable","dataKeys","keys","xAxis","yAxes","slice","position","scale","isXAxisTime","nice","fields","Chart_default","Legend_default","Axis_default","Tooltip_default","crosshairs","Line_default","isLineSmooth","Interval_default","adjust","marginRatio","count","dimension","as","percent","formatter","val","Coord_default","offsetY","clickable","Geom_default","tooltip","lineWidth","stroke","Label_default","content","point","yAxis","join","Point_default","opacity","ReportElType","ReportChartType","slicedToArray","contentEditable","setContentEditable","editorRef","current","el","focus","getSelection","createRange","range","selectNodeContents","collapse","selection","removeAllRanges","addRange","body","createTextRange","textRange","moveToElementText","select","placeCaretAtEnd","components_TextEditor","report","textEmptyTips","ReportElsActionType","x","y","selected","onMouseMove","onMouseDown","onMouseUp","onInputText","reportElSelectedBorderWidth","Chart","data-x","data-y","empty","chartProps","chartType","LineChart","Charts_LineChart","BarChart","Charts_BarChart","PieChart","Charts_PieChart","ScatterChart","Charts_ScatterChart","Error","Text","ReportElement_Text","undoStackMaxLength","reportElsReducer","reportEls","action","undoStack","redoStack","originalActionType","newUndoStack","newRedoStack","Undo","Redo","payload","newReportElsState","reverseAction","Add","Delete","reportElWillRemove","state","reportEl","objectSpread","editing","reportElWillAdd","filter","indexOf","origin","Move","some","reportElMoved","reportElWillMove","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","Math","max","min","err","return","Resize","reportElResized","reportElWillResize","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","StartEdit","Select","reportElSelectedId","Unselect","InputText","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","SetChartDataSource","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","SetChartOptions","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","disallowUndo","InteractController","classCallCheck","_props","_selector","draggableOptions","onmove","_onDragMove","restrict","restriction","elementRect","top","left","bottom","right","resizableOptions","_onResizeMove","edges","restrictEdges","outer","restrictSize","interact","draggable","resizable","unset","dx","dy","getAttribute","reportElsDispatch","deltaRect","rect","dataset","ShortCutsController","_preventDelete","addEventListener","_onKeydown","_onKeyup","partialProps","removeEventListener","_this$_props","reportElsState","keyCode","selectedReportEl","reportElSelected","shiftKey","onSave","MouseController","_canvasContainer","mouseDownPosition","_this$_props2","reportElToDelete","random","toString","substr","clientX","clientY","_this$_canvasContaine","_this$_props3","reportElId","unselectOthers","_this$_props4","currentTarget","undo_extends","undo_ref","undo_ref2","undo_SvgComponent","redo_extends","redo_ref","redo_ref2","redo_SvgComponent","select_all_extends","select_all_ref","select_all_ref2","select_all_ref3","select_all_ref4","select_all_ref5","select_all_SvgComponent","text_extends","text_ref","text_ref2","text_SvgComponent","disableUndo","disableRedo","disableDelete","onUndoBtnClick","onRedoBtnClick","onSelectAllBtnClick","onChartListItemClick","onAddTextBtnClick","onDeleteSelectedBtnClick","reportChartTypeItems","lineChart","barChart","pieChart","scatterChart","addChartTypeMenu","reportChartTypeItem","Toolbar_Header","undo","placement","UndoSvg","redo","RedoSvg","selectAll","SelectAllSvg","chart","TextSvg","deleteSelected","editingReportEl","onChartDataSourceSelect","onChartOptionsChange","ConfigPanel_Sider","pannelItems","push","es_select","onSelect","dataSourceId","Option","es_switch","checked","checkedChildren","unCheckedChildren","initialEls","reportCanvasRef","_React$useReducer","_React$useReducer2","controller","g","keyboard","KeyboardController","mouse","update","init","ReportEditor_widgets_Toolbar","ReportEditor_Content","onCanvasContainerMouseDown","onCanvasContainerMouseUp","ReportEditor_widgets_ReportElement","onReportElMouseMove","onReportElMouseDown","onReportElMouseUp","_onInputText","ReportEditor_widgets_ConfigPanel","GET_REPORT","Report_templateObject","GET_DATASOURCES","Report_templateObject2","RENAME_REPORT","Report_templateObject3","SAVE_REPORT_ELS","_templateObject4","compose","reportId","getReport","elements","getDataSources","saveReport","setReport","Report_Header","es","to","renameReport","blur","components_ReportEditor","console","log","doAction","SignIn","abrupt","Promise","all","then","_callee2","_context2","NotFound","_callee3","_context3","Path","SIGN_IN_BY_TOKEN","routes_templateObject","_React$useContext","_React$useContext$use","onSignInByTokenCompleted","signInByToken","fallback","_ref5","path","default","routes_User","routes_User_Home","Home_Reports","Home_DataSources","User_Report","components_DoActionOnMount","module","exports","__webpack_exports__","signIn","signUp","password","usernameLimit","passwordLimit","unselectAll","unauthorized","existingUsername","nonexistentUsernameOrWrongPassword","reportNotFound","dataSourceNotFound","networkError","notFound","UserProvider","_Users_t_ming_Desktop_web_smart_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","UserContextValue","react__WEBPACK_IMPORTED_MODULE_1__","ErrorBoundary","_this","possibleConstructorReturn","getPrototypeOf","hasError","client","ApolloClient","headers","authorization","onError","graphQLErrors","errorMessage","extensions","code","Locale","ErrorBoundary_ErrorBoundary","ApolloProvider","routes","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","onUpdate","onSuccess","catch","ReactDOM","src_App_0","getElementById","URL","process","href","fetch","response","contentType","status","ready","unregister","reload","checkValidServiceWorker","react__WEBPACK_IMPORTED_MODULE_0__"],"mappings":"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","file":"static/js/main.ad402aab.chunk.js","sourcesContent":["import * as React from 'react';\nimport { LocaleProvider as AntdLocaleProvider } from 'antd';\nimport antd_en_US from 'antd/lib/locale-provider/en_US';\nimport antd_zh_CN from 'antd/lib/locale-provider/zh_CN';\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nimport { Locale, locales } from '$assets/locales';\n\nexport const LocaleContext = React.createContext<{\n  locale: Locale;\n  setLocale: React.Dispatch<React.SetStateAction<Locale>>;\n}>({\n  locale:\n    locales[window.localStorage.getItem('locale') || 'en_US'] || locales.en_US,\n  // tslint:disable-next-line\n  setLocale: () => {},\n});\n\nconst otherLocaleMap = {\n  [locales.en_US.locale.key]: {\n    antd: antd_en_US,\n    moment: 'en',\n  },\n  [locales.zh_CN.locale.key]: {\n    antd: antd_zh_CN,\n    moment: 'zh-cn',\n  },\n};\n\ninterface LocaleProviderProps {\n  children: React.ReactNode;\n}\n\nexport const LocaleProvider = React.memo(function LocaleProvider(\n  props: LocaleProviderProps,\n) {\n  const [locale, setLocale] = React.useState(\n    locales[window.localStorage.getItem('locale') || 'en_US'] || locales.en_US,\n  );\n  const [antdLocale, setAntdLocale] = React.useState(antd_en_US);\n  const LocaleContextValue = React.useMemo(() => ({ locale, setLocale }), [\n    locale,\n  ]);\n\n  React.useEffect(() => {\n    const otherLocale = otherLocaleMap[locale.locale.key];\n\n    setAntdLocale(otherLocale.antd as any);\n    moment.locale(otherLocale.moment);\n\n    window.localStorage.setItem('locale', locale.locale.key);\n  }, [locale]);\n\n  return (\n    <LocaleContext.Provider value={LocaleContextValue}>\n      <AntdLocaleProvider locale={antdLocale}>\n        {props.children}\n      </AntdLocaleProvider>\n    </LocaleContext.Provider>\n  );\n});\n","import * as React from 'react';\nimport { NavigateFn } from '@reach/router';\nimport { Layout, Menu, Divider, Dropdown, Button, Icon } from 'antd';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport { UserContext } from '$contexts/User';\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { locales } from '$assets/locales';\n\nimport logo from '$images/logo.png';\n\nimport './index.less';\n\ninterface HomeProps {\n  children: React.ReactNode;\n  path: string;\n  uri?: string;\n  '*'?: string;\n  navigate?: NavigateFn;\n}\n\nconst { Header, Sider, Content } = Layout;\n\nexport default React.memo(function Home(props: HomeProps) {\n  const { setUser } = React.useContext(UserContext);\n  const { locale, setLocale } = React.useContext(LocaleContext);\n  const currentPaths = React.useMemo(() => [`${props.uri}${props['*']}`], [\n    props.uri,\n    props['*'],\n  ]);\n  const localeItems = React.useMemo(\n    () => [\n      {\n        key: locales.en_US.locale.key,\n        value: locales.en_US.locale.value,\n      },\n      {\n        key: locales.zh_CN.locale.key,\n        value: locales.zh_CN.locale.value,\n      },\n    ],\n    [locale],\n  );\n  const siderMenuItems = React.useMemo(\n    () => [\n      {\n        key: AbsoluteRoute.User.Home.Reports,\n        value: locale.user.home.reports.title,\n      },\n      {\n        key: AbsoluteRoute.User.Home.DataSources,\n        value: locale.user.home.dataSources.title,\n      },\n    ],\n    [locale],\n  );\n  const localeDropDown = React.useMemo(\n    () => (\n      <Menu>\n        {localeItems.map(localeItem => (\n          <Menu.Item\n            key={localeItem.key}\n            onClick={React.useCallback(\n              () => setLocale(locales[localeItem.key]),\n              [localeItem.key],\n            )}\n          >\n            {localeItem.value}\n          </Menu.Item>\n        ))}\n      </Menu>\n    ),\n    [localeItems],\n  );\n\n  const signOut = React.useCallback(() => {\n    setUser({ id: '', username: '', token: '', hasSignedIn: false });\n  }, []);\n\n  const changePath = React.useCallback(\n    ({ key }: { key: string }) => props.navigate!(key),\n    [],\n  );\n\n  return (\n    <Layout className=\"page-container\">\n      <Header className=\"user-header\">\n        <img src={logo} alt=\"logo\" className=\"logo\" />\n        <div className=\"right-section\">\n          <Dropdown overlay={localeDropDown} trigger={['click']}>\n            <Button size=\"small\">\n              {locale.locale.value} <Icon type=\"down\" />\n            </Button>\n          </Dropdown>\n          <Divider type=\"vertical\" />\n          <Button size=\"small\" onClick={signOut}>\n            {locale.user.signOut}\n          </Button>\n        </div>\n      </Header>\n      <Layout>\n        <Sider className=\"user-sider\">\n          <Menu selectedKeys={currentPaths} onClick={changePath}>\n            {siderMenuItems.map(siderMenuItem => (\n              <Menu.Item key={siderMenuItem.key}>\n                {siderMenuItem.value}\n              </Menu.Item>\n            ))}\n          </Menu>\n        </Sider>\n        <Content className=\"user-content\">{props.children}</Content>\n      </Layout>\n    </Layout>\n  );\n});\n","import * as React from 'react';\nimport { Spin } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport './index.less';\n\ninterface LoadingProps {\n  children?: React.ReactNode;\n}\n\nexport default React.memo(function Loading(props: LoadingProps) {\n  const { locale } = React.useContext(LocaleContext);\n\n  return <Spin tip={locale.common.loading}>{props.children}</Spin>;\n});\n","import * as React from 'react';\nimport { Query, Mutation, QueryResult, OperationVariables } from 'react-apollo';\nimport { List, Button } from 'antd';\nimport moment from 'moment';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport Loading from '$components/Loading';\nimport Error from '$components/Error';\n\nimport './index.less';\n\ninterface CustomListProps {\n  responseKey: string;\n  itemIcon: React.ReactNode;\n  getListItems: any;\n  removeListItem?: any;\n  listHeader?:\n    | ((queryResult: QueryResult<any, OperationVariables>) => any)\n    | React.ReactNode;\n  handleListItemClick?(id: string): void;\n  itemNameFormatter?(name: string): string;\n}\n\nexport default React.memo(function CustomList(props: CustomListProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const {\n    responseKey,\n    getListItems,\n    handleListItemClick,\n    removeListItem,\n    itemIcon,\n    itemNameFormatter,\n    listHeader,\n  } = props;\n\n  return (\n    <Query query={getListItems}>\n      {queryResult => {\n        const { data, loading, error, refetch } = queryResult;\n\n        if (loading) return <Loading />;\n\n        if (error) return <Error />;\n\n        const dataSource =\n          (data && data[responseKey] && data[responseKey].rows) || [];\n        const header = listHeader\n          ? typeof listHeader === 'function'\n            ? (listHeader as (\n                queryResult: QueryResult<any, OperationVariables>,\n              ) => any)(queryResult)\n            : listHeader\n          : undefined;\n        const listItemStyle = handleListItemClick\n          ? { cursor: 'pointer' }\n          : undefined;\n\n        return (\n          <div className=\"custom-list\">\n            <List\n              header={header}\n              bordered\n              dataSource={dataSource}\n              renderItem={(item: any) => (\n                <List.Item\n                  key={item.id}\n                  className=\"list-item\"\n                  style={listItemStyle}\n                  onClick={\n                    handleListItemClick\n                      ? e => handleListItemClick(item.id)\n                      : undefined\n                  }\n                >\n                  <div className=\"left-section\">\n                    {itemIcon}\n                    <div className=\"list-item-info\">\n                      <span className=\"title\">\n                        {itemNameFormatter\n                          ? itemNameFormatter(item.name)\n                          : item.name}\n                      </span>\n                      <div className=\"detail\">\n                        <span>\n                          {locale.common.createdAt}:{' '}\n                          {moment(item.createdAt).format('lll')}\n                        </span>\n                        <span>\n                          {locale.common.updatedAt}:{' '}\n                          {moment(item.updatedAt).format('lll')}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  {removeListItem && (\n                    <Mutation\n                      mutation={removeListItem}\n                      variables={{ id: item.id }}\n                      onCompleted={refetch}\n                    >\n                      {(removeListItem, { loading }) => (\n                        <Button\n                          type=\"danger\"\n                          shape=\"circle\"\n                          icon=\"delete\"\n                          loading={loading}\n                          onClick={(\n                            e: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n                          ) => {\n                            e.stopPropagation();\n                            removeListItem();\n                          }}\n                        />\n                      )}\n                    </Mutation>\n                  )}\n                </List.Item>\n              )}\n            />\n          </div>\n        );\n      }}\n    </Query>\n  );\n});\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M206.912 960l-128 0 0-149.376 128-102.976L206.912 960zM457.6 656 392.704 580.352 329.6 631.616 329.6 960l128 0L457.6 656zM708.224 605.632l-128 119.36L580.224 960l128 0L708.224 605.632zM958.912 379.968l-128 121.024L830.912 960l128 0L958.912 379.968zM942.912 256c11.328-13.568 9.472-33.728-4.032-45.056-13.568-11.264-33.664-9.472-45.056 4.032l-336 319.168L391.616 370.88 76.8 629.76c-14.144 10.624-17.024 30.656-6.464 44.736 10.688 14.144 30.656 17.024 44.8 6.528l274.304-224.64 169.408 167.68L942.912 256zM1009.344 323.328l0.064-177.024c-0.064-9.344-3.328-17.088-9.472-23.36-6.4-6.272-14.08-9.344-23.232-9.408l-177.152 0.064c-9.28-0.064-17.024 3.2-23.296 9.344C769.92 129.28 766.72 136.96 766.656 146.368c0.064 9.28 3.264 16.96 9.472 23.232l177.088 177.024c6.4 6.4 14.08 9.536 23.232 9.536 9.344-0.064 17.216-3.2 23.36-9.536C1006.08 340.352 1009.344 332.672 1009.344 323.328z\",\n  pId: 2963\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551529198213,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 2962,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/report.4bbbd3a4.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport { NavigateFn } from '@reach/router';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Button, Icon } from 'antd';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport CustomList from '$components/CustomList';\n\nimport { ReactComponent as ReportSvg } from '$assets/icons/report.svg';\n\ninterface ReportsProps {\n  path: string;\n  navigate?: NavigateFn;\n}\n\nconst GET_ALL_REPORTS = gql`\n  query {\n    getAllReports {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n`;\n\nconst ADD_REPORT = gql`\n  mutation {\n    addReport {\n      id\n    }\n  }\n`;\n\nconst REMOVE_REPORT = gql`\n  mutation removeReport($id: ID!) {\n    removeReport(id: $id)\n  }\n`;\n\nconst reportIcon = (\n  <Icon\n    component={ReportSvg as any}\n    style={{ fontSize: 32, color: '#1890ff' }}\n  />\n);\n\nexport default React.memo(function Reports(props: ReportsProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { navigate } = props;\n  const reportsHeader = React.useCallback(\n    ({ refetch }) => (\n      <Mutation\n        mutation={ADD_REPORT}\n        onCompleted={async({ addReport: { id } }) => {\n          await refetch();\n          navigate!(AbsoluteRoute.User.Report.replace(':reportId', id));\n        }}\n      >\n        {(addReport, { loading }) => (\n          <Button\n            type=\"primary\"\n            icon=\"plus\"\n            loading={loading}\n            onClick={addReport as any}\n          >\n            {locale.user.home.reports.addReport}\n          </Button>\n        )}\n      </Mutation>\n    ),\n    [locale],\n  );\n  const handleListItemClick = React.useCallback(\n    (id: string) =>\n      props.navigate!(AbsoluteRoute.User.Report.replace(':reportId', id)),\n    [],\n  );\n  const reportNameFormatter = React.useCallback(\n    (name: string) => name || locale.user.home.reports.unnamedReport,\n    [locale],\n  );\n\n  return (\n    <div>\n      <CustomList\n        responseKey=\"getAllReports\"\n        getListItems={GET_ALL_REPORTS}\n        removeListItem={REMOVE_REPORT}\n        itemIcon={reportIcon}\n        listHeader={reportsHeader}\n        handleListItemClick={handleListItemClick}\n        itemNameFormatter={reportNameFormatter}\n      />\n    </div>\n  );\n});\n","import * as React from 'react';\nimport { ApolloQueryResult } from 'apollo-boost';\nimport { graphql, OperationVariables, MutationFn } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Upload, Button, Icon, message } from 'antd';\nimport { DataSet } from '@antv/data-set';\n\nimport { LocaleContext } from '$contexts/Locale';\n\ninterface UploadDataInputProps {\n  onDataUploaded(\n    variables?: OperationVariables | undefined,\n  ): Promise<ApolloQueryResult<any>>;\n}\n\ninterface Response {\n  data: string;\n}\n\ninterface Variables {\n  name: string;\n  data: string;\n}\n\ninterface UploadDataProps {\n  uploadData: MutationFn<Response, Variables> | undefined;\n}\n\nconst ADD_DATA_SOURCE = gql`\n  mutation addDataSource($name: String!, $data: String!) {\n    addDataSource(name: $name, data: $data) {\n      id\n    }\n  }\n`;\n\nfunction UploadData(props: UploadDataProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { uploadData } = props;\n\n  const beforeUpload = React.useCallback(file => {\n    const fileReader = new FileReader();\n\n    fileReader.readAsText(file);\n    fileReader.onload = function(event: FileReaderEventMap['load']) {\n      if (event.target) {\n        if (file.type === 'application/json') {\n          // 确保上传的 json 文件内容格式正确。\n          try {\n            const data = JSON.stringify(\n              JSON.parse((event.target as any).result),\n            );\n            uploadData &&\n              uploadData({\n                variables: {\n                  name: file.name,\n                  data,\n                },\n              });\n          } catch (error) {\n            message.error(locale.error.fileContentError);\n          }\n        }\n\n        if (file.type === 'text/csv') {\n          const dataView = new DataSet.View()\n            .source((event.target as any).result, {\n              type: 'csv',\n            })\n            // 上传数据类型自动转换，优先级: Number > Text。\n            .transform({\n              type: 'map',\n              callback(row: any) {\n                const result = {};\n\n                for (const key in row) {\n                  const valueToNumber = Number(row[key]);\n\n                  if (!Number.isNaN(valueToNumber)) {\n                    result[key] = valueToNumber;\n                    continue;\n                  }\n\n                  result[key] = row[key];\n                }\n\n                return result;\n              },\n            });\n\n          uploadData &&\n            uploadData({\n              variables: {\n                name: file.name,\n                data: JSON.stringify(dataView.rows),\n              },\n            });\n        }\n      }\n    };\n\n    return false;\n  }, []);\n\n  return (\n    <Upload\n      accept=\".csv,.json\"\n      showUploadList={false}\n      beforeUpload={beforeUpload}\n    >\n      <Button>\n        <Icon type=\"upload\" />\n        {locale.user.home.dataSources.addDataSource}\n      </Button>\n    </Upload>\n  );\n}\n\nexport default React.memo(\n  graphql<UploadDataInputProps, Response, Variables, UploadDataProps>(\n    ADD_DATA_SOURCE,\n    {\n      options: ({ onDataUploaded }) => ({\n        onCompleted: onDataUploaded,\n      }),\n      props: ({ mutate }) => ({\n        uploadData: mutate,\n      }),\n    },\n  )(UploadData),\n);\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M512 42.666667C314.197333 42.666667 101.333333 102.314667 101.333333 233.344l0 557.312C101.333333 921.642667 314.197333 981.333333 512 981.333333c197.802667 0 410.666667-59.690667 410.666667-190.677333L922.666667 233.344C922.666667 102.314667 709.76 42.666667 512 42.666667zM864 790.656c0 72.874667-157.568 132.010667-352 132.010667-194.389333 0-352-59.136-352-132.010667l0-109.610667c60.629333 62.506667 206.762667 94.976 352 94.976 145.194667 0 291.370667-32.469333 352-94.976L864 790.656zM864 614.656l-0.128 0c0 0.256 0.128 0.682667 0.128 0.896 0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072 0-0.256 0.128-0.682667 0.128-0.896L160 614.656l0-109.610667c60.629333 62.421333 206.762667 94.933333 352 94.933333 145.194667 0 291.370667-32.512 352-94.933333L864 614.656zM864 438.656l-0.128 0 0.128 0.896c0 72.405333-157.568 131.072-352 131.072-194.389333 0-352-58.666667-352-131.072l0.128-0.896L160 438.656 160 337.877333C236.885333 396.458667 377.770667 424.021333 512 424.021333c134.229333 0 275.114667-27.562667 352-86.101333L864 438.656zM512 365.312c-194.389333 0-352-59.136-352-132.010667 0-72.917333 157.610667-132.010667 352-132.010667 194.432 0 352 59.050667 352 132.010667C864 306.218667 706.432 365.312 512 365.312zM776.021333 776.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 821.589333 746.666667 805.333333 759.765333 776.021333 776.021333 776.021333zM776.021333 599.978667c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 645.589333 746.666667 629.333333 759.765333 599.978667 776.021333 599.978667zM776.021333 424.021333c16.256 0 29.354667 13.098667 29.354667 29.354667s-13.098667 29.354667-29.354667 29.354667S746.666667 469.546667 746.666667 453.333333 759.765333 424.021333 776.021333 424.021333z\",\n  pId: 2818\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551529026004,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 2817,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/data-source.f24428ad.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport gql from 'graphql-tag';\nimport { Icon } from 'antd';\n\nimport CustomList from '$components/CustomList';\nimport UploadData from '$components/UploadData';\n\nimport { ReactComponent as DataSourceSvg } from '$assets/icons/data-source.svg';\n\ninterface DataSourcesProps {\n  path: string;\n}\n\nconst GET_DATA_SOURCES = gql`\n  query {\n    getDataSources {\n      rows {\n        id\n        createdAt\n        updatedAt\n        name\n      }\n      count\n    }\n  }\n`;\n\nconst REMOVE_DATA_SOURCE = gql`\n  mutation removeDataSource($id: ID!) {\n    removeDataSource(id: $id)\n  }\n`;\n\nconst dataSourceIcon = (\n  <Icon\n    component={DataSourceSvg as any}\n    style={{ fontSize: 32, color: '#1890ff' }}\n  />\n);\n\nconst dataSourcesHeader = ({ refetch }: any) => (\n  <UploadData onDataUploaded={refetch} />\n);\n\nexport default React.memo(function DataSources(props: DataSourcesProps) {\n  return (\n    <div>\n      <CustomList\n        responseKey=\"getDataSources\"\n        getListItems={GET_DATA_SOURCES}\n        removeListItem={REMOVE_DATA_SOURCE}\n        itemIcon={dataSourceIcon}\n        listHeader={dataSourcesHeader}\n      />\n    </div>\n  );\n});\n","import * as React from 'react';\nimport ContentEditable from 'react-contenteditable';\n\nimport './index.less';\n\ninterface TextProps {\n  ref?: React.RefObject<HTMLDivElement>;\n  disabled?: boolean;\n  placeholder?: string;\n  text: string;\n  style?: any;\n  className?: string;\n  onKeyDown?(event: React.KeyboardEvent<HTMLDivElement>): void;\n  onDoubleClick?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onChange?(event: any): void;\n  onBlur?(event: React.FocusEvent<HTMLDivElement>): void;\n}\n\nfunction pasteOnlyText(event: React.ClipboardEvent<HTMLDivElement>) {\n  event.preventDefault();\n  event.stopPropagation();\n  document.execCommand(\n    'insertHTML',\n    false,\n    event.clipboardData.getData('text/plain'),\n  );\n}\n\nfunction TextEditor(props: TextProps, ref: any) {\n  const {\n    disabled,\n    placeholder,\n    text,\n    style,\n    className,\n    onKeyDown,\n    onDoubleClick,\n    onChange,\n    onBlur,\n  } = props;\n\n  return (\n    // @ts-ignore\n    <ContentEditable\n      innerRef={ref}\n      disabled={disabled || false}\n      placeholder={placeholder}\n      spellCheck={false}\n      html={text}\n      style={style}\n      className={`text-editor${className ? ` ${className}` : ''}`}\n      onKeyDown={React.useCallback(\n        (event: React.KeyboardEvent<HTMLDivElement>) => {\n          event.stopPropagation();\n          onKeyDown && onKeyDown(event);\n        },\n        [onKeyDown],\n      )}\n      onClick={React.useCallback(\n        (event: React.MouseEvent<HTMLDivElement, MouseEvent>) =>\n          event.stopPropagation(),\n        [],\n      )}\n      onDoubleClick={React.useCallback(\n        (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n          event.stopPropagation();\n          onDoubleClick && onDoubleClick(event);\n        },\n        [onDoubleClick],\n      )}\n      onChange={onChange}\n      onPaste={pasteOnlyText}\n      onBlur={onBlur}\n    />\n  );\n}\n\nexport default React.memo(React.forwardRef(TextEditor));\n","export default function customMetaKey({\n  ctrlKey,\n  metaKey,\n}: {\n  ctrlKey: boolean;\n  metaKey: boolean;\n}): boolean {\n  const { platform } = window.navigator;\n\n  return (\n    (platform.includes('Win') && ctrlKey) ||\n    (platform.includes('Mac') && metaKey)\n  );\n}\n","import { Canvas } from '@antv/g';\n\nexport default class GController {\n  private _canvas: Canvas;\n  private _canvasContainerSelector = '.report-canvas-container';\n  private _canvasSelector = '#report-canvas';\n\n  public init() {\n    const canvasContainer = document.querySelector(\n      this._canvasContainerSelector,\n    )!;\n    const canvas = document.querySelector(this._canvasSelector)!;\n    const { clientWidth: width, clientHeight: height } = canvasContainer;\n    const { id: containerId } = canvas;\n\n    this._canvas = new Canvas({\n      containerId,\n      width,\n      height,\n    });\n  }\n\n  public destroy() {\n    this._canvas.destroy();\n  }\n}\n","// prettier-ignore\nexport default function bind(target: any, propertyKey: string, descriptor: PropertyDescriptor) {\n  // In IE11 calling Object.defineProperty has a side-effect of evaluating the\n  // getter for the property which is being replaced. This causes infinite\n  // recursion and an \"Out of stack space\" error.\n  let definingProperty = false;\n  const originalFn = descriptor.value;\n\n  return {\n    configurable: true,\n    get() {\n      if (definingProperty) {\n        return originalFn;\n      }\n\n      const value = originalFn.bind(this);\n\n      definingProperty = true;\n      Object.defineProperty(this, propertyKey, {\n        value,\n        configurable: true,\n        writable: true,\n      });\n      definingProperty = false;\n\n      return value;\n    },\n  };\n}\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Line from 'bizcharts/lib/components/TypedGeom/Line';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface LineChartOptions {\n  isXAxisTime?: boolean;\n  isLineSmooth?: boolean;\n}\n\ninterface LineChartProps extends CommonChartProps {\n  options: LineChartOptions;\n}\n\nexport default React.memo(function LineChart(props: LineChartProps) {\n  const { width, height, data, options } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxes = dataKeys.slice(1, dataKeys.length);\n  const yAxisKey = 'yAxisKey';\n  const yAxisValue = 'yAxisValue';\n  const position = `${xAxis}*${yAxisValue}`;\n  const scale = React.useMemo(\n    () => ({\n      [xAxis]: options.isXAxisTime\n        ? {\n            type: 'time',\n            nice: true,\n          }\n        : {\n            nice: true,\n          },\n    }),\n    [options.isXAxisTime],\n  );\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'fold',\n      fields: yAxes,\n      key: yAxisKey,\n      value: yAxisValue,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxisValue} />\n      <Tooltip\n        crosshairs={{\n          type: 'y',\n        }}\n      />\n      <Line\n        position={position}\n        size={2}\n        color={yAxisKey}\n        shape={options.isLineSmooth ? 'smooth' : undefined}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Interval from 'bizcharts/lib/components/TypedGeom/Interval';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface BarChartOptions {}\n\ninterface BarChartProps extends CommonChartProps {\n  options: BarChartOptions;\n}\n\nexport default React.memo(function BarChart(props: BarChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxes = dataKeys.slice(1, dataKeys.length);\n  const yAxisKey = 'yAxisKey';\n  const yAxisValue = 'yAxisValue';\n  const position = `${xAxis}*${yAxisValue}`;\n  const scale = {\n    [xAxis]: {\n      nice: true,\n    },\n  };\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'fold',\n      fields: yAxes,\n      key: yAxisKey,\n      value: yAxisValue,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxisValue} />\n      <Tooltip\n        crosshairs={{\n          type: 'y',\n        }}\n      />\n      <Interval\n        position={position}\n        color={yAxisKey}\n        adjust={[\n          {\n            type: 'dodge',\n            marginRatio: 0,\n          },\n        ]}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Coord from 'bizcharts/lib/components/Coord';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\n// 引入 Geom 会把 bizcharts 和 G2 全部引入，后续留意 G2 按需加载组件的更新。\nimport Geom from 'bizcharts/lib/components/Geom';\nimport Label from 'bizcharts/lib/components/Label';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface PieChartOptions {}\n\ninterface PieChartProps extends CommonChartProps {\n  options: PieChartOptions;\n}\n\nexport default React.memo(function PieChart(props: PieChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const item = dataKeys[0];\n  const count = dataKeys[1];\n  const percent = 'percent';\n  const scale = {\n    percent: {\n      formatter: (val: number) => `${val * 100}%`,\n    },\n  };\n\n  React.useMemo(() => {\n    data.transform({\n      type: 'percent',\n      fields: count,\n      dimension: item,\n      as: percent,\n    });\n  }, [data]);\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Coord type=\"theta\" />\n      <Axis name={percent} />\n      <Legend offsetY={50} clickable={false} />\n      <Geom\n        type=\"intervalStack\"\n        position={percent}\n        color={item}\n        tooltip={[\n          `${item}*${percent}`,\n          (item: string, percent: number) => ({\n            name: item,\n            value: `${percent * 100}%`,\n          }),\n        ]}\n        style={{\n          lineWidth: 1,\n          stroke: '#fff',\n        }}\n      >\n        <Label\n          content={percent}\n          formatter={(val: string, item: any) => `${item.point.item}: ${val}`}\n        />\n      </Geom>\n    </Chart>\n  );\n});\n","import * as React from 'react';\nimport Chart from 'bizcharts/lib/components/Chart';\nimport Legend from 'bizcharts/lib/components/Legend';\nimport Axis from 'bizcharts/lib/components/Axis';\nimport Tooltip from 'bizcharts/lib/components/Tooltip';\nimport Point from 'bizcharts/lib/components/TypedGeom/Point';\n\nimport { CommonChartProps } from '../CommonChartProps';\n\nexport interface ScatterChartOptions {}\n\ninterface ScatterChartProps extends CommonChartProps {\n  options: ScatterChartOptions;\n}\n\nexport default React.memo(function ScatterChart(props: ScatterChartProps) {\n  const { width, height, data } = props;\n\n  const dataKeys = Object.keys(data.rows[0]);\n  const xAxis = dataKeys[0];\n  const yAxis = dataKeys[1];\n  const point = dataKeys.slice(2, dataKeys.length).join(' ');\n  const position = `${xAxis}*${yAxis}`;\n  const scale = {\n    [xAxis]: {\n      nice: true,\n    },\n  };\n\n  return (\n    <Chart width={width} height={height} data={data} scale={scale}>\n      <Legend />\n      <Axis name={xAxis} />\n      <Axis name={yAxis} />\n      <Tooltip\n        crosshairs={{\n          type: 'cross',\n        }}\n      />\n      <Point\n        position={position}\n        opacity={0.65}\n        shape=\"circle\"\n        size={3}\n        color={point}\n      />\n    </Chart>\n  );\n});\n","import * as React from 'react';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport TextEditor from '$components/TextEditor';\n\ninterface TextProps {\n  text: string;\n  onChange?(event: any): void;\n}\n\nfunction placeCaretAtEnd(el: HTMLElement) {\n  el.focus();\n\n  if (\n    typeof window.getSelection != 'undefined' &&\n    typeof document.createRange != 'undefined'\n  ) {\n    const range = document.createRange();\n\n    range.selectNodeContents(el);\n    range.collapse(false);\n\n    const selection = window.getSelection();\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n  } else if (typeof (document.body as any).createTextRange != 'undefined') {\n    const textRange = (document.body as any).createTextRange();\n\n    textRange.moveToElementText(el);\n    textRange.collapse(false);\n    textRange.select();\n  }\n}\n\nexport default React.memo(function Text(props: TextProps) {\n  const { text, onChange } = props;\n  const { locale } = React.useContext(LocaleContext);\n  const [contentEditable, setContentEditable] = React.useState(false);\n  const editorRef = React.useRef<HTMLDivElement>(null);\n\n  React.useEffect(() => {\n    if (contentEditable) {\n      editorRef.current && placeCaretAtEnd(editorRef.current);\n    }\n  }, [contentEditable]);\n\n  return (\n    <TextEditor\n      ref={editorRef}\n      disabled={!contentEditable}\n      placeholder={locale.user.report.textEmptyTips}\n      text={text}\n      style={contentEditable ? { cursor: 'text' } : undefined}\n      onDoubleClick={React.useCallback(() => setContentEditable(true), [])}\n      onChange={onChange}\n      onBlur={React.useCallback(() => setContentEditable(false), [])}\n    />\n  );\n});\n","import * as React from 'react';\nimport { Empty } from 'antd';\n\nimport LineChart, { LineChartOptions } from '$components/Charts/LineChart';\nimport BarChart, { BarChartOptions } from '$components/Charts/BarChart';\nimport PieChart, { PieChartOptions } from '$components/Charts/PieChart';\nimport ScatterChart, {\n  ScatterChartOptions,\n} from '$components/Charts/ScatterChart';\n\nimport Text from './Text';\n\nimport './index.less';\n\nexport enum ReportElType {\n  Chart = 'chart',\n  Text = 'text',\n}\n\nexport enum ReportChartType {\n  LineChart = 'lineChart',\n  BarChart = 'barChart',\n  PieChart = 'pieChart',\n  ScatterChart = 'scatterChart',\n}\n\ninterface ReportCommonEl {\n  id: string;\n  type: ReportElType;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  selected: boolean;\n  editing: boolean;\n}\n\nexport interface ReportChartDataSource {\n  id: string;\n  data: any;\n}\n\nexport type ReportChartOptions =\n  | LineChartOptions\n  | BarChartOptions\n  | PieChartOptions\n  | ScatterChartOptions;\n\ninterface ReportChart extends ReportCommonEl {\n  type: ReportElType.Chart;\n  chartType: ReportChartType;\n  dataSource: ReportChartDataSource;\n  options: ReportChartOptions;\n}\n\ninterface ReportText extends ReportCommonEl {\n  type: ReportElType.Text;\n  text: string;\n}\n\nexport type ReportEl = ReportChart | ReportText;\n\ntype ReportElementProps = ReportEl & {\n  onMouseDown?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onMouseUp?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n  onInputText?(event: any): void;\n  onMouseMove?(event: React.MouseEvent<HTMLDivElement, MouseEvent>): void;\n};\n\n// 与 './index.less' 中的 @report-element-selected-border-width 保持同步。\nconst reportElSelectedBorderWidth = 2;\n\nexport default React.memo(function ReportElement(props: ReportElementProps) {\n  const {\n    id,\n    type,\n    x,\n    y,\n    width,\n    height,\n    selected,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp,\n    onInputText,\n  } = props;\n\n  return (\n    <div\n      style={{\n        width: width + reportElSelectedBorderWidth * 2,\n        height:\n          height +\n          (type === ReportElType.Chart ? 6 : 0) +\n          reportElSelectedBorderWidth * 2,\n        transform: `translate(${x}px, ${y}px)`,\n      }}\n      className={`report-element${selected ? ' report-element-selected' : ''}`}\n      id={id}\n      data-x={x}\n      data-y={y}\n      onMouseMove={onMouseMove}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}\n    >\n      {(() => {\n        switch (props.type) {\n          case ReportElType.Chart:\n            if (\n              !props.dataSource ||\n              !props.dataSource.id ||\n              !props.dataSource.data.rows ||\n              props.dataSource.data.rows.length === 0\n            ) {\n              return <Empty style={{ height: '100%' }} />;\n            }\n\n            const chartProps = {\n              width,\n              height,\n              data: props.dataSource.data,\n              options: props.options,\n            };\n\n            switch (props.chartType) {\n              case ReportChartType.LineChart:\n                return <LineChart {...chartProps} />;\n              case ReportChartType.BarChart:\n                return <BarChart {...chartProps} />;\n              case ReportChartType.PieChart:\n                return <PieChart {...chartProps} />;\n              case ReportChartType.ScatterChart:\n                return <ScatterChart {...chartProps} />;\n              default:\n                // prettier-ignore\n                throw new Error(`Invalid reportEl chartType ${props.chartType}.`);\n            }\n          case ReportElType.Text:\n            return <Text text={props.text} onChange={onInputText} />;\n          default:\n            // prettier-ignore\n            throw new Error(`Invalid reportEl type ${(props as any).type}.`);\n        }\n      })()}\n    </div>\n  );\n});\n","import DataSet from '@antv/data-set';\n\nimport {\n  ReportEl,\n  ReportElType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from './index';\n\nexport enum ReportElsActionType {\n  Add = 'add',\n  Delete = 'delete',\n  Move = 'move',\n  Resize = 'resize',\n  StartEdit = 'startEdit',\n  Select = 'select',\n  Unselect = 'unselect',\n  InputText = 'inputText',\n  SetChartDataSource = 'setChartsDataSource',\n  SetChartOptions = 'setChartsOptions',\n  Undo = 'undo',\n  Redo = 'redo',\n}\n\ninterface ReportElsCommonAction {\n  type: ReportElsActionType;\n  payload?: any;\n  disallowUndo?: boolean;\n}\n\ninterface ReportElsAddAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Add;\n  payload: ReportEl[];\n}\n\ninterface ReportElsDeleteAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Delete;\n  payload: string[];\n}\n\ninterface ReportElsMoveAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Move;\n  payload: {\n    id: string;\n    x: number;\n    y: number;\n  }[];\n}\n\ninterface ReportElsResizeAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Resize;\n  payload: {\n    id: string;\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }[];\n}\n\ninterface ReportElsStartEditAction extends ReportElsCommonAction {\n  type: ReportElsActionType.StartEdit;\n  payload: string;\n  disallowUndo: true;\n}\ninterface ReportElsSelectAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Select;\n  payload: string[];\n  disallowUndo: true;\n}\n\ninterface ReportElsUnselectAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Unselect;\n  payload: string[];\n  disallowUndo: true;\n}\n\ninterface InputTextAction extends ReportElsCommonAction {\n  type: ReportElsActionType.InputText;\n  payload: { id: string; text: string };\n}\ninterface SetChartDataSourceAction extends ReportElsCommonAction {\n  type: ReportElsActionType.SetChartDataSource;\n  payload: { id: string; dataSource: ReportChartDataSource };\n}\ninterface SetChartOptionsAction extends ReportElsCommonAction {\n  type: ReportElsActionType.SetChartOptions;\n  payload: { id: string; options: ReportChartOptions };\n}\n\ninterface ReportElsUndoAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Undo;\n  disallowUndo: true;\n}\n\ninterface ReportElsRedoAction extends ReportElsCommonAction {\n  type: ReportElsActionType.Redo;\n  disallowUndo: true;\n}\n\nexport type ReportElsAction =\n  | ReportElsAddAction\n  | ReportElsDeleteAction\n  | ReportElsMoveAction\n  | ReportElsResizeAction\n  | ReportElsStartEditAction\n  | ReportElsSelectAction\n  | ReportElsUnselectAction\n  | InputTextAction\n  | SetChartDataSourceAction\n  | SetChartOptionsAction\n  | ReportElsUndoAction\n  | ReportElsRedoAction;\n\ninterface ReportEls {\n  undoStack: ReportElsAction[];\n  redoStack: ReportElsAction[];\n  state: ReportEl[];\n}\n\nconst undoStackMaxLength = 10000;\n\nexport default function reportElsReducer(\n  reportEls: ReportEls,\n  action: ReportElsAction,\n): ReportEls {\n  const { undoStack, redoStack } = reportEls;\n  const originalActionType = action.type;\n  let newUndoStack: ReportElsAction[] = [];\n  let newRedoStack: ReportElsAction[] = [];\n\n  switch (action.type) {\n    case ReportElsActionType.Undo:\n      if (undoStack.length > 0) {\n        action = undoStack[undoStack.length - 1];\n        newUndoStack = undoStack.slice(0, undoStack.length - 1);\n      } else {\n        return reportEls;\n      }\n      break;\n    case ReportElsActionType.Redo:\n      if (redoStack.length > 0) {\n        action = redoStack[redoStack.length - 1];\n        newRedoStack = redoStack.slice(0, redoStack.length - 1);\n      } else {\n        return reportEls;\n      }\n      break;\n    default:\n      break;\n  }\n\n  // 不执行无用的 action 。\n  if (action.payload.length === 0) return reportEls;\n\n  let reverseAction: ReportElsAction | null = null;\n  let newReportElsState: ReportEl[];\n\n  switch (action.type) {\n    case ReportElsActionType.Add:\n      reverseAction = {\n        type: ReportElsActionType.Delete,\n        payload: action.payload.map(\n          reportElWillRemove => reportElWillRemove.id,\n        ),\n      };\n\n      newReportElsState = reportEls.state\n        .map(reportEl => ({\n          ...reportEl,\n          selected: false,\n          editing: false,\n        }))\n        .concat(\n          action.payload.map(reportElWillAdd =>\n            reportElWillAdd.type === ReportElType.Chart\n              ? {\n                  ...reportElWillAdd,\n                  dataSource: {\n                    ...reportElWillAdd.dataSource,\n                    data: new DataSet.View().source(\n                      reportElWillAdd.dataSource.data,\n                    ),\n                  },\n                }\n              : reportElWillAdd,\n          ),\n        );\n      break;\n    case ReportElsActionType.Delete:\n      reverseAction = {\n        type: ReportElsActionType.Add,\n        payload: reportEls.state\n          .filter(reportEl => action.payload.indexOf(reportEl.id) !== -1)\n          .map(reportElWillAdd =>\n            reportElWillAdd.type === ReportElType.Chart\n              ? {\n                  ...reportElWillAdd,\n                  dataSource: {\n                    ...reportElWillAdd.dataSource,\n                    data: reportElWillAdd.dataSource.data.origin,\n                  },\n                }\n              : reportElWillAdd,\n          ),\n      };\n\n      newReportElsState = reportEls.state.filter(\n        reportEl => action.payload.indexOf(reportEl.id) === -1,\n      );\n      break;\n    case ReportElsActionType.Move:\n      reverseAction = {\n        type: ReportElsActionType.Move,\n        payload: reportEls.state\n          .filter(reportEl =>\n            (action.payload as ReportElsMoveAction['payload']).some(\n              reportElMoved => reportElMoved.id === reportEl.id,\n            ),\n          )\n          .map(reportElWillMove => {\n            const { id, x, y } = reportElWillMove;\n\n            return { id, x, y };\n          }),\n      };\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        for (const reportElMoved of action.payload as ReportElsMoveAction['payload']) {\n          if (reportEl.id === reportElMoved.id) {\n            const { x, y } = reportElMoved;\n            const { width, height } = reportEl;\n            const { clientWidth, clientHeight } = document.querySelector(\n              '.report-canvas-container',\n            )!;\n\n            return {\n              ...reportEl,\n              // 2 * 2 中的第一个 2 是 reportEl 的边框宽度。\n              x: Math.max(Math.min(x, clientWidth - width - 2 * 2), 0),\n              y: Math.max(Math.min(y, clientHeight - height - 2 * 2), 0),\n            };\n          }\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.Resize:\n      reverseAction = {\n        type: ReportElsActionType.Resize,\n        payload: reportEls.state\n          .filter(reportEl =>\n            (action.payload as ReportElsResizeAction['payload']).some(\n              reportElResized => reportElResized.id === reportEl.id,\n            ),\n          )\n          .map(reportElWillResize => {\n            const { id, x, y, width, height } = reportElWillResize;\n\n            return { id, x, y, width, height };\n          }),\n      };\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        for (const reportElResized of action.payload as ReportElsResizeAction['payload']) {\n          if (reportEl.id === reportElResized.id) {\n            const { x, y, width, height } = reportElResized;\n            const { clientWidth, clientHeight } = document.querySelector(\n              '.report-canvas-container',\n            )!;\n\n            return {\n              ...reportEl,\n              // 2 * 2 中的第一个 2 是 reportEl 的边框宽度。\n              x: Math.max(Math.min(x, clientWidth - width - 2 * 2), 0),\n              y: Math.max(Math.min(y, clientHeight - height - 2 * 2), 0),\n              width,\n              height,\n            };\n          }\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.StartEdit:\n      newReportElsState = reportEls.state.map(reportEl =>\n        reportEl.id === action.payload\n          ? {\n              ...reportEl,\n              selected: true,\n              editing: true,\n            }\n          : {\n              ...reportEl,\n              editing: false,\n            },\n      );\n      break;\n    case ReportElsActionType.Select:\n      newReportElsState = reportEls.state.map(reportEl =>\n        (action.payload as ReportElsSelectAction['payload']).some(\n          reportElSelectedId => reportEl.id === reportElSelectedId,\n        )\n          ? {\n              ...reportEl,\n              selected: true,\n            }\n          : reportEl,\n      );\n      break;\n    case ReportElsActionType.Unselect:\n      newReportElsState = reportEls.state.map(reportEl =>\n        (action.payload as ReportElsSelectAction['payload']).some(\n          reportElSelectedId => reportEl.id === reportElSelectedId,\n        )\n          ? {\n              ...reportEl,\n              selected: false,\n              editing: false,\n            }\n          : reportEl,\n      );\n      break;\n    case ReportElsActionType.InputText:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Text\n        ) {\n          const { id, text } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.InputText,\n            payload: { id, text },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Text\n        ) {\n          return {\n            ...reportEl,\n            text: action.payload.text,\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.SetChartDataSource:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          const { id, dataSource } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.SetChartDataSource,\n            payload: { id, dataSource },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          return {\n            ...reportEl,\n            dataSource: {\n              ...action.payload.dataSource,\n              data: new DataSet.View().source(action.payload.dataSource.data),\n            },\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    case ReportElsActionType.SetChartOptions:\n      for (const reportEl of reportEls.state) {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          const { id, options } = reportEl;\n          reverseAction = {\n            type: ReportElsActionType.SetChartOptions,\n            payload: { id, options },\n          };\n        }\n      }\n\n      newReportElsState = reportEls.state.map(reportEl => {\n        if (\n          reportEl.id === action.payload.id &&\n          reportEl.type === ReportElType.Chart\n        ) {\n          return {\n            ...reportEl,\n            options: action.payload.options,\n          };\n        }\n\n        return reportEl;\n      });\n      break;\n    default:\n      throw new Error(`Unexcepted action type ${action.type}`);\n  }\n\n  if (!reverseAction || action.disallowUndo) {\n    return {\n      ...reportEls,\n      state: newReportElsState,\n    };\n  }\n\n  if (originalActionType === ReportElsActionType.Undo) {\n    newRedoStack = redoStack.concat(reverseAction);\n  } else {\n    if (originalActionType !== ReportElsActionType.Redo) {\n      newRedoStack = [];\n    }\n\n    newUndoStack =\n      undoStack.length === undoStackMaxLength\n        ? undoStack.slice(1, undoStack.length).concat(reverseAction)\n        : undoStack.concat(reverseAction);\n  }\n\n  return {\n    undoStack: newUndoStack,\n    redoStack: newRedoStack,\n    state: newReportElsState,\n  };\n}\n","import interact from 'interactjs';\n\nimport bind from '$decorators/bind';\n\nimport {\n  ReportElsAction,\n  ReportElsActionType,\n} from '../widgets/ReportElement/reducer';\n\ninterface InteractControllerProps {\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n}\n\ninterface ResizableOptions extends interact.ResizableOptions {\n  restrictEdges: any;\n  restrictSize: any;\n}\n\nexport default class InteractController {\n  private _props: InteractControllerProps;\n  private _selector = '.report-editor .report-element';\n\n  public constructor(props: InteractControllerProps) {\n    this._props = props;\n\n    const draggableOptions: interact.DraggableOptions = {\n      onmove: this._onDragMove,\n      restrict: {\n        restriction: 'parent',\n        elementRect: { top: 0, left: 0, bottom: 1, right: 1 },\n      },\n    };\n    const resizableOptions: ResizableOptions = {\n      onmove: this._onResizeMove,\n      edges: { left: true, right: true, bottom: true, top: true },\n      restrictEdges: {\n        outer: 'parent',\n      },\n      restrictSize: {\n        min: { width: 150, height: 150 },\n      },\n    };\n\n    interact(this._selector)\n      .draggable(draggableOptions)\n      .resizable(resizableOptions);\n  }\n\n  public destroy() {\n    (interact(this._selector) as any).unset();\n  }\n\n  @bind\n  private _onDragMove(event: interact.InteractEvent) {\n    const { target, dx, dy } = event;\n\n    const x = Number(target.getAttribute('data-x')) + dx;\n    const y = Number(target.getAttribute('data-y')) + dy;\n\n    if (Number.isNaN(x) || Number.isNaN(y)) {\n      return;\n    }\n\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Move,\n      payload: [\n        {\n          id: target.id,\n          x,\n          y,\n        },\n      ],\n    });\n  }\n\n  @bind\n  private _onResizeMove(event: interact.InteractEvent) {\n    const { target, deltaRect, rect } = event as any;\n\n    const x = Number(target.dataset.x) + deltaRect.left;\n    const y = Number(target.dataset.y) + deltaRect.top;\n\n    if (Number.isNaN(x) || Number.isNaN(y)) {\n      return;\n    }\n\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Resize,\n      payload: [\n        {\n          id: target.id,\n          x,\n          y,\n          width: rect.width,\n          height: rect.height,\n        },\n      ],\n    });\n  }\n}\n","import bind from '$decorators/bind';\n\nimport { ReportEl } from '../widgets/ReportElement';\nimport {\n  ReportElsActionType,\n  ReportElsAction,\n} from '../widgets/ReportElement/reducer';\nimport customMetaKey from '$utils/customMetaKEey';\n\ninterface ShortCutsControllerProps {\n  reportElsState: ReportEl[];\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n  onSave(reportELs: ReportEl[]): void;\n}\n\nexport default class ShortCutsController {\n  private _props: ShortCutsControllerProps;\n  private _preventDelete = false;\n\n  public constructor(props: ShortCutsControllerProps) {\n    this._props = props;\n    window.addEventListener('keydown', this._onKeydown);\n    window.addEventListener('keyup', this._onKeyup);\n  }\n\n  public update(partialProps: Partial<ShortCutsControllerProps>) {\n    this._props = {\n      ...this._props,\n      ...partialProps,\n    };\n  }\n\n  public destroy() {\n    window.removeEventListener('keydown', this._onKeydown);\n    window.removeEventListener('keyup', this._onKeyup);\n  }\n\n  @bind\n  public _onInputText(id: string, text: string) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.InputText,\n      payload: { id, text },\n    });\n  }\n\n  @bind\n  private _onKeydown(event: KeyboardEvent) {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    switch (event.keyCode) {\n      // delete\n      case 8:\n        if (this._preventDelete) {\n          return;\n        }\n\n        this._preventDelete = true;\n\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Delete,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(selectedReportEl => selectedReportEl.id),\n        });\n        break;\n      // 左\n      case 37:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x + (event.shiftKey ? -1 : -10),\n              y: reportElSelected.y,\n            })),\n        });\n        break;\n      // 上\n      case 38:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x,\n              y: reportElSelected.y + (event.shiftKey ? -1 : -10),\n            })),\n        });\n        break;\n      // 右\n      case 39:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x + (event.shiftKey ? 1 : 10),\n              y: reportElSelected.y,\n            })),\n        });\n        break;\n      // 下\n      case 40:\n        event.preventDefault();\n        reportElsDispatch({\n          type: ReportElsActionType.Move,\n          payload: reportElsState\n            .filter(reportEl => reportEl.selected)\n            .map(reportElSelected => ({\n              id: reportElSelected.id,\n              x: reportElSelected.x,\n              y: reportElSelected.y + (event.shiftKey ? 1 : 10),\n            })),\n        });\n        break;\n      // A\n      case 65:\n        // ctrl(command) + shift + A / ctrl(command) + A: 全选\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          event.shiftKey\n            ? reportElsDispatch({\n                type: ReportElsActionType.Unselect,\n                payload: reportElsState.map(reportEl => reportEl.id),\n                disallowUndo: true,\n              })\n            : reportElsDispatch({\n                type: ReportElsActionType.Select,\n                payload: reportElsState.map(reportEl => reportEl.id),\n                disallowUndo: true,\n              });\n        }\n        break;\n      // S\n      case 83:\n        // ctrl(command) + S: 保存\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          this._props.onSave(reportElsState);\n        }\n        break;\n      // Y\n      case 89:\n        // ctrl(command) + Y: redo\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          reportElsDispatch({\n            type: ReportElsActionType.Redo,\n            disallowUndo: true,\n          });\n        }\n        break;\n      // Z\n      case 90:\n        // ctrl(command) + shift + Z / ctrl(command) + Z: redo / undo\n        if (customMetaKey({ ctrlKey: event.ctrlKey, metaKey: event.metaKey })) {\n          event.preventDefault();\n          event.shiftKey\n            ? reportElsDispatch({\n                type: ReportElsActionType.Redo,\n                disallowUndo: true,\n              })\n            : reportElsDispatch({\n                type: ReportElsActionType.Undo,\n                disallowUndo: true,\n              });\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  @bind\n  private _onKeyup(event: KeyboardEvent) {\n    this._preventDelete = false;\n  }\n}\n","import * as React from 'react';\n\nimport bind from '$decorators/bind';\n\nimport {\n  ReportEl,\n  ReportElType,\n  ReportChartType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from '../widgets/ReportElement';\nimport {\n  ReportElsActionType,\n  ReportElsAction,\n} from '../widgets/ReportElement/reducer';\n\ninterface MouseControllerProps {\n  reportElsState: ReportEl[];\n  reportElsDispatch: React.Dispatch<ReportElsAction>;\n}\n\ninterface CanvasContainer {\n  mouseDownPosition: { x: number; y: number };\n}\n\nexport default class MouseController {\n  private _props: MouseControllerProps;\n  private _canvasContainer: CanvasContainer = {\n    mouseDownPosition: { x: 0, y: 0 },\n  };\n\n  public constructor(props: MouseControllerProps) {\n    this._props = props;\n  }\n\n  public update(partialProps: Partial<MouseControllerProps>) {\n    this._props = {\n      ...this._props,\n      ...partialProps,\n    };\n  }\n\n  public destroy() {}\n\n  /** Toolbar */\n  /**\n   * 点击 redo 按钮。\n   */\n  @bind\n  public onRedoBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Redo,\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击 undo 按钮。\n   */\n  @bind\n  public onUndoBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Undo,\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击全选按钮。\n   */\n  @bind\n  public onSelectAllBtnClick() {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    reportElsDispatch({\n      type: ReportElsActionType.Select,\n      payload: reportElsState.map(reportEl => reportEl.id),\n      disallowUndo: true,\n    });\n  }\n\n  /**\n   * 点击删除按钮。\n   */\n  @bind\n  public onDeleteSelectedBtnClick() {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    reportElsDispatch({\n      type: ReportElsActionType.Delete,\n      payload: reportElsState\n        .filter(reportEl => reportEl.selected)\n        .map(reportElToDelete => reportElToDelete.id),\n    });\n  }\n\n  /**\n   * 点击添加文本按钮。\n   */\n  @bind\n  public onAddTextBtnClick() {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [\n        {\n          // TODO: 此处 id 生成方法待更改。\n          id: `_${Math.random()\n            .toString(36)\n            .substr(2, 9)}${Math.random()\n            .toString(36)\n            .substr(2, 9)}`,\n          type: ReportElType.Text,\n          width: 400,\n          height: 160,\n          x: 600,\n          y: 200,\n          text: '',\n          selected: true,\n          editing: true,\n        },\n      ],\n    });\n  }\n\n  /**\n   * 点击 chart 列表项添加 chart。\n   */\n  @bind\n  public onChartListItemClick(chartType: ReportChartType) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [\n        {\n          // TODO: 此处 id 生成方法待更改。\n          id: `_${Math.random()\n            .toString(36)\n            .substr(2, 9)}${Math.random()\n            .toString(36)\n            .substr(2, 9)}`,\n          type: ReportElType.Chart,\n          chartType,\n          width: 400,\n          height: 300,\n          x: 600,\n          y: 200,\n          dataSource: {\n            id: '',\n            data: [],\n          },\n          selected: true,\n          editing: true,\n          options: {},\n        },\n      ],\n    });\n  }\n\n  /** Report Editor */\n  /**\n   * 点击 canvas container 未移动 unselect 所有元素，点击 report elements 不触发:\n   *  - onCanvasContainerMouseDown\n   *  - unselectAllReportEls\n   *  - preventUnselectAllReportEls\n   */\n  // prettier-ignore\n  @bind\n  public onCanvasContainerMouseDown(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    this._canvasContainer.mouseDownPosition = { x: event.clientX, y: event.clientY };\n  }\n\n  // prettier-ignore\n  @bind\n  public onCanvasContainerMouseUp(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    const { x, y } = this._canvasContainer.mouseDownPosition;\n    const { clientX, clientY } = event;\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    x === clientX && y === clientY && reportElsDispatch({\n      type: ReportElsActionType.Unselect,\n      payload: reportElsState.map(reportEl => reportEl.id),\n      disallowUndo: true,\n    });\n  }\n\n  /** Report Element */\n  // prettier-ignore\n  public onReportElMouseUp(event: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n    event.stopPropagation();\n  }\n\n  /**  鼠标按下选中 report elment。 */\n  // prettier-ignore\n  @bind\n  public onReportElMouseDown(reportElId: string, unselectOthers: boolean) {\n    const { reportElsState, reportElsDispatch } = this._props;\n\n    if (unselectOthers) {\n      reportElsDispatch({\n        type: ReportElsActionType.Unselect,\n        payload: reportElsState.map(reportEl => reportEl.id),\n        disallowUndo: true,\n      });\n    }\n\n    reportElsDispatch({\n      type: ReportElsActionType.StartEdit,\n      payload: reportElId,\n      disallowUndo: true,\n    });\n  }\n\n  /**  修复 bizcharts 的 canvas 的 cursor 总是为 default 的 bug：鼠标悬浮在 report elements 上时设置 cursor。 */\n  public onReportElMouseMove(\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n  ) {\n    const canvas: HTMLCanvasElement | null = document.querySelector(\n      `#${event.currentTarget.id} canvas`,\n    );\n    const html = document.querySelector('html');\n    if (canvas && html) {\n      canvas.style.cursor = html.style.cursor || 'auto';\n    }\n  }\n\n  /** Report Editor */\n  /** 设置图表的数据源 */\n  @bind\n  public onChartDataSourceSelect(\n    id: string,\n    dataSource: ReportChartDataSource,\n  ) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.SetChartDataSource,\n      payload: { id, dataSource },\n    });\n  }\n\n  /** 设置图表的选项 */\n  @bind\n  public onChartOptionsChange(id: string, options: ReportChartOptions) {\n    this._props.reportElsDispatch({\n      type: ReportElsActionType.SetChartOptions,\n      payload: { id, options },\n    });\n  }\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M524.8 362.66666667c-110.933333 0-209.066667 42.666667-285.866667 110.933333L85.333333 319.99999967v384h375.466667l-149.333333-153.6c59.733333-51.2 132.266667-81.066667 213.333333-81.066666 149.333333 0 273.066667 98.133333 315.733333 234.666666l98.133334-34.133333C878.933333 490.66666667 716.8 362.66666667 524.8 362.66666667z\",\n  pId: 1119\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551597541207,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 1118,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/undo.da78c3f7.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M786.005333 473.34400033l152.021333-153.984 0 384-384 0 155.989333-153.984q-96-80-219.989333-80-112 0-201.002667 64.981333t-123.008 169.002667l-100.010667-32q43.989333-136.021333 160.981333-221.994667t262.997333-86.016q169.984 0 296.021333 109.994667z\",\n  pId: 1349\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551597561334,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 1348,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/redo.f03087f9.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M866.7136 792.6784H227.566933l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934h-47.445333a18.670933 18.670933 0 0 0-18.944 18.6368l-0.2048 628.053334v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H866.7136a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z\",\n  pId: 9310\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M724.48 934.912H85.367467l0.2048-585.352533a18.432 18.432 0 0 0-18.944-18.670934H19.182933a18.670933 18.670933 0 0 0-18.944 18.6368L0 977.578667v24.337066c0 10.1376 8.226133 18.363733 18.3296 18.363734H724.48a18.466133 18.466133 0 0 0 18.7392-18.944v-47.445334a18.5344 18.5344 0 0 0-18.7392-18.978133z\",\n  pId: 9311\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1005.704533 3.754667H302.728533a18.397867 18.397867 0 0 0-18.295466 18.295466v703.010134c0 9.966933 8.192 18.295467 18.295466 18.295466h703.010134c9.966933 0 18.295467-8.192 18.295466-18.295466V22.016a18.432 18.432 0 0 0-18.3296-18.261333zM938.666667 657.988267H369.7664V89.088H938.666667v568.900267z\",\n  pId: 9312\n});\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M570.0608 505.002667l16.4864 16.4864c7.543467 7.543467 19.490133 7.850667 27.3408 0l16.4864-16.4864 236.885333-236.885334a18.6368 18.6368 0 0 0 0.068267-26.862933l-33.553067-33.553067a19.114667 19.114667 0 0 0-26.862933 0.068267l-206.711467 206.711467-72.977066-72.977067a18.568533 18.568533 0 0 0-26.760534 0.034133l-33.553066 33.553067a19.182933 19.182933 0 0 0-0.034134 26.760533l103.185067 103.150934z\",\n  pId: 9313\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551599533521,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 9309,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2, _ref3, _ref4, _ref5);\n};\n\nexport default __webpack_public_path__ + \"static/media/select-all.0788b671.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"defs\", null);\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M843.294118 120.470588l0 180.705882-60.235294 0 0-120.470588-240.941176 0 0 722.823529 98.966588 0 0 60.235294-258.168471 0 0-60.235294 98.966588 0 0-722.823529-240.941176 0 0 120.470588-60.235294 0 0-180.705882 662.588235 0z\",\n  pId: 9078\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    t: 1551599120489,\n    className: \"icon\",\n    style: {},\n    viewBox: \"0 0 1024 1024\",\n    version: 1.1,\n    pId: 9077,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/text.596f1788.svg\";\nexport { SvgComponent as ReactComponent };","import * as React from 'react';\nimport { Layout, Tooltip, Icon, Button, Divider, Menu, Dropdown } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { ReactComponent as UndoSvg } from '$assets/icons/undo.svg';\nimport { ReactComponent as RedoSvg } from '$assets/icons/redo.svg';\nimport { ReactComponent as SelectAllSvg } from '$assets/icons/select-all.svg';\nimport { ReactComponent as TextSvg } from '$assets/icons/text.svg';\n\nimport { ReportChartType } from '../ReportElement';\n\nimport './index.less';\n\ninterface ToolbarProps {\n  disableUndo: boolean;\n  disableRedo: boolean;\n  disableDelete: boolean;\n  onUndoBtnClick(event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void;\n  onRedoBtnClick(event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void;\n  onSelectAllBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n  onChartListItemClick(chartType: ReportChartType): void;\n  onAddTextBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n  onDeleteSelectedBtnClick(\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ): void;\n}\n\nconst { Header } = Layout;\n\nexport default React.memo(function Toolbar(props: ToolbarProps) {\n  const {\n    disableUndo,\n    disableRedo,\n    disableDelete,\n    onUndoBtnClick,\n    onRedoBtnClick,\n    onSelectAllBtnClick,\n    onChartListItemClick,\n    onAddTextBtnClick,\n    onDeleteSelectedBtnClick,\n  } = props;\n  const { locale } = React.useContext(LocaleContext);\n\n  const reportChartTypeItems = [\n    {\n      key: ReportChartType.LineChart,\n      value: locale.user.report.lineChart,\n    },\n    {\n      key: ReportChartType.BarChart,\n      value: locale.user.report.barChart,\n    },\n    {\n      key: ReportChartType.PieChart,\n      value: locale.user.report.pieChart,\n    },\n    {\n      key: ReportChartType.ScatterChart,\n      value: locale.user.report.scatterChart,\n    },\n  ];\n  const addChartTypeMenu = (\n    <Menu>\n      {reportChartTypeItems.map(reportChartTypeItem => (\n        <Menu.Item\n          key={reportChartTypeItem.key}\n          onClick={React.useCallback(\n            () => onChartListItemClick(reportChartTypeItem.key),\n            [reportChartTypeItem.key],\n          )}\n        >\n          {reportChartTypeItem.value}\n        </Menu.Item>\n      ))}\n    </Menu>\n  );\n\n  return (\n    <Header className=\"toolbar\">\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.undo} placement=\"bottom\">\n          <Button disabled={disableUndo} onClick={onUndoBtnClick}>\n            <Icon component={UndoSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.redo} placement=\"bottom\">\n          <Button disabled={disableRedo} onClick={onRedoBtnClick}>\n            <Icon component={RedoSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.selectAll} placement=\"bottom\">\n          <Button onClick={onSelectAllBtnClick}>\n            <Icon component={SelectAllSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Dropdown overlay={addChartTypeMenu} trigger={['click']}>\n          <Button>\n            <Icon type=\"bar-chart\" /> {locale.user.report.chart}{' '}\n            <Icon type=\"down\" />\n          </Button>\n        </Dropdown>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.text} placement=\"bottom\">\n          <Button onClick={onAddTextBtnClick}>\n            <Icon component={TextSvg as any} />\n          </Button>\n        </Tooltip>\n      </div>\n      <Divider type=\"vertical\" />\n      <div className=\"toolbar-btn\">\n        <Tooltip title={locale.user.report.deleteSelected} placement=\"bottom\">\n          <Button\n            type=\"danger\"\n            disabled={disableDelete}\n            onClick={onDeleteSelectedBtnClick}\n          >\n            <Icon type=\"delete\" />\n          </Button>\n        </Tooltip>\n      </div>\n    </Header>\n  );\n});\n","import * as React from 'react';\nimport { Layout, Select, Switch, Icon } from 'antd';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport {\n  ReportEl,\n  ReportChartType,\n  ReportElType,\n  ReportChartDataSource,\n  ReportChartOptions,\n} from '../ReportElement';\n\nimport './index.less';\n\nconst { Sider } = Layout;\n\ninterface ConfigPanelProps {\n  editingReportEl: ReportEl | null;\n  dataSources: {\n    rows: {\n      id: string;\n      name: string;\n      data: any[];\n    }[];\n    count: number;\n  };\n  onChartDataSourceSelect(id: string, dataSource: ReportChartDataSource): void;\n  onChartOptionsChange(id: string, options: ReportChartOptions): void;\n}\n\nexport default React.memo(function ConfigPanel(props: ConfigPanelProps) {\n  const {\n    editingReportEl,\n    dataSources,\n    onChartDataSourceSelect,\n    onChartOptionsChange,\n  } = props;\n  const { locale } = React.useContext(LocaleContext);\n\n  if (!editingReportEl) return <Sider className=\"config-panel\" />;\n\n  let title = locale.user.report[editingReportEl.type];\n\n  if (\n    editingReportEl.type === ReportElType.Chart &&\n    editingReportEl.chartType\n  ) {\n    title += ` > ${locale.user.report[editingReportEl.chartType]}`;\n  }\n\n  return (\n    <Sider className=\"config-panel\">\n      <div className=\"title\">{title}</div>\n      {(() => {\n        const pannelItems = [];\n\n        switch (editingReportEl.type) {\n          case ReportElType.Text:\n            break;\n          case ReportElType.Chart:\n            if (editingReportEl.dataSource) {\n              pannelItems.push(\n                <div key=\"data-source\" className=\"config-item\">\n                  <div>{locale.user.home.dataSources.title}</div>\n                  <Select\n                    value={editingReportEl.dataSource.id}\n                    style={{ width: '160px' }}\n                    // onSelect 用 useCallBack 添加 report element 会报错。\n                    onSelect={dataSourceId => {\n                      for (const dataSource of dataSources.rows) {\n                        if (dataSource.id === dataSourceId) {\n                          const { id, data } = dataSource;\n                          onChartDataSourceSelect(editingReportEl.id, {\n                            id,\n                            data,\n                          });\n                        }\n                      }\n                    }}\n                  >\n                    {dataSources.rows.map(dataSource => (\n                      <Select.Option key={dataSource.id} value={dataSource.id}>\n                        {dataSource.name}\n                      </Select.Option>\n                    ))}\n                  </Select>\n                </div>,\n              );\n            }\n\n            if (\n              editingReportEl.type === ReportElType.Chart &&\n              editingReportEl.chartType === ReportChartType.LineChart\n            ) {\n              pannelItems.push(\n                <div key=\"is-x-axis-time\" className=\"config-item\">\n                  <div>{locale.user.report.isXAxisTime}</div>\n                  <Switch\n                    checked={(editingReportEl.options as any).isXAxisTime}\n                    checkedChildren={<Icon type=\"check\" />}\n                    unCheckedChildren={<Icon type=\"close\" />}\n                    onClick={React.useCallback(\n                      isXAxisTime => {\n                        const { id, options } = editingReportEl;\n                        onChartOptionsChange(id, { ...options, isXAxisTime });\n                      },\n                      [editingReportEl],\n                    )}\n                  />\n                </div>,\n                <div key=\"is-line-smooth\" className=\"config-item\">\n                  <div>{locale.user.report.isLineSmooth}</div>\n                  <Switch\n                    checked={(editingReportEl.options as any).isLineSmooth}\n                    checkedChildren={<Icon type=\"check\" />}\n                    unCheckedChildren={<Icon type=\"close\" />}\n                    onClick={React.useCallback(\n                      isLineSmooth => {\n                        const { id, options } = editingReportEl;\n                        onChartOptionsChange(id, { ...options, isLineSmooth });\n                      },\n                      [editingReportEl],\n                    )}\n                  />\n                </div>,\n              );\n            }\n            break;\n          default:\n            break;\n        }\n\n        return pannelItems;\n      })()}\n    </Sider>\n  );\n});\n","import * as React from 'react';\nimport { Layout } from 'antd';\n\nimport customMetaKey from '$utils/customMetaKEey';\n\nimport {\n  GController,\n  InteractController,\n  KeyboardController,\n  MouseController,\n} from './controllers';\n\nimport ReportElement, { ReportEl, ReportElType } from './widgets/ReportElement';\nimport reportElsReducer, {\n  ReportElsActionType,\n} from './widgets/ReportElement/reducer';\nimport Toolbar from './widgets/Toolbar';\nimport ConfigPanel from './widgets/ConfigPanel';\n\nimport './index.less';\n\nconst { Content } = Layout;\n\ninterface ReportEditorProps {\n  initialEls: ReportEl[];\n  dataSources: {\n    rows: {\n      id: string;\n      name: string;\n      data: any[];\n    }[];\n    count: number;\n  };\n  onSave(reportELs: ReportEl[]): void;\n}\n\nfunction ReportEditor(props: ReportEditorProps) {\n  const { initialEls, dataSources, onSave } = props;\n  const reportCanvasRef = React.useRef<HTMLDivElement>(null);\n  const [reportEls, reportElsDispatch] = React.useReducer(\n    reportElsReducer,\n    {\n      undoStack: [],\n      redoStack: [],\n      state: [],\n    },\n    {\n      type: ReportElsActionType.Add,\n      payload: initialEls,\n      disallowUndo: true,\n    },\n  );\n  const controller = React.useMemo(\n    () => ({\n      g: new GController(),\n      interact: new InteractController({ reportElsDispatch }),\n      keyboard: new KeyboardController({\n        reportElsState: reportEls.state,\n        reportElsDispatch,\n        onSave,\n      }),\n      mouse: new MouseController({\n        reportElsState: reportEls.state,\n        reportElsDispatch,\n      }),\n    }),\n    [],\n  );\n  const editingReportEl = React.useMemo(() => {\n    for (const reportEl of reportEls.state) {\n      if (reportEl.editing) {\n        return reportEl;\n      }\n    }\n\n    return null;\n  }, [reportEls.state]);\n\n  React.useEffect(() => {\n    controller.keyboard.update({ reportElsState: reportEls.state });\n    controller.mouse.update({ reportElsState: reportEls.state });\n  }, [reportEls.state]);\n\n  React.useEffect(() => {\n    reportElsDispatch({\n      type: ReportElsActionType.Add,\n      payload: [],\n      disallowUndo: true,\n    });\n    controller.g.init();\n\n    return () => {\n      controller.g.destroy();\n      controller.interact.destroy();\n      controller.keyboard.destroy();\n      controller.mouse.destroy();\n    };\n  }, []);\n\n  return (\n    <Layout className=\"report-editor\">\n      <Toolbar\n        disableUndo={reportEls.undoStack.length === 0}\n        disableRedo={reportEls.redoStack.length === 0}\n        disableDelete={\n          reportEls.state.filter(reportEl => reportEl.selected).length === 0\n        }\n        onUndoBtnClick={controller.mouse.onUndoBtnClick}\n        onRedoBtnClick={controller.mouse.onRedoBtnClick}\n        onSelectAllBtnClick={controller.mouse.onSelectAllBtnClick}\n        onChartListItemClick={controller.mouse.onChartListItemClick}\n        onAddTextBtnClick={controller.mouse.onAddTextBtnClick}\n        onDeleteSelectedBtnClick={controller.mouse.onDeleteSelectedBtnClick}\n      />\n      <Layout>\n        <Content\n          className=\"report-canvas-container\"\n          onMouseDown={controller.mouse.onCanvasContainerMouseDown}\n          onMouseUp={controller.mouse.onCanvasContainerMouseUp}\n        >\n          <div ref={reportCanvasRef} id=\"report-canvas\" />\n          {reportEls.state.map(reportEl => (\n            <ReportElement\n              key={reportEl.id}\n              {...reportEl}\n              onMouseMove={\n                reportEl.type === ReportElType.Chart\n                  ? controller.mouse.onReportElMouseMove\n                  : undefined\n              }\n              // onMouseDown 用 useCallBack 按删除会报错。\n              onMouseDown={(\n                event: React.MouseEvent<HTMLDivElement, MouseEvent>,\n              ) =>\n                controller.mouse.onReportElMouseDown(\n                  reportEl.id,\n                  !customMetaKey({\n                    ctrlKey: event.ctrlKey,\n                    metaKey: event.metaKey,\n                  }),\n                )\n              }\n              onMouseUp={controller.mouse.onReportElMouseUp}\n              // onInputText 用 useCallBack 按删除会报错。\n              onInputText={\n                reportEl.type === ReportElType.Text\n                  ? (event: any) =>\n                      controller.keyboard._onInputText(\n                        reportEl.id,\n                        event.target.value,\n                      )\n                  : undefined\n              }\n            />\n          ))}\n        </Content>\n        <ConfigPanel\n          editingReportEl={editingReportEl}\n          dataSources={dataSources}\n          onChartDataSourceSelect={controller.mouse.onChartDataSourceSelect}\n          onChartOptionsChange={controller.mouse.onChartOptionsChange}\n        />\n      </Layout>\n    </Layout>\n  );\n}\n\nexport default React.memo(ReportEditor);\n","import * as React from 'react';\nimport { Link } from '@reach/router';\nimport { compose, graphql, Mutation, MutationFn } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport { Layout, Icon } from 'antd';\nimport moment from 'moment';\n\nimport { LocaleContext } from '$contexts/Locale';\n\nimport { AbsoluteRoute } from '$routes/index';\n\nimport Loading from '$components/Loading';\nimport Error from '$components/Error';\nimport TextEditor from '$components/TextEditor';\nimport ReportEditor from '$components/ReportEditor';\nimport { ReportElType } from '$components/ReportEditor/widgets/ReportElement';\n\nimport './index.less';\n\nconst { Header } = Layout;\n\ninterface ReportProps {\n  getReport: any;\n  getDataSources: any;\n  saveReport: MutationFn<any, any>;\n}\n\nconst GET_REPORT = gql`\n  query getReport($id: ID!) {\n    getReport(id: $id) {\n      id\n      updatedAt\n      name\n      elements\n    }\n  }\n`;\n\nconst GET_DATASOURCES = gql`\n  query {\n    getDataSources {\n      rows {\n        id\n        name\n        data\n      }\n      count\n    }\n  }\n`;\n\nconst RENAME_REPORT = gql`\n  mutation renameReport($id: ID!, $name: String!) {\n    renameReport(id: $id, name: $name)\n  }\n`;\n\nconst SAVE_REPORT_ELS = gql`\n  mutation saveReportEls($id: ID!, $elements: String!) {\n    saveReportEls(id: $id, elements: $elements)\n  }\n`;\n\nfunction Report(props: ReportProps) {\n  const { getReport, getDataSources, saveReport } = props;\n  const loading = getReport.loading || getDataSources.loading;\n  const error = getReport.error || getDataSources.error;\n\n  if (loading) return <Loading />;\n\n  if (error) return <Error />;\n\n  if (!getReport || !getDataSources || !saveReport) return null;\n\n  const { locale } = React.useContext(LocaleContext);\n  const [report, setReport] = React.useState(getReport.getReport);\n\n  return (\n    <Layout className=\"page-container\">\n      <Header className=\"report-header\">\n        <Link to={AbsoluteRoute.User.Home.Reports}>\n          <Icon type=\"left\" />\n        </Link>\n        <div className=\"report-info\">\n          <Mutation\n            mutation={RENAME_REPORT}\n            variables={{ id: report.id, name: report.name }}\n          >\n            {renameReport => {\n              return (\n                <TextEditor\n                  className=\"title\"\n                  placeholder={locale.user.home.reports.unnamedReport}\n                  text={report.name}\n                  onKeyDown={event => {\n                    if (event.keyCode === 13) {\n                      event.preventDefault();\n                      (event.target as any).blur();\n                    }\n                  }}\n                  onChange={event =>\n                    setReport({ ...report, name: event.target.value })\n                  }\n                  onBlur={e => renameReport()}\n                />\n              );\n            }}\n          </Mutation>\n          <span className=\"detail\">\n            {locale.common.updatedAt}: {moment(report.updatedAt).format('lll')}\n          </span>\n        </div>\n      </Header>\n      <ReportEditor\n        initialEls={report.elements}\n        dataSources={getDataSources.getDataSources}\n        onSave={reportEls => {\n          saveReport({\n            variables: {\n              id: report.id,\n              elements: JSON.stringify(\n                reportEls.map(reportEl =>\n                  reportEl.type === ReportElType.Chart\n                    ? {\n                        ...reportEl,\n                        dataSource: {\n                          ...reportEl.dataSource,\n                          data: reportEl.dataSource.data.origin,\n                        },\n                      }\n                    : reportEl,\n                ),\n              ),\n            },\n          });\n          console.log(\n            reportEls.map(reportEl =>\n              reportEl.type === ReportElType.Chart\n                ? {\n                    ...reportEl,\n                    dataSource: {\n                      ...reportEl.dataSource,\n                      data: reportEl.dataSource.data.origin,\n                    },\n                  }\n                : reportEl,\n            ),\n          );\n        }}\n      />\n    </Layout>\n  );\n}\n\n// 后续打算用回 restful 重写该项目，下方的类型定义随便写了。\nexport default React.memo(\n  compose(\n    graphql<any, any, any, any>(GET_REPORT, {\n      options: props => ({ variables: { id: props.reportId! } }),\n      props: ({ data }) => {\n        if (!data) return { data };\n\n        const getReport = data.getReport\n          ? {\n              getReport: {\n                ...data.getReport,\n                elements: JSON.parse(data.getReport.elements),\n              },\n            }\n          : {};\n\n        return {\n          getReport: {\n            ...data,\n            ...getReport,\n          },\n        };\n      },\n    }),\n    graphql<any, any, any, any>(GET_DATASOURCES, {\n      props: ({ data }) => {\n        if (!data) return { data };\n\n        const getDataSources = data.getDataSources\n          ? {\n              getDataSources: {\n                ...data.getDataSources,\n                rows: data.getDataSources.rows.map((dataSource: any) => ({\n                  ...dataSource,\n                  data: JSON.parse(dataSource.data),\n                })),\n              },\n            }\n          : {};\n\n        return {\n          getDataSources: {\n            ...data,\n            ...getDataSources,\n          },\n        };\n      },\n    }),\n    graphql<any, any, any, any>(SAVE_REPORT_ELS, {\n      props: ({ mutate }) => ({\n        saveReport: mutate,\n      }),\n    }),\n  )(Report),\n);\n","import * as React from 'react';\n\ninterface DoActionOnMountProps {\n  doAction(): any;\n}\n\nexport default React.memo(function DoActionOnMount(\n  props: DoActionOnMountProps,\n) {\n  React.useEffect(() => {\n    props.doAction();\n  }, []);\n\n  return null;\n});\n","import * as React from 'react';\nimport { Router } from '@reach/router';\nimport gql from 'graphql-tag';\nimport { Mutation } from 'react-apollo';\n\nimport { UserContext } from '$contexts/User';\n\nimport Home from '$routes/User/Home';\nimport Reports from '$routes/User/Home/Reports';\nimport DataSources from '$routes/User/Home/DataSources';\nimport Report from '$routes/User/Report';\n\nimport DoActionOnMount from '$components/DoActionOnMount';\nimport Loading from '$components/Loading';\n\nconst SignIn = React.lazy(async() => import('$routes/SignIn'));\nconst User = React.lazy(async() => import('$routes/User'));\nconst NotFound = React.lazy(async() => import('$routes/NotFound'));\n\nexport const AbsoluteRoute = {\n  SignIn: '/',\n  User: {\n    Path: '/',\n    Home: {\n      Path: '/',\n      Reports: '/',\n      DataSources: '/data-sources',\n    },\n    Report: '/report/:reportId',\n  },\n};\n\nconst SIGN_IN_BY_TOKEN = gql`\n  mutation signInByToken($id: ID!, $token: String!) {\n    signInByToken(id: $id, token: $token) {\n      id\n      username\n      token\n    }\n  }\n`;\n\nexport default React.memo(function Routes(props) {\n  const {\n    user: { id, username, token, hasSignedIn },\n    setUser,\n  } = React.useContext(UserContext);\n  const onSignInByTokenCompleted = React.useCallback(({ signInByToken }) => {\n    const { id, username, token } = signInByToken;\n    setUser({ id, username, token, hasSignedIn: true });\n  }, []);\n\n  return (\n    <React.Suspense fallback={<Loading />}>\n      <Mutation\n        mutation={SIGN_IN_BY_TOKEN}\n        variables={{\n          id,\n          token,\n        }}\n        onCompleted={onSignInByTokenCompleted}\n      >\n        {(signInByToken, { loading, error }) => {\n          if (!id || !username || !token) {\n            return (\n              <Router className=\"Routes\">\n                <SignIn path=\"/\" />\n                <NotFound default />\n              </Router>\n            );\n          }\n\n          if (!hasSignedIn) {\n            return <DoActionOnMount doAction={signInByToken} />;\n          }\n\n          if (loading) return <Loading />;\n\n          if (error) {\n            return (\n              <Router className=\"Routes\">\n                <SignIn path=\"/\" />\n                <NotFound default />\n              </Router>\n            );\n          }\n\n          return (\n            <Router className=\"Routes\">\n              <User path=\"/\">\n                <Home path=\"/\">\n                  <Reports path=\"/\" />\n                  <DataSources path=\"data-sources\" />\n                  <NotFound default />\n                </Home>\n                <Report path=\"report/:reportId\" />\n                <NotFound default />\n              </User>\n              <NotFound default />\n            </Router>\n          );\n        }}\n      </Mutation>\n    </React.Suspense>\n  );\n});\n","module.exports = \"data:image/png;base64,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\"","import en_US from './en_US';\nimport zh_CN from './zh_CN';\n\nexport interface Locale {\n  locale: {\n    key: string;\n    value: string;\n  };\n  common: {\n    loading: string;\n    createdAt: string;\n    updatedAt: string;\n  };\n  signIn: {\n    signIn: string;\n    signUp: string;\n    username: string;\n    password: string;\n    usernameLimit: string;\n    passwordLimit: string;\n  };\n  user: {\n    signOut: string;\n    home: {\n      title: string;\n      reports: {\n        title: string;\n        addReport: string;\n        unnamedReport: string;\n      };\n      dataSources: {\n        title: string;\n        addDataSource: string;\n      };\n    };\n    report: {\n      redo: string;\n      undo: string;\n      selectAll: string;\n      unselectAll: string;\n      deleteSelected: string;\n      chart: string;\n      text: string;\n      lineChart: string;\n      barChart: string;\n      pieChart: string;\n      scatterChart: string;\n      textEmptyTips: string;\n      isXAxisTime: string;\n      isLineSmooth: string;\n    };\n  };\n  error: {\n    unauthorized: string;\n    existingUsername: string;\n    nonexistentUsernameOrWrongPassword: string;\n    reportNotFound: string;\n    dataSourceNotFound: string;\n    networkError: string;\n    fileContentError: string;\n  };\n  notFound: string;\n}\n\ninterface Locales {\n  [key: string]: Locale;\n}\n\nexport const locales: Locales = {\n  en_US,\n  zh_CN,\n};\n","export default {\n  locale: {\n    key: 'en_US',\n    value: 'English',\n  },\n  common: {\n    loading: 'Loading...',\n    createdAt: 'Created at',\n    updatedAt: 'Updated at',\n  },\n  signIn: {\n    signIn: 'Sign In',\n    signUp: 'Sign Up',\n    username: 'username',\n    password: 'password',\n    usernameLimit:\n      'The username should be 3 to 15 in length and consists of letters or numbers.',\n    passwordLimit:\n      'The password should be 6 to 15 in length and at least have one lowercase letter, uppercase letters as well as numbers.',\n  },\n  user: {\n    signOut: 'Sign Out',\n    home: {\n      title: 'home',\n      reports: {\n        title: 'Reports',\n        addReport: 'Add a report',\n        unnamedReport: 'Unnamed report',\n      },\n      dataSources: {\n        title: 'Data sources',\n        addDataSource: 'Add a data source',\n      },\n    },\n    report: {\n      redo: 'Redo',\n      undo: 'Undo',\n      selectAll: 'Select all',\n      unselectAll: 'Unselect all',\n      deleteSelected: 'Delete selected',\n      chart: 'Chart',\n      text: 'Text',\n      lineChart: 'Line chart',\n      pieChart: 'Pie chart',\n      barChart: 'Bar chart',\n      scatterChart: 'Scatter chart',\n      textEmptyTips: 'Please enter text.',\n      isXAxisTime: 'Is x axis time?',\n      isLineSmooth: 'Is line smooth?',\n    },\n  },\n  error: {\n    unauthorized: 'Unauthorized.',\n    existingUsername: 'Existing Username.',\n    nonexistentUsernameOrWrongPassword:\n      'Noexistent username or wrong password.',\n    reportNotFound: 'Report not found.',\n    dataSourceNotFound: 'Data source not found.',\n    networkError: 'Network Error.',\n    fileContentError: 'File Content Error.',\n  },\n  notFound: 'Not Found!',\n};\n","export default {\n  locale: {\n    key: 'zh_CN',\n    value: '简体中文',\n  },\n  common: {\n    loading: '加载中...',\n    createdAt: '创建于',\n    updatedAt: '更新于',\n    uploadData: '上传数据',\n  },\n  signIn: {\n    signIn: '登录',\n    signUp: '注册',\n    username: '用户名',\n    password: '密码',\n    usernameLimit: '用户名长度为 3 ～ 15，由字母或数字组成。',\n    passwordLimit:\n      '密码长度为 6 ～ 15，且至少有一个小写字母、大写字母以及数字。',\n  },\n  user: {\n    signOut: '登出',\n    home: {\n      title: '首页',\n      reports: {\n        title: '报告',\n        addReport: '新建报告',\n        unnamedReport: '未命名报告',\n      },\n      dataSources: {\n        title: '数据源',\n        addDataSource: '新建数据源',\n      },\n    },\n    report: {\n      redo: '重做',\n      undo: '撤回',\n      selectAll: '全选',\n      unselectAll: '取消选择',\n      deleteSelected: '删除所选',\n      chart: '图表',\n      text: '文本',\n      lineChart: '折线图',\n      barChart: '柱状图',\n      pieChart: '饼状图',\n      scatterChart: '散点图',\n      textEmptyTips: '请输入文本',\n      isXAxisTime: '横轴是否为时间轴？',\n      isLineSmooth: '折线是否为曲线？',\n    },\n  },\n  error: {\n    unauthorized: '登录失效，请重新登录。',\n    existingUsername: '用户名已存在。',\n    nonexistentUsernameOrWrongPassword: '用户名不存在或密码错误。',\n    reportNotFound: '报告不存在。',\n    dataSourceNotFound: '数据源不存在。',\n    networkError: '网络错误。',\n    fileContentError: '文件内容错误。',\n  },\n  notFound: '该页面不存在。',\n};\n","import * as React from 'react';\nimport { navigate } from '@reach/router';\n\nimport { AbsoluteRoute } from '$routes/index';\n\ninterface User {\n  id: string;\n  username: string;\n  token: string;\n  hasSignedIn: boolean;\n}\n\nexport const UserContext = React.createContext<{\n  user: User;\n  setUser: React.Dispatch<React.SetStateAction<User>>;\n}>({\n  user: {\n    id: window.localStorage.getItem('id') || '',\n    username: window.localStorage.getItem('username') || '',\n    token: window.localStorage.getItem('token') || '',\n    hasSignedIn: false,\n  },\n  // tslint:disable-next-line\n  setUser: () => {},\n});\n\ninterface UserProviderProps {\n  children: React.ReactNode;\n}\n\nexport const UserProvider = React.memo(function UserProvider(\n  props: UserProviderProps,\n) {\n  const [user, setUser] = React.useState({\n    id: window.localStorage.getItem('id') || '',\n    username: window.localStorage.getItem('username') || '',\n    token: window.localStorage.getItem('token') || '',\n    hasSignedIn: false,\n  });\n  const UserContextValue = React.useMemo(() => ({ user, setUser }), [user]);\n\n  React.useEffect(() => {\n    const { id, username, token } = user;\n\n    if (!id || !username || !token) {\n      navigate(AbsoluteRoute.SignIn);\n    }\n\n    window.localStorage.setItem('id', id);\n    window.localStorage.setItem('username', username);\n    window.localStorage.setItem('token', token);\n  }, [user]);\n\n  return (\n    <UserContext.Provider value={UserContextValue}>\n      {props.children}\n    </UserContext.Provider>\n  );\n});\n","import * as React from 'react';\nimport Error from '$components/Error';\n\nimport './index.less';\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n}\n\n// prettier-ignore\nexport default class ErrorBoundary extends React.PureComponent<ErrorBoundaryProps, ErrorBoundaryState> {\n  public constructor(props: ErrorBoundaryProps) {\n    super(props);\n\n    this.state = { hasError: false };\n  }\n  public static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  public render() {\n    return this.state.hasError ? <Error /> : this.props.children;\n  }\n}\n","import * as React from 'react';\nimport ApolloClient from 'apollo-boost';\nimport { ApolloProvider } from 'react-apollo';\nimport { message } from 'antd';\n\nimport { UserContext } from '$contexts/User';\nimport { LocaleContext } from '$contexts/Locale';\n\ninterface ApolloProviderProps {\n  children: React.ReactNode;\n}\n\nexport default React.memo(function(props: ApolloProviderProps) {\n  const { locale } = React.useContext(LocaleContext);\n  const { user, setUser } = React.useContext(UserContext);\n  const client = React.useMemo(\n    () =>\n      new ApolloClient({\n        uri: 'http://localhost:4000',\n        headers: {\n          authorization: user.token,\n        },\n        onError: ({ graphQLErrors, networkError }) => {\n          if (graphQLErrors) {\n            graphQLErrors.map(({ message: errorMessage, extensions }) => {\n              if (!extensions) {\n                message.error(errorMessage);\n\n                return;\n              }\n\n              switch (extensions!.code) {\n                case 'UNAUTHORIZED':\n                  message.error(locale.error.unauthorized);\n                  setUser({\n                    id: '',\n                    username: '',\n                    token: '',\n                    hasSignedIn: false,\n                  });\n                  break;\n                case 'EXISTING_USERNAME':\n                  message.error(locale.error.existingUsername);\n                  break;\n                case 'NONEXISTENT_USERNAME_OR_WRONG_PASSWORD':\n                  message.error(\n                    locale.error.nonexistentUsernameOrWrongPassword,\n                  );\n                  break;\n                case 'REPORT_NOT_FOUND':\n                  message.error(locale.error.reportNotFound);\n                  break;\n                case 'DATA_SOURCE_NOT_FOUND':\n                  message.error(locale.error.dataSourceNotFound);\n                  break;\n                default:\n                  message.error(errorMessage);\n                  break;\n              }\n            });\n\n            if (networkError) message.error(locale.error.networkError);\n          }\n        },\n      }),\n    [user, locale],\n  );\n\n  return <ApolloProvider client={client}>{props.children}</ApolloProvider>;\n});\n","import * as React from 'react';\n\nimport { UserProvider } from '$contexts/User';\nimport { LocaleProvider } from '$contexts/Locale';\n\nimport Routes from '$routes/index';\n\nimport ErrorBoundary from '$components/ErrorBoundary';\nimport ApolloProvider from '$components/ApolloProvider';\n\nimport './App.less';\n\nexport default React.memo(function App() {\n  return (\n    <UserProvider>\n      <LocaleProvider>\n        <ErrorBoundary>\n          <ApolloProvider>\n            <Routes />\n          </ApolloProvider>\n        </ErrorBoundary>\n      </LocaleProvider>\n    </UserProvider>\n  );\n});\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ninterface Config {\n  onSuccess?(registration: ServiceWorkerRegistration): void;\n  onUpdate?(registration: ServiceWorkerRegistration): void;\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href,\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport App from './App';\n\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.less';\n\nReactDOM.render(<App />, document.getElementById('root') as HTMLElement);\nserviceWorker.register();\n","import * as React from 'react';\n\nimport './index.less';\n\nexport default React.memo(function Error() {\n  return <span>Error :(</span>;\n});\n"],"sourceRoot":""}